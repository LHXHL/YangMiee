(function(){var e={584:function(e,t,l){"use strict";var a=l(5130),s=l(6768),i=l(4232),r=l(782),o=(l(4114),l(144)),n=l(1387);const d={key:0,class:"fixed top-6 left-1/2 transform -translate-x-1/2 z-50"},c={class:"text-sm font-medium text-light-text-primary py-0.5"};var u={__name:"PopupNotification",props:{message:{type:String,required:!0},duration:{type:Number,default:3e3},type:{type:String,default:"success",validator:e=>["success","error","warning","info"].includes(e)},showCloseButton:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const l=e,r=t,n=(0,o.KR)(!1);let u=null;const g=(0,s.EW)((()=>({success:"bg-white/90 border-green-500/30",error:"bg-white/90 border-red-500/30",warning:"bg-white/90 border-yellow-500/30",info:"bg-white/90 border-blue-500/30"}[l.type]||"bg-white/90 border-light-border"))),x=(0,s.EW)((()=>({success:"bg-green-500/10 text-green-500",error:"bg-red-500/10 text-red-500",warning:"bg-yellow-500/10 text-yellow-600",info:"bg-blue-500/10 text-blue-500"}[l.type]||"bg-light-bg text-light-text-tertiary"))),m=(0,s.EW)((()=>({success:"ri-check-line",error:"ri-error-warning-line",warning:"ri-alert-line",info:"ri-information-line"}[l.type]||"ri-notification-line"))),p=()=>{n.value=!1,clearTimeout(u),setTimeout((()=>{r("close")}),300)};return(0,s.nT)((()=>{l.duration>0&&n.value&&(clearTimeout(u),u=setTimeout((()=>{p()}),l.duration))})),(0,s.sV)((()=>{setTimeout((()=>{n.value=!0}),0)})),(0,s.hi)((()=>{clearTimeout(u)})),(t,l)=>((0,s.uX)(),(0,s.Wv)(s.Im,{to:"body"},[(0,s.bF)(a.eB,{name:"notification"},{default:(0,s.k6)((()=>[n.value?((0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("div",{class:(0,i.C4)(["px-5 py-3 rounded-xl shadow-light-card max-w-md","backdrop-blur-xl border","flex items-center space-x-3",g.value]),role:"alert"},[(0,s.Lk)("div",{class:(0,i.C4)(["w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0",x.value])},[(0,s.Lk)("i",{class:(0,i.C4)([m.value,"text-lg"])},null,2)],2),(0,s.Lk)("div",c,(0,i.v_)(e.message),1),e.showCloseButton?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:p,class:"ml-2 text-light-text-tertiary hover:text-light-text-secondary transition-colors duration-150 focus:outline-none","aria-label":"关闭通知"},l[0]||(l[0]=[(0,s.Lk)("i",{class:"ri-close-line text-lg"},null,-1)]))):(0,s.Q3)("",!0)],2)])):(0,s.Q3)("",!0)])),_:1})]))}},g=l(1241);const x=(0,g.A)(u,[["__scopeId","data-v-cacf1a20"]]);var m=x;const p={class:"bg-white/80 backdrop-blur-md py-2 px-4 shadow-light-card fixed w-full z-10 transition-all duration-500 border-b border-light-border"},b={class:"flex justify-between items-center"},h={class:"flex items-center space-x-3"},f=["onClick"],k={key:1,class:"relative"},v=["onClick"],y=["onClick"];var L={__name:"HeaderPage",setup(e){const t=(0,n.rd)(),l=(0,r.Pj)(),d=(0,s.EW)((()=>l.state.isAuthenticated)),c=(0,o.KR)(!1),u=(0,o.KR)(""),g=(0,o.KR)(""),x=(0,o.KR)("success"),L=(0,o.KR)({userMenu:!1});function w(e){L.value[e]=!L.value[e],Object.keys(L.value).forEach((t=>{t!==e&&(L.value[t]=!1)}))}function C(e){e.target.closest(".dropdown-menu")||e.target.closest("button")||Object.keys(L.value).forEach((e=>{L.value[e]=!1}))}async function R(){await l.dispatch("logout"),c.value=!0,u.value="您已成功登出系统",g.value="👋",x.value="info",t.push("/login")}function _(){c.value=!0,u.value="帮助文档即将推出",g.value="📚",x.value="info"}return(0,s.sV)((()=>{document.addEventListener("click",C)})),(0,s.xo)((()=>{document.removeEventListener("click",C)})),(e,t)=>{const l=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("nav",p,[(0,s.Lk)("div",b,[t[9]||(t[9]=(0,s.Fv)('<div class="text-xl font-medium text-light-text-primary tracking-tight flex items-center group" data-v-1fb24f7c><a href="/" class="flex items-center hover:opacity-90 transition-opacity" data-v-1fb24f7c><svg width="220" height="40" viewBox="0 0 220 40" class="h-10 mr-2" data-v-1fb24f7c><title data-v-1fb24f7c>YangMiee 攻击面梳理平台</title><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-1fb24f7c><g data-v-1fb24f7c><path d="M22,5 C22,5 15,7 12,14 C9,21 11,30 19,35 C27,40 35,38 35,38 C35,38 29,31 28,24 C27,17 29,10 35,5 C28,5 22,5 22,5 Z" fill="#2F54EB" transform="translate(-4, -3)" data-v-1fb24f7c></path><path d="M40,8 L41.5,11 L45,11.5 L42.5,14 L43,17.5 L40,16 L37,17.5 L37.5,14 L35,11.5 L38.5,11 L40,8 Z" fill="#4285F4" transform="scale(0.6) translate(10, -5)" data-v-1fb24f7c></path><path d="M40,8 L41.5,11 L45,11.5 L42.5,14 L43,17.5 L40,16 L37,17.5 L37.5,14 L35,11.5 L38.5,11 L40,8 Z" fill="#9277CD" transform="scale(0.5) translate(20, 30)" data-v-1fb24f7c></path><path d="M40,8 L41.5,11 L45,11.5 L42.5,14 L43,17.5 L40,16 L37,17.5 L37.5,14 L35,11.5 L38.5,11 L40,8 Z" fill="#E57373" transform="scale(0.4) translate(75, 15)" data-v-1fb24f7c><animate attributeName="opacity" values="0.5;1;0.5" dur="3s" repeatCount="indefinite" data-v-1fb24f7c></animate></path></g><g transform="translate(44.000000, 0.000000)" data-v-1fb24f7c><defs data-v-1fb24f7c><linearGradient id="yangmieeGradient" x1="0%" y1="0%" x2="100%" y2="0%" data-v-1fb24f7c><stop offset="0%" stop-color="#4285F4" data-v-1fb24f7c></stop><stop offset="50%" stop-color="#9277CD" data-v-1fb24f7c></stop><stop offset="100%" stop-color="#E57373" data-v-1fb24f7c></stop></linearGradient></defs><g font-family="Futura-MediumItalic, Futura" font-size="18" font-style="italic" font-weight="400" data-v-1fb24f7c><text fill="url(#yangmieeGradient)" data-v-1fb24f7c><tspan x="0" y="19" data-v-1fb24f7c>YangMiee</tspan></text></g><g transform="translate(0.000000, 23.000000)" font-size="12" font-style="italic" font-family="Futura-MediumItalic, Futura" font-weight="400" data-v-1fb24f7c><text fill="url(#yangmieeGradient)" data-v-1fb24f7c><tspan x="0" y="13" data-v-1fb24f7c>攻击面梳理平台</tspan></text></g></g></g></svg></a></div>',1)),(0,s.Lk)("div",h,[(0,s.Lk)("button",{onClick:_,class:"text-sm font-medium text-light-text-secondary hover:text-primary transition-all duration-300 px-2 py-1 rounded-lg hover:bg-primary/5 flex items-center"},t[2]||(t[2]=[(0,s.Lk)("i",{class:"ri-question-line"},null,-1)])),d.value?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>w("userMenu")),class:"flex items-center space-x-1 text-light-text-secondary rounded-full hover:bg-primary/5 p-1 transition-all duration-300"},[t[4]||(t[4]=(0,s.Lk)("div",{class:"w-7 h-7 bg-primary/10 rounded-full flex items-center justify-center text-primary"},[(0,s.Lk)("i",{class:"ri-user-3-line"})],-1)),(0,s.Lk)("i",{class:(0,i.C4)(["ri-arrow-down-s-line text-xs transition-transform duration-300",{"rotate-180":L.value.userMenu}])},null,2)]),(0,s.bo)((0,s.Lk)("div",{class:(0,i.C4)(["absolute right-0 mt-2 w-48 bg-white/95 backdrop-blur-md rounded-lg shadow-light-dropdown p-2 border border-light-border",{"dropdown-active":L.value.userMenu}])},[(0,s.bF)(l,{to:"/under-development"},{default:(0,s.k6)((({navigate:e})=>[(0,s.Lk)("button",{onClick:e,class:"dropdown-item"},t[5]||(t[5]=[(0,s.Lk)("i",{class:"ri-user-line mr-2"},null,-1),(0,s.eW)(" 个人资料 ")]),8,v)])),_:1}),(0,s.bF)(l,{to:"/under-development"},{default:(0,s.k6)((({navigate:e})=>[(0,s.Lk)("button",{onClick:e,class:"dropdown-item"},t[6]||(t[6]=[(0,s.Lk)("i",{class:"ri-settings-4-line mr-2"},null,-1),(0,s.eW)(" 账户设置 ")]),8,y)])),_:1}),t[8]||(t[8]=(0,s.Lk)("div",{class:"border-t border-light-border my-1"},null,-1)),(0,s.Lk)("button",{onClick:R,class:"dropdown-item text-red-500 hover:text-red-600"},t[7]||(t[7]=[(0,s.Lk)("i",{class:"ri-logout-box-line mr-2"},null,-1),(0,s.eW)(" 登出 ")]))],2),[[a.aG,L.value.userMenu]])])):((0,s.uX)(),(0,s.Wv)(l,{key:0,to:"/login"},{default:(0,s.k6)((({navigate:e})=>[(0,s.Lk)("button",{onClick:e,class:"text-sm font-medium text-light-text-secondary hover:text-primary transition-all duration-300 px-3 py-1 rounded-lg hover:bg-primary/5"},t[3]||(t[3]=[(0,s.Lk)("i",{class:"ri-login-box-line mr-1"},null,-1),(0,s.eW)(" 登录 ")]),8,f)])),_:1}))])]),c.value?((0,s.uX)(),(0,s.Wv)(m,{key:0,message:u.value,emoji:g.value,type:x.value,onClose:t[1]||(t[1]=e=>c.value=!1)},null,8,["message","emoji","type"])):(0,s.Q3)("",!0)])}}};const w=(0,g.A)(L,[["__scopeId","data-v-1fb24f7c"]]);var C=w;const R={class:"bg-white/90 backdrop-blur-md shadow-light-card h-screen w-64 fixed left-0 top-12 z-5 border-r border-light-border overflow-y-auto"},_={class:"py-4"},T=["onClick"],S=["onClick"],E={class:"mt-2"},W={class:"overflow-hidden transition-all duration-300"},D=["onClick"],X=["onClick"],P=["onClick"],A=["onClick"],I=["onClick"],F={class:"mt-2"},K={class:"overflow-hidden transition-all duration-300"},j=["onClick"],V=["onClick"],M={class:"mt-2"},Q={class:"overflow-hidden transition-all duration-300"},$=["onClick"],N=["onClick"],B=["onClick"],U=["onClick"],H={key:1,class:"px-6 py-8 text-center"},z=["onClick"],q=["onClick"];var O={__name:"SideBar",setup(e){const t=(0,r.Pj)(),l=(0,n.lq)(),d=(0,s.EW)((()=>t.state.isAuthenticated)),c=(0,o.KR)({attackSurface:!1,tools:!1,system:!1});function u(e){c.value[e]=!c.value[e]}return(0,s.sV)((()=>{const e=l.path;e.includes("/subdomain")||e.includes("/port-scan")||e.includes("/path-scan")||e.includes("/gogo-scan")?c.value.attackSurface=!0:e.includes("/tools")?c.value.tools=!0:(e.includes("/task")||e.includes("/system")||e.includes("/tool-configuration")||e.includes("/user"))&&(c.value.system=!0)})),(e,t)=>{const l=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("aside",R,[(0,s.Lk)("div",_,[d.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(l,{to:"/"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-3 flex items-center transition-all duration-300",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[3]||(t[3]=[(0,s.Lk)("i",{class:"ri-home-line mr-3 text-lg"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"主页",-1)]),10,T)])),_:1}),(0,s.bF)(l,{to:"/dashboard"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-3 flex items-center transition-all duration-300",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[4]||(t[4]=[(0,s.Lk)("i",{class:"ri-dashboard-line mr-3 text-lg"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"仪表盘",-1)]),10,S)])),_:1}),(0,s.Lk)("div",E,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>u("attackSurface")),class:"w-full text-left px-4 py-2 flex items-center justify-between transition-all duration-300 text-light-text-secondary hover:bg-primary/5 hover:text-primary"},[t[5]||(t[5]=(0,s.Lk)("div",{class:"flex items-center"},[(0,s.Lk)("i",{class:"ri-radar-line mr-3 text-lg"}),(0,s.Lk)("span",{class:"font-medium text-sm"},"攻击面")],-1)),(0,s.Lk)("i",{class:(0,i.C4)(["ri-arrow-down-s-line transition-transform duration-300",{"transform rotate-180":c.value.attackSurface}])},null,2)]),(0,s.bo)((0,s.Lk)("div",W,[(0,s.bF)(l,{to:"/subdomain-scan-results"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[6]||(t[6]=[(0,s.Lk)("i",{class:"ri-global-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"子域名扫描",-1)]),10,D)])),_:1}),(0,s.bF)(l,{to:"/port-scan-results"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[7]||(t[7]=[(0,s.Lk)("i",{class:"ri-scan-2-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"端口扫描",-1)]),10,X)])),_:1}),(0,s.bF)(l,{to:"/path-scan-results"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[8]||(t[8]=[(0,s.Lk)("i",{class:"ri-folders-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"路径扫描",-1)]),10,P)])),_:1}),(0,s.bF)(l,{to:"/gogo-scan-results"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-bug-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"漏洞扫描",-1)]),10,A)])),_:1}),(0,s.bF)(l,{to:"/under-development"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[10]||(t[10]=[(0,s.Lk)("i",{class:"ri-focus-3-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"综合扫描",-1)]),10,I)])),_:1})],512),[[a.aG,c.value.attackSurface]])]),(0,s.Lk)("div",F,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>u("tools")),class:"w-full text-left px-4 py-2 flex items-center justify-between transition-all duration-300 text-light-text-secondary hover:bg-primary/5 hover:text-primary"},[t[11]||(t[11]=(0,s.Lk)("div",{class:"flex items-center"},[(0,s.Lk)("i",{class:"ri-tools-line mr-3 text-lg"}),(0,s.Lk)("span",{class:"font-medium text-sm"},"轻武器库")],-1)),(0,s.Lk)("i",{class:(0,i.C4)(["ri-arrow-down-s-line transition-transform duration-300",{"transform rotate-180":c.value.tools}])},null,2)]),(0,s.bo)((0,s.Lk)("div",K,[(0,s.bF)(l,{to:"/tools/crypto"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[12]||(t[12]=[(0,s.Lk)("i",{class:"ri-lock-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"加解密工具箱",-1)]),10,j)])),_:1}),(0,s.bF)(l,{to:"/tools/http-request"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[13]||(t[13]=[(0,s.Lk)("i",{class:"ri-global-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"网络请求工具箱",-1)]),10,V)])),_:1})],512),[[a.aG,c.value.tools]])]),(0,s.Lk)("div",M,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>u("system")),class:"w-full text-left px-4 py-2 flex items-center justify-between transition-all duration-300 text-light-text-secondary hover:bg-primary/5 hover:text-primary"},[t[14]||(t[14]=(0,s.Lk)("div",{class:"flex items-center"},[(0,s.Lk)("i",{class:"ri-settings-3-line mr-3 text-lg"}),(0,s.Lk)("span",{class:"font-medium text-sm"},"系统管理")],-1)),(0,s.Lk)("i",{class:(0,i.C4)(["ri-arrow-down-s-line transition-transform duration-300",{"transform rotate-180":c.value.system}])},null,2)]),(0,s.bo)((0,s.Lk)("div",Q,[(0,s.bF)(l,{to:"/task-management"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[15]||(t[15]=[(0,s.Lk)("i",{class:"ri-task-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"任务管理",-1)]),10,$)])),_:1}),(0,s.bF)(l,{to:"/system-configuration"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[16]||(t[16]=[(0,s.Lk)("i",{class:"ri-settings-3-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"系统配置",-1)]),10,N)])),_:1}),(0,s.bF)(l,{to:"/tool-configuration"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[17]||(t[17]=[(0,s.Lk)("i",{class:"ri-tools-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"工具配置",-1)]),10,B)])),_:1}),(0,s.bF)(l,{to:"/user-management"},{default:(0,s.k6)((({navigate:e,isActive:l})=>[(0,s.Lk)("button",{onClick:e,class:(0,i.C4)(["w-full text-left px-4 py-2 flex items-center transition-all duration-300 pl-10",l?"bg-primary/10 text-primary":"text-light-text-secondary hover:bg-primary/5 hover:text-primary"])},t[18]||(t[18]=[(0,s.Lk)("i",{class:"ri-user-settings-line mr-2 text-base"},null,-1),(0,s.Lk)("span",{class:"font-medium text-sm"},"用户管理",-1)]),10,U)])),_:1})],512),[[a.aG,c.value.system]])])],64)):((0,s.uX)(),(0,s.CE)("div",H,[t[19]||(t[19]=(0,s.Lk)("div",{class:"text-light-text-secondary mb-4"},[(0,s.Lk)("i",{class:"ri-lock-line text-3xl"})],-1)),t[20]||(t[20]=(0,s.Lk)("p",{class:"text-light-text-secondary mb-4"},"请登录以访问系统功能",-1)),(0,s.bF)(l,{to:"/login"},{default:(0,s.k6)((({navigate:e})=>[(0,s.Lk)("button",{onClick:e,class:"w-full bg-primary hover:bg-primary-light text-white transition-all duration-300 py-2 rounded-lg shadow-md hover:shadow-lg font-medium text-sm"}," 登录 ",8,z)])),_:1}),(0,s.bF)(l,{to:"/setup-2fa"},{default:(0,s.k6)((({navigate:e})=>[(0,s.Lk)("button",{onClick:e,class:"w-full mt-2 bg-white hover:bg-gray-50 text-light-text-secondary border border-light-border transition-all duration-300 py-2 rounded-lg shadow-sm hover:shadow font-medium text-sm"}," 注册 ",8,q)])),_:1})]))])])}}};const J=(0,g.A)(O,[["__scopeId","data-v-704cf667"]]);var G=J;const Z={class:"min-h-screen bg-light-bg"};var Y={__name:"App",setup(e){const t=(0,r.Pj)(),l=(0,s.EW)((()=>t.state.isAuthenticated));return(e,t)=>{const a=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",Z,[(0,s.bF)(C),l.value?((0,s.uX)(),(0,s.Wv)(G,{key:0})):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,i.C4)([{"pl-64":l.value,"pl-0":!l.value},"pt-12 transition-all duration-300"])},[(0,s.bF)(a)],2)])}}};const ee=(0,g.A)(Y,[["__scopeId","data-v-3eb9644a"]]);var te=ee,le=l(4373);const ae=le.A.create({baseURL:"/",withCredentials:!0});ae.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e)));var se=ae,ie=(0,r.y$)({state:{isAuthenticated:!1},mutations:{setAuthentication(e,t){e.isAuthenticated=t}},actions:{async login({commit:e},{account:t,code:l}){try{const a=await se.post("/auth/validate",{account:t,code:l});if("验证码有效"===a.data.status)return localStorage.setItem("token",a.data.token),e("setAuthentication",!0),!0}catch(a){return console.error("Login failed:",a),!1}},async logout({commit:e}){try{await se.post("/auth/logout"),localStorage.removeItem("token"),e("setAuthentication",!1)}catch(t){console.error("Logout failed:",t),localStorage.removeItem("token"),e("setAuthentication",!1)}},async checkAuth({commit:e}){try{const t=await se.get("/auth/check");e("setAuthentication",t.data.authenticated)}catch(t){e("setAuthentication",!1)}}}});const re={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},oe={class:"container mx-auto px-6 pt-6 pb-20 flex-1"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},de={class:"flex items-start space-x-4 relative z-10"},ce={class:"feature-icon-wrapper"},ue={class:"flex-1"},ge={class:"text-base font-medium tracking-wide group-hover:text-primary-dark transition-colors duration-300"},xe={class:"text-light-text-secondary text-sm leading-relaxed mt-2 group-hover:text-light-text-primary transition-colors duration-300"},me={class:"mt-16 bg-white/70 backdrop-blur-lg p-8 rounded-2xl border border-light-border shadow-light-card"},pe={class:"grid grid-cols-2 md:grid-cols-4 gap-6"},be={class:"text-2xl font-bold text-primary mb-2"},he={class:"text-sm text-light-text-secondary"};var fe={__name:"HomePage",setup(e){const t=(0,o.KR)([{icon:"ri-radar-line",title:"资产发现",description:"快速准确的子域名扫描，全面掌握数字资产分布。"},{icon:"ri-scan-2-line",title:"端口扫描",description:"高效的端口检测，精准识别开放服务和组件。"},{icon:"ri-folders-line",title:"路径扫描",description:"深度探索网站结构，发现隐藏资源和目录。"},{icon:"ri-fingerprint-line",title:"指纹识别",description:"准确识别技术组件和版本，提供详细分析。"},{icon:"ri-bug-line",title:"漏洞扫描",description:"检测常见安全漏洞，提前发现潜在风险。"},{icon:"ri-shield-keyhole-line",title:"漏洞利用",description:"验证漏洞可利用性，评估实际安全风险。"},{icon:"ri-dashboard-3-line",title:"可视化面板",description:"直观的数据展示，清晰的扫描进度管理。"},{icon:"ri-task-line",title:"任务管理",description:"灵活的任务调度系统，高效利用资源。"},{icon:"ri-settings-3-line",title:"系统配置",description:"全面的配置选项，按需调整扫描参数。"}]),l=(0,o.KR)([{value:"99.8%",label:"扫描准确率"},{value:"2000+",label:"并发扫描能力"},{value:"15+",label:"集成工具"},{value:"24/7",label:"全天候运行"}]);return(e,a)=>((0,s.uX)(),(0,s.CE)("div",re,[(0,s.Lk)("div",oe,[a[2]||(a[2]=(0,s.Fv)('<div class="text-center mb-16 relative" data-v-6f75d024><div class="absolute inset-0 bg-gradient-to-r from-primary/5 via-blue-500/5 to-primary/5 blur-3xl -z-10" data-v-6f75d024></div><h1 class="text-4xl font-medium mb-4 tracking-tight text-light-text-primary" data-v-6f75d024> YangMiee 攻击面梳理平台 </h1><p class="text-lg text-light-text-secondary font-light tracking-wide max-w-2xl mx-auto" data-v-6f75d024> 简单、高效、专业的资产扫描工具 </p><div class="mt-8 flex justify-center space-x-4" data-v-6f75d024><button class="px-6 py-2.5 bg-primary hover:bg-primary-light rounded-lg shadow-light-card transition-all duration-300 text-sm font-medium flex items-center text-white" data-v-6f75d024><i class="ri-rocket-line mr-2" data-v-6f75d024></i> 开始使用 </button><button class="px-6 py-2.5 bg-white/80 hover:bg-white/90 border border-light-border rounded-lg shadow-light-card transition-all duration-300 text-sm font-medium flex items-center" data-v-6f75d024><i class="ri-information-line mr-2" data-v-6f75d024></i> 了解更多 </button></div></div><div class="mb-8 text-center" data-v-6f75d024><h2 class="text-xl font-medium tracking-wide text-light-text-primary inline-flex items-center" data-v-6f75d024><span class="bg-white/50 h-8 w-8 rounded-lg flex items-center justify-center mr-2" data-v-6f75d024><i class="ri-apps-line text-primary" data-v-6f75d024></i></span> 主要功能 </h2></div>',2)),(0,s.Lk)("div",ne,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"feature-card group relative"},[a[0]||(a[0]=(0,s.Lk)("div",{class:"absolute inset-0 bg-gradient-to-br from-white/0 to-white/0 group-hover:from-primary/5 group-hover:to-primary/10 transition-all duration-500 rounded-2xl"},null,-1)),(0,s.Lk)("div",de,[(0,s.Lk)("div",ce,[(0,s.Lk)("i",{class:(0,i.C4)([e.icon,"feature-icon"])},null,2)]),(0,s.Lk)("div",ue,[(0,s.Lk)("h3",ge,(0,i.v_)(e.title),1),(0,s.Lk)("p",xe,(0,i.v_)(e.description),1)])])])))),128))]),(0,s.Lk)("div",me,[a[1]||(a[1]=(0,s.Lk)("h2",{class:"text-xl font-medium tracking-wide text-light-text-primary mb-6 text-center flex items-center justify-center"},[(0,s.Lk)("span",{class:"bg-white/80 h-8 w-8 rounded-lg flex items-center justify-center mr-2"},[(0,s.Lk)("i",{class:"ri-line-chart-line text-primary"})]),(0,s.eW)(" 技术优势 ")],-1)),(0,s.Lk)("div",pe,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"text-center p-4 rounded-lg bg-white/60 hover:bg-white/90 transition-all duration-300 border border-light-border shadow-light-card"},[(0,s.Lk)("div",be,(0,i.v_)(e.value),1),(0,s.Lk)("div",he,(0,i.v_)(e.label),1)])))),128))])])])]))}};const ke=(0,g.A)(fe,[["__scopeId","data-v-6f75d024"]]);var ve=ke;const ye={class:"bg-light-gradient min-h-screen flex items-center justify-center w-full p-4"},Le={class:"bg-white/70 backdrop-blur-xl p-8 md:p-10 rounded-3xl shadow-light-card w-full max-w-md border border-light-border login-card"},we={class:"space-y-7"},Ce={class:"space-y-1.5"},Re={class:"relative"},_e={class:"space-y-1.5"},Te={class:"relative"},Se={class:"space-y-3 pt-4"},Ee=["disabled"],We={key:0,class:"loading-dots"};function De(e,t,l,r,o,n){const d=(0,s.g2)("PopupNotification");return(0,s.uX)(),(0,s.CE)("div",ye,[(0,s.Lk)("div",Le,[(0,s.Lk)("div",we,[t[11]||(t[11]=(0,s.Fv)('<div class="text-center space-y-3" data-v-3a82afe2><div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-blue-500/10 shadow-inner" data-v-3a82afe2><i class="ri-shield-user-line text-2xl text-blue-500" data-v-3a82afe2></i></div><h2 class="text-xl font-medium tracking-wide text-light-text-primary" data-v-3a82afe2> 登录账户 </h2><p class="text-light-text-tertiary text-sm max-w-xs mx-auto" data-v-3a82afe2> 登录您的账户以访问完整功能 </p></div>',1)),(0,s.Lk)("form",{onSubmit:t[3]||(t[3]=(0,a.D$)(((...e)=>r.handleLogin&&r.handleLogin(...e)),["prevent"])),class:"space-y-5"},[(0,s.Lk)("div",Ce,[t[6]||(t[6]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary",for:"account"},[(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("i",{class:"ri-user-line"}),(0,s.Lk)("span",null,"账户")])],-1)),(0,s.Lk)("div",Re,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.account=e),class:"input-field",id:"account",type:"text",placeholder:"输入账户名",autocomplete:"username",required:""},null,512),[[a.Jo,r.account]]),t[5]||(t[5]=(0,s.Lk)("i",{class:"ri-account-circle-line absolute left-3 top-1/2 -translate-y-1/2 text-light-text-tertiary"},null,-1))])]),(0,s.Lk)("div",_e,[t[8]||(t[8]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary",for:"code"},[(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("i",{class:"ri-key-2-line"}),(0,s.Lk)("span",null,"验证码")])],-1)),(0,s.Lk)("div",Te,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.code=e),class:"input-field",id:"code",type:"text",placeholder:"输入验证码",autocomplete:"one-time-code",required:""},null,512),[[a.Jo,r.code]]),t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-lock-password-line absolute left-3 top-1/2 -translate-y-1/2 text-light-text-tertiary"},null,-1))])]),(0,s.Lk)("div",Se,[(0,s.Lk)("button",{type:"submit",class:"primary-button",disabled:r.isLoggingIn},[t[9]||(t[9]=(0,s.Lk)("i",{class:"ri-login-circle-line"},null,-1)),(0,s.Lk)("span",null,(0,i.v_)(r.isLoggingIn?"登录中...":"登录"),1),r.isLoggingIn?((0,s.uX)(),(0,s.CE)("span",We)):(0,s.Q3)("",!0)],8,Ee),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.goToRegister&&r.goToRegister(...e)),type:"button",class:"secondary-button"},t[10]||(t[10]=[(0,s.Lk)("i",{class:"ri-user-add-line"},null,-1),(0,s.Lk)("span",null,"注册账户",-1)]))])],32),t[12]||(t[12]=(0,s.Lk)("div",{class:"flex items-center gap-2 text-xs text-light-text-tertiary justify-center p-3 bg-light-bg rounded-xl border border-light-border"},[(0,s.Lk)("i",{class:"ri-information-line text-light-text-tertiary"}),(0,s.Lk)("span",null,"使用 Google Authenticator 或其他2FA应用生成验证码")],-1))])]),r.showNotification?((0,s.uX)(),(0,s.Wv)(d,{key:0,message:r.notificationMessage,type:r.notificationType,onClose:t[4]||(t[4]=e=>r.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0)])}function Xe(){const e=(0,o.KR)(!1),t=(0,o.KR)(""),l=(0,o.KR)("success"),a={success:{icon:"✓",duration:2e3},warning:{icon:"⚠",duration:3e3},error:{icon:"⚠",duration:3e3}},i=(i,r="success",o)=>{e.value=!1,(0,s.dY)((()=>{t.value=i,l.value=r,e.value=!0;const s=o||a[r].duration;setTimeout((()=>{e.value=!1}),s)}))},r=(e,t)=>{i(e,"success",t)},n=(e,t)=>{i(e,"warning",t)},d=(e,t)=>{i(e,"error",t)};return{showNotification:e,notificationMessage:t,notificationType:l,showNotificationMessage:i,showSuccess:r,showWarning:n,showError:d}}var Pe={name:"LoginPage",components:{PopupNotification:m},setup(){const e=(0,o.KR)(""),t=(0,o.KR)(""),l=(0,o.KR)(!1),a=(0,n.rd)(),s=(0,r.Pj)(),{showNotification:i,notificationMessage:d,notificationType:c,showSuccess:u,showError:g}=Xe(),x=async()=>{if(e.value&&t.value)try{l.value=!0;const i=await s.dispatch("login",{account:e.value,code:t.value});if(!i)throw new Error("登录失败");u("登录成功，正在跳转..."),setTimeout((()=>{a.push({name:"Home"})}),1500)}catch(i){g("登录失败，请检查账户名和验证码")}finally{l.value=!1}else g("请填写账户和验证码")},m=()=>{a.push("/setup-2fa")};return{account:e,code:t,isLoggingIn:l,handleLogin:x,goToRegister:m,showNotification:i,notificationMessage:d,notificationType:c}}};const Ae=(0,g.A)(Pe,[["render",De],["__scopeId","data-v-3a82afe2"]]);var Ie=Ae;const Fe={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Ke={class:"flex items-center justify-between mb-8"},je={class:"mb-10 flex items-center justify-between bg-white/60 p-4 rounded-xl border border-light-border"},Ve={class:"flex items-center"},Me={class:"text-lg font-medium text-light-text-primary"},Qe={class:"flex space-x-6"},$e={class:"text-lg font-medium text-light-text-primary"},Ne={key:0},Be={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Ue={class:"info-card flex flex-col"},He={class:"flex-1 flex items-center"},ze={class:"text-sm text-light-text-primary overflow-hidden text-ellipsis"},qe={class:"info-card"},Oe={class:"flex items-center"},Je={class:"text-xl font-medium text-light-text-primary"},Ge={class:"info-card"},Ze={class:"flex items-center"},Ye={class:"text-xl font-medium text-light-text-primary"},et={class:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-6"},tt={class:"bg-white/60 backdrop-blur-sm border border-light-border rounded-xl p-6 transition-all duration-200"},lt={class:"h-40 flex items-end space-x-1"},at={key:1,class:"flex flex-col items-center justify-center py-16 text-sm text-light-text-secondary"};function st(e,t,l,a,r,o){const n=(0,s.g2)("PopupNotification"),d=(0,s.g2)("PageContainer");return(0,s.uX)(),(0,s.Wv)(d,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",Fe,[(0,s.Lk)("div",Ke,[t[4]||(t[4]=(0,s.Lk)("div",{class:"flex items-center space-x-3"},[(0,s.Lk)("div",{class:"h-10 w-10 flex items-center justify-center bg-primary/10 rounded-lg"},[(0,s.Lk)("i",{class:"ri-dashboard-3-line text-primary text-xl"})]),(0,s.Lk)("h2",{class:"text-xl font-medium tracking-wide text-light-text-primary"}," 系统状态 ")],-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.fetchSystemInfo&&a.fetchSystemInfo(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-white hover:bg-primary/5 text-light-text-secondary hover:text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/20 flex items-center group border border-light-border"},t[3]||(t[3]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2 group-hover:rotate-180 transition-transform duration-500"},null,-1),(0,s.eW)(" 刷新信息 ")]))]),(0,s.Lk)("div",je,[(0,s.Lk)("div",Ve,[t[6]||(t[6]=(0,s.Lk)("div",{class:"h-12 w-12 flex items-center justify-center bg-primary/10 rounded-full mr-4"},[(0,s.Lk)("i",{class:"ri-server-line text-primary text-xl"})],-1)),(0,s.Lk)("div",null,[t[5]||(t[5]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary"},"系统概览",-1)),(0,s.Lk)("h3",Me,(0,i.v_)(a.systemInfo?.osDistribution||"加载中..."),1)])]),(0,s.Lk)("div",Qe,[(0,s.Lk)("div",null,[t[7]||(t[7]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary"},"内核版本",-1)),(0,s.Lk)("p",$e,(0,i.v_)(a.systemInfo?.kernelVersion||"加载中..."),1)]),(0,s.Lk)("div",null,[t[8]||(t[8]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary"},"运行权限",-1)),(0,s.Lk)("p",{class:(0,i.C4)(["text-lg font-medium",{"text-primary":"root"===a.systemInfo?.privileges}])},(0,i.v_)(a.systemInfo?.privileges||"加载中..."),3)])])]),a.systemInfo?((0,s.uX)(),(0,s.CE)("div",Ne,[(0,s.Lk)("div",Be,[(0,s.Lk)("div",Ue,[t[10]||(t[10]=(0,s.Lk)("div",{class:"flex items-center mb-3"},[(0,s.Lk)("div",{class:"h-8 w-8 rounded-md bg-primary/10 flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-folder-line text-primary"})]),(0,s.Lk)("h3",{class:"text-sm font-medium text-light-text-secondary"},"程序运行目录")],-1)),(0,s.Lk)("div",He,[(0,s.Lk)("p",ze,(0,i.v_)(a.systemInfo.currentDirectory),1)]),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>a.copyToClipboard(a.systemInfo.currentDirectory)),class:"mt-3 text-xs text-light-text-secondary hover:text-primary transition-colors duration-300 flex items-center self-end"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-file-copy-line mr-1"},null,-1),(0,s.eW)(" 复制路径 ")]))]),(0,s.Lk)("div",qe,[t[11]||(t[11]=(0,s.Lk)("div",{class:"flex items-center mb-3"},[(0,s.Lk)("div",{class:"h-8 w-8 rounded-md bg-primary/10 flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-computer-line text-primary"})]),(0,s.Lk)("h3",{class:"text-sm font-medium text-light-text-secondary"},"本机 IP")],-1)),(0,s.Lk)("div",Oe,[(0,s.Lk)("p",Je,(0,i.v_)(a.systemInfo.localIP),1)]),t[12]||(t[12]=(0,s.Lk)("div",{class:"mt-3 text-xs text-light-text-disabled"},"内部网络地址",-1))]),(0,s.Lk)("div",Ge,[t[13]||(t[13]=(0,s.Lk)("div",{class:"flex items-center mb-3"},[(0,s.Lk)("div",{class:"h-8 w-8 rounded-md bg-primary/10 flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-global-line text-primary"})]),(0,s.Lk)("h3",{class:"text-sm font-medium text-light-text-secondary"},"外网 IP")],-1)),(0,s.Lk)("div",Ze,[(0,s.Lk)("p",Ye,(0,i.v_)(a.systemInfo.publicIP),1)]),t[14]||(t[14]=(0,s.Lk)("div",{class:"mt-3 text-xs text-light-text-disabled"},"公网访问地址",-1))])]),(0,s.Lk)("div",et,[(0,s.Lk)("div",tt,[t[15]||(t[15]=(0,s.Lk)("div",{class:"flex items-center justify-between mb-4"},[(0,s.Lk)("h3",{class:"text-sm font-medium text-light-text-secondary"},"CPU 使用率"),(0,s.Lk)("span",{class:"text-sm text-light-text-secondary"},"最近24小时")],-1)),(0,s.Lk)("div",lt,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(24,(e=>(0,s.Lk)("div",{key:e,class:"bg-primary/60 h-[80%] w-full rounded-t-sm",style:(0,i.Tr)(`height: ${Math.floor(80*Math.random()+10)}%`)},null,4))),64))]),t[16]||(t[16]=(0,s.Lk)("div",{class:"mt-2 grid grid-cols-4 text-xs text-light-text-disabled"},[(0,s.Lk)("span",null,"24h前"),(0,s.Lk)("span",{class:"text-center"},"18h前"),(0,s.Lk)("span",{class:"text-center"},"12h前"),(0,s.Lk)("span",{class:"text-right"},"现在")],-1))]),t[17]||(t[17]=(0,s.Lk)("div",{class:"bg-white/60 backdrop-blur-sm border border-light-border rounded-xl p-6 transition-all duration-200"},[(0,s.Lk)("div",{class:"flex items-center justify-between mb-4"},[(0,s.Lk)("h3",{class:"text-sm font-medium text-light-text-secondary"},"内存使用情况"),(0,s.Lk)("span",{class:"text-primary text-sm font-medium"},"68% 可用")]),(0,s.Lk)("div",{class:"relative h-40 flex items-center justify-center"},[(0,s.Lk)("div",{class:"absolute inset-0 flex items-center justify-center"},[(0,s.Lk)("svg",{class:"w-32 h-32"},[(0,s.Lk)("circle",{cx:"64",cy:"64",r:"60",fill:"none",stroke:"#f0f2f5","stroke-width":"8"}),(0,s.Lk)("circle",{cx:"64",cy:"64",r:"60",fill:"none",stroke:"#1890ff","stroke-width":"8","stroke-dasharray":"377","stroke-dashoffset":"120","stroke-linecap":"round"})])]),(0,s.Lk)("div",{class:"text-center z-10"},[(0,s.Lk)("p",{class:"text-2xl font-bold text-primary"},"68%"),(0,s.Lk)("p",{class:"text-xs text-light-text-secondary"},"可用内存")])])],-1))])])):((0,s.uX)(),(0,s.CE)("div",at,t[18]||(t[18]=[(0,s.Lk)("svg",{class:"animate-spin mb-4 h-10 w-10 text-primary/70",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[(0,s.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,s.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),(0,s.Lk)("p",null,"获取系统信息中...",-1),(0,s.Lk)("p",{class:"mt-2 text-xs text-light-text-disabled"},"这可能需要几秒钟时间",-1)])))]),a.showNotification?((0,s.uX)(),(0,s.Wv)(n,{key:0,message:a.notificationMessage,type:a.notificationType,onClose:t[2]||(t[2]=e=>a.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0)])),_:1})}const it={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},rt={class:"container mx-auto px-6 py-8 flex-1"};var ot={__name:"PageContainer",setup(e){return(e,t)=>((0,s.uX)(),(0,s.CE)("div",it,[(0,s.Lk)("div",rt,[(0,s.RG)(e.$slots,"default")])]))}};const nt=ot;var dt=nt,ct={name:"SystemConfiguration",components:{PageContainer:dt,PopupNotification:m},setup(){const e=(0,o.KR)(null),{showNotification:t,notificationMessage:l,notificationType:a,showSuccess:i,showError:r}=Xe(),n={currentDirectory:{title:"程序运行目录",key:"currentDirectory"},localIP:{title:"本机 IP",key:"localIP"},publicIP:{title:"外网 IP",key:"publicIP"},kernelVersion:{title:"系统内核",key:"kernelVersion"},osDistribution:{title:"系统版本",key:"osDistribution"},privileges:{title:"运行权限",key:"privileges"}},d=async()=>{e.value=null;try{const t=await se.get("/system/info");t.data?.data?.systemInfo&&setTimeout((()=>{e.value=t.data.data.systemInfo,i("系统信息已更新")}),600)}catch(t){r("获取系统信息失败")}},c=e=>{navigator.clipboard.writeText(e).then((()=>i("已复制到剪贴板"))).catch((()=>r("复制失败")))};return(0,s.sV)((()=>{d()})),{systemInfo:e,systemInfoCards:n,fetchSystemInfo:d,copyToClipboard:c,showNotification:t,notificationMessage:l,notificationType:a}}};const ut=(0,g.A)(ct,[["render",st],["__scopeId","data-v-e1fb1b9c"]]);var gt=ut;const xt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},mt={class:"bg-white/70 backdrop-blur-xl p-6 rounded-2xl shadow-light-card border border-light-border flex items-center"},pt={class:"text-2xl font-semibold text-light-text-primary"},bt={class:"bg-white/70 backdrop-blur-xl p-6 rounded-2xl shadow-light-card border border-light-border flex items-center justify-between"},ht={class:"flex items-center"},ft={class:"text-lg font-medium text-light-text-primary"},kt={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},vt={class:"flex flex-wrap items-center justify-between gap-4 mb-6"},yt={class:"flex items-center gap-3"},Lt={class:"relative"},wt={class:"overflow-x-auto rounded-xl border border-light-border"},Ct={class:"w-full"},Rt={class:"bg-light-bg"},_t={class:"text-left py-3 px-4 text-sm font-medium text-light-text-secondary"},Tt=["checked"],St={class:"py-3 px-4"},Et=["value"],Wt={class:"py-3 px-4 text-sm text-light-text-primary flex items-center"},Dt={class:"w-8 h-8 bg-blue-500/10 rounded-full mr-3 flex items-center justify-center text-blue-500"},Xt={class:"py-3 px-4 text-sm"},Pt={class:"px-2 py-1 rounded-md bg-blue-500/10 text-blue-600 flex items-center w-fit"},At={class:"py-3 px-4"},It=["onClick"],Ft={key:0},Kt={colspan:"4",class:"py-12 text-center text-light-text-secondary"},jt={class:"flex flex-col items-center justify-center"},Vt={key:0},Mt={key:1},Qt={class:"mt-4 text-sm text-light-text-secondary flex justify-between items-center"},$t={class:"flex items-center space-x-2"};function Nt(e,t,l,r,o,n){const d=(0,s.g2)("PopupNotification"),c=(0,s.g2)("ConfirmDialog"),u=(0,s.g2)("PageContainer");return(0,s.uX)(),(0,s.Wv)(u,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",xt,[(0,s.Lk)("div",mt,[t[8]||(t[8]=(0,s.Lk)("div",{class:"h-12 w-12 rounded-xl bg-blue-500/20 flex items-center justify-center mr-4"},[(0,s.Lk)("i",{class:"ri-user-line text-xl text-blue-500"})],-1)),(0,s.Lk)("div",null,[t[7]||(t[7]=(0,s.Lk)("h3",{class:"text-light-text-secondary text-sm font-medium"},"总用户数",-1)),(0,s.Lk)("p",pt,(0,i.v_)(r.users.length),1)])]),(0,s.Lk)("div",bt,[(0,s.Lk)("div",ht,[t[10]||(t[10]=(0,s.Lk)("div",{class:"h-12 w-12 rounded-xl bg-purple-500/20 flex items-center justify-center mr-4"},[(0,s.Lk)("i",{class:"ri-qr-code-line text-xl text-purple-500"})],-1)),(0,s.Lk)("div",null,[t[9]||(t[9]=(0,s.Lk)("h3",{class:"text-light-text-secondary text-sm font-medium"},"二维码登录",-1)),(0,s.Lk)("p",ft,(0,i.v_)(r.qrcodeEnabled?"已启用":"已禁用"),1)])]),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.toggleQRCodeStatus&&r.toggleQRCodeStatus(...e)),class:(0,i.C4)(["relative w-14 h-7 rounded-full transition-colors duration-300 focus:outline-none",r.qrcodeEnabled?"bg-purple-500/70":"bg-light-bg"])},[(0,s.Lk)("span",{class:(0,i.C4)(["absolute left-1 top-1 w-5 h-5 rounded-full bg-white shadow-md transition-transform duration-300",r.qrcodeEnabled?"transform translate-x-7":""])},null,2)],2)])]),(0,s.Lk)("div",kt,[(0,s.Lk)("div",vt,[t[13]||(t[13]=(0,s.Lk)("h2",{class:"text-xl font-medium tracking-wide flex items-center text-light-text-primary"},[(0,s.Lk)("i",{class:"ri-user-settings-line mr-2 text-blue-500"}),(0,s.eW)(" 用户管理 ")],-1)),(0,s.Lk)("div",yt,[(0,s.Lk)("div",Lt,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.searchQuery=e),placeholder:"搜索用户...",class:"bg-white border border-light-border rounded-xl py-2 pl-10 pr-4 w-64 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/40 focus:border-blue-500/40 transition-all duration-200"},null,512),[[a.Jo,r.searchQuery]]),t[11]||(t[11]=(0,s.Lk)("i",{class:"ri-search-line absolute left-3 top-2.5 text-light-text-secondary"},null,-1))]),r.selectedUsers.length>0?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[2]||(t[2]=(...e)=>r.handleBatchDelete&&r.handleBatchDelete(...e)),class:"px-4 py-2 rounded-xl text-sm font-medium bg-red-500/50 hover:bg-red-600/60 text-white transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/50 flex items-center"},[t[12]||(t[12]=(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1)),(0,s.eW)(" 批量删除 ("+(0,i.v_)(r.selectedUsers.length)+") ",1)])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",wt,[(0,s.Lk)("table",Ct,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",Rt,[(0,s.Lk)("th",_t,[(0,s.Lk)("input",{type:"checkbox",checked:r.isAllSelected,onChange:t[3]||(t[3]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e)),class:"rounded border-light-border text-blue-500 focus:ring-blue-500/50 bg-white"},null,40,Tt)]),t[14]||(t[14]=(0,s.Lk)("th",{class:"text-left py-3 px-4 text-sm font-medium text-light-text-secondary"}," 用户名 ",-1)),t[15]||(t[15]=(0,s.Lk)("th",{class:"text-left py-3 px-4 text-sm font-medium text-light-text-secondary"}," 登录次数 ",-1)),t[16]||(t[16]=(0,s.Lk)("th",{class:"text-left py-3 px-4 text-sm font-medium text-light-text-secondary"}," 操作 ",-1))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.filteredUsers,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.account,class:"border-t border-light-border hover:bg-light-bg transition-colors duration-200"},[(0,s.Lk)("td",St,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>r.selectedUsers=e),value:e.account,class:"rounded border-light-border text-blue-500 focus:ring-blue-500/50 bg-white"},null,8,Et),[[a.lH,r.selectedUsers]])]),(0,s.Lk)("td",Wt,[(0,s.Lk)("div",Dt,(0,i.v_)(e.account.charAt(0).toUpperCase()),1),(0,s.eW)(" "+(0,i.v_)(e.account),1)]),(0,s.Lk)("td",Xt,[(0,s.Lk)("span",Pt,[t[17]||(t[17]=(0,s.Lk)("i",{class:"ri-login-circle-line mr-2"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.loginCount),1)])]),(0,s.Lk)("td",At,[(0,s.Lk)("button",{onClick:t=>r.handleDelete(e.account),class:"p-2 rounded-lg text-sm font-medium bg-red-500/20 hover:bg-red-500/30 text-red-600 transition-all duration-200 focus:outline-none",title:"删除用户"},t[18]||(t[18]=[(0,s.Lk)("i",{class:"ri-delete-bin-line"},null,-1)]),8,It)])])))),128)),0===r.filteredUsers.length?((0,s.uX)(),(0,s.CE)("tr",Ft,[(0,s.Lk)("td",Kt,[(0,s.Lk)("div",jt,[t[19]||(t[19]=(0,s.Lk)("i",{class:"ri-user-search-line text-4xl mb-3 text-light-text-disabled"},null,-1)),r.searchQuery?((0,s.uX)(),(0,s.CE)("p",Vt,' 未找到匹配 "'+(0,i.v_)(r.searchQuery)+'" 的用户 ',1)):((0,s.uX)(),(0,s.CE)("p",Mt,"暂无用户数据"))])])])):(0,s.Q3)("",!0)])])]),(0,s.Lk)("div",Qt,[(0,s.Lk)("p",null,"共 "+(0,i.v_)(r.filteredUsers.length)+" 个用户",1),(0,s.Lk)("div",$t,[t[21]||(t[21]=(0,s.Lk)("span",null,"每页显示:",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.perPage=e),class:"bg-white border border-light-border rounded-md px-2 py-1 text-light-text-primary text-sm"},t[20]||(t[20]=[(0,s.Lk)("option",null,"10",-1),(0,s.Lk)("option",null,"20",-1),(0,s.Lk)("option",null,"50",-1)]),512),[[a.u1,r.perPage]])])])]),r.showNotification?((0,s.uX)(),(0,s.Wv)(d,{key:0,message:r.notificationMessage,type:r.notificationType,onClose:t[6]||(t[6]=e=>r.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(c,{show:r.showDialog,title:r.dialogTitle,message:r.dialogMessage,type:r.dialogType,onConfirm:r.handleConfirm,onCancel:r.handleCancel},null,8,["show","title","message","type","onConfirm","onCancel"])])),_:1})}const Bt={class:"flex items-center mb-4"},Ut={class:"text-lg font-medium text-light-text-primary"},Ht={class:"ml-13 mb-6"},zt={class:"text-sm text-light-text-secondary leading-relaxed"},qt={class:"flex flex-col-reverse sm:flex-row sm:space-x-3 space-y-2 space-y-reverse sm:space-y-0"},Ot={class:"flex items-center justify-center"},Jt={class:"flex items-center justify-center"};var Gt={__name:"ConfirmDialog",props:{show:Boolean,title:{type:String,default:"确认操作"},message:{type:String,required:!0},type:{type:String,default:"info",validator:e=>["info","warning","danger"].includes(e)},confirmText:{type:String,default:"确认"},cancelText:{type:String,default:"取消"},closeOnBackdrop:{type:Boolean,default:!0}},emits:["confirm","cancel"],setup(e,{emit:t}){const l=e,r=t,n=(0,o.KR)(null),d=(0,o.KR)(null),c=(0,o.KR)(null),u=()=>{r("confirm")},g=()=>{r("cancel")},x=()=>{l.closeOnBackdrop&&g()};return(0,s.wB)((()=>l.show),(async e=>{e?(await(0,s.dY)(),"danger"===l.type?c.value?.focus():d.value?.focus(),document.body.style.overflow="hidden"):document.body.style.overflow=""}),{immediate:!0}),(0,s.sV)((()=>{const e=e=>{l.show&&("Escape"===e.key?g():"Enter"===e.key&&u())};window.addEventListener("keydown",e),(0,s.hi)((()=>{window.removeEventListener("keydown",e),document.body.style.overflow=""}))})),(t,l)=>((0,s.uX)(),(0,s.Wv)(s.Im,{to:"body"},[(0,s.bF)(a.eB,{name:"dialog"},{default:(0,s.k6)((()=>[e.show?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"fixed inset-0 flex items-center justify-center z-50 px-4",onClick:x,onKeydown:(0,a.jR)(g,["esc"]),tabindex:"-1"},[l[2]||(l[2]=(0,s.Lk)("div",{class:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300"},null,-1)),(0,s.Lk)("div",{ref_key:"dialogRef",ref:n,class:"bg-white/90 backdrop-blur-xl relative w-full max-w-md p-8 rounded-2xl shadow-light-card border border-light-border transform transition-all duration-300",onClick:l[0]||(l[0]=(0,a.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",Bt,[(0,s.Lk)("div",{class:(0,i.C4)(["w-10 h-10 rounded-lg flex items-center justify-center mr-3","danger"===e.type?"bg-red-500/10 text-red-500":"warning"===e.type?"bg-yellow-500/10 text-yellow-600":"bg-blue-500/10 text-blue-500"])},[(0,s.Lk)("i",{class:(0,i.C4)(["danger"===e.type?"ri-error-warning-line":"warning"===e.type?"ri-alert-line":"ri-question-line","text-xl"])},null,2)],2),(0,s.Lk)("h2",Ut,(0,i.v_)(e.title),1)]),(0,s.Lk)("div",Ht,[(0,s.Lk)("p",zt,(0,i.v_)(e.message),1)]),(0,s.Lk)("div",qt,[(0,s.Lk)("button",{ref_key:"cancelButtonRef",ref:c,onClick:g,class:"sm:flex-1 px-4 py-2.5 rounded-xl border border-light-border bg-white hover:bg-light-bg text-sm font-medium text-light-text-secondary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-200"},[(0,s.Lk)("span",Ot,[l[1]||(l[1]=(0,s.Lk)("i",{class:"ri-close-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.cancelText),1)])],512),(0,s.Lk)("button",{ref_key:"confirmButtonRef",ref:d,onClick:u,class:(0,i.C4)(["sm:flex-1 px-4 py-2.5 rounded-xl text-sm font-medium border","transition-all duration-200","focus:outline-none focus:ring-2","danger"===e.type?"bg-red-50 hover:bg-red-100 focus:ring-red-500/20 text-red-600 border-red-200":"warning"===e.type?"bg-yellow-50 hover:bg-yellow-100 focus:ring-yellow-500/20 text-yellow-600 border-yellow-200":"bg-blue-50 hover:bg-blue-100 focus:ring-blue-500/20 text-blue-600 border-blue-200"])},[(0,s.Lk)("span",Jt,[(0,s.Lk)("i",{class:(0,i.C4)(["danger"===e.type?"ri-delete-bin-line":"warning"===e.type?"ri-alert-line":"ri-check-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.confirmText),1)])],2)])],512)],32)):(0,s.Q3)("",!0)])),_:1})]))}};const Zt=(0,g.A)(Gt,[["__scopeId","data-v-7ed5e600"]]);var Yt=Zt;function el(){const e=(0,o.KR)(!1),t=(0,o.KR)(""),l=(0,o.KR)(""),a=(0,o.KR)("info");let s=null;const i=({title:i="确认",message:r,type:o="info"})=>new Promise((n=>{e.value=!0,t.value=i,l.value=r,a.value=o,s=n})),r=()=>{e.value=!1,s&&(s(!0),s=null)},n=()=>{e.value=!1,s&&(s(!1),s=null)};return{showDialog:e,dialogTitle:t,dialogMessage:l,dialogType:a,confirm:i,handleConfirm:r,handleCancel:n}}var tl={name:"UserManagement",components:{PageContainer:dt,PopupNotification:m,ConfirmDialog:Yt},setup(){const e=(0,o.KR)([]),t=(0,o.KR)([]),l=(0,o.KR)(!1),a=(0,o.KR)(""),i=(0,o.KR)(10),{showNotification:r,notificationMessage:n,notificationType:d,showSuccess:c,showError:u}=Xe(),{showDialog:g,dialogTitle:x,dialogMessage:m,dialogType:p,confirm:b,handleConfirm:h,handleCancel:f}=el(),k=(0,s.EW)((()=>a.value?e.value.filter((e=>e.account.toLowerCase().includes(a.value.toLowerCase()))):e.value)),v=async()=>{try{const t=await se.get("/users");e.value=t.data}catch(t){u("获取用户列表失败")}},y=async()=>{if(0!==t.value.length)try{const e=await b({title:"确认批量删除",message:`是否确认删除选中的 ${t.value.length} 个用户？此操作不可撤销。`,type:"danger"});if(e){const e=await se.delete("/users",{data:{accounts:t.value}}),l=e.data.result;if(l.success.length>0&&c(`成功删除 ${l.success.length} 个用户`),Object.keys(l.failed).length>0){const e=Object.keys(l.failed).length;u(`${e} 个用户删除失败`)}t.value=[],await v()}}catch(e){u("批量删除用户失败")}},L=async e=>{try{const t=await b({title:"确认删除",message:`是否确认删除用户 ${e}？此操作不可撤销。`,type:"danger"});if(t){const t=await se.delete("/users",{data:{accounts:[e]}}),l=t.data.result;l.success.includes(e)?c(`已删除用户 ${e}`):u(`删除用户 ${e} 失败：${l.failed[e]}`),await v()}}catch(t){u(`删除用户 ${e} 失败`)}},w=async()=>{try{await se.post("/auth/qrcode/status",{enabled:!l.value}),l.value=!l.value,c("二维码登录已"+(l.value?"启用":"禁用"))}catch(e){u("更新二维码接口状态失败")}},C=async()=>{try{const e=await se.get("/auth/qrcode/status");l.value=e.data.enabled}catch(e){u("获取二维码接口状态失败")}},R=(0,s.EW)((()=>k.value.length>0&&t.value.length===k.value.length)),_=()=>{R.value?t.value=[]:t.value=k.value.map((e=>e.account))};return(0,s.sV)((()=>{v(),C()})),{users:e,filteredUsers:k,selectedUsers:t,isAllSelected:R,qrcodeEnabled:l,searchQuery:a,perPage:i,showNotification:r,notificationMessage:n,notificationType:d,showDialog:g,dialogTitle:x,dialogMessage:m,dialogType:p,handleConfirm:h,handleCancel:f,handleDelete:L,handleBatchDelete:y,toggleSelectAll:_,toggleQRCodeStatus:w}}};const ll=(0,g.A)(tl,[["render",Nt],["__scopeId","data-v-56019958"]]);var al=ll;const sl={class:"bg-light-gradient flex items-center justify-center min-h-screen p-4"},il={class:"bg-white/70 backdrop-blur-xl p-8 md:p-10 rounded-3xl shadow-light-card w-full max-w-md border border-light-border register-card"},rl={class:"space-y-6"},ol={key:0,class:"text-center p-6 bg-red-500/5 rounded-xl border border-red-500/20"},nl={key:1,class:"space-y-6"},dl={key:0,class:"space-y-4"},cl={class:"bg-light-bg p-6 rounded-2xl border border-light-border flex flex-col items-center qr-container hover:border-emerald-500/30 transition-colors duration-300"},ul={class:"qr-overlay flex items-center justify-center"},gl=["src"],xl={class:"bg-light-bg p-5 rounded-xl space-y-3 border border-light-border"},ml={class:"flex items-center justify-between"},pl={class:"flex items-center gap-2"},bl={class:"text-sm text-light-text-primary font-mono"},hl=["title"],fl={key:0,class:"copy-indicator"},kl={key:1,class:"flex flex-col items-center justify-center py-12"},vl={key:2,class:"bg-light-bg p-5 rounded-xl border border-light-border space-y-4"},yl={class:"space-y-3 pt-2"},Ll=["disabled"];function wl(e,t,l,a,r,o){const n=(0,s.g2)("PopupNotification");return(0,s.uX)(),(0,s.CE)("div",sl,[(0,s.Lk)("div",il,[(0,s.Lk)("div",rl,[t[15]||(t[15]=(0,s.Fv)('<div class="flex flex-col items-center text-center space-y-3" data-v-1b7d966f><div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-emerald-500/10 shadow-inner" data-v-1b7d966f><i class="ri-shield-keyhole-line text-2xl text-emerald-500" data-v-1b7d966f></i></div><div data-v-1b7d966f><h2 class="text-xl font-medium tracking-wide text-light-text-primary" data-v-1b7d966f> 设置双重认证 </h2><p class="text-light-text-tertiary text-sm mt-1" data-v-1b7d966f> 通过扫描二维码创建您的安全账户 </p></div></div>',1)),a.interfaceClosed?((0,s.uX)(),(0,s.CE)("div",ol,t[5]||(t[5]=[(0,s.Lk)("div",{class:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-red-500/10 mb-3"},[(0,s.Lk)("i",{class:"ri-close-circle-line text-xl text-red-500"})],-1),(0,s.Lk)("p",{class:"text-red-500 text-sm font-medium mb-1"},"注册通道已关闭",-1),(0,s.Lk)("p",{class:"text-light-text-secondary text-sm"},"系统维护中，请稍后重试",-1)]))):((0,s.uX)(),(0,s.CE)("div",nl,[a.qrCodeUrl?((0,s.uX)(),(0,s.CE)("div",dl,[(0,s.Lk)("div",cl,[(0,s.Lk)("div",ul,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.fetchQRCode&&a.fetchQRCode(...e)),class:"refresh-qr-button"},t[6]||(t[6]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-1.5"},null,-1),(0,s.eW)(" 刷新二维码 ")]))]),(0,s.Lk)("img",{src:a.qrCodeUrl,alt:"认证二维码",class:"mx-auto w-48 h-48 qr-image"},null,8,gl),t[7]||(t[7]=(0,s.Lk)("p",{class:"text-xs text-light-text-tertiary mt-2"},[(0,s.Lk)("i",{class:"ri-time-line mr-1"}),(0,s.eW)(" 二维码有效期为10分钟 ")],-1))]),(0,s.Lk)("div",xl,[(0,s.Lk)("div",ml,[t[9]||(t[9]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary"},"账户名称",-1)),(0,s.Lk)("div",pl,[(0,s.Lk)("span",bl,(0,i.v_)(a.accountName),1),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.copyAccountName&&a.copyAccountName(...e)),class:(0,i.C4)(["p-1.5 hover:bg-light-bg-hover rounded-lg transition-colors relative",{copied:a.copied}]),title:a.copied?"已复制":"复制账户名"},[t[8]||(t[8]=(0,s.Lk)("i",{class:"ri-file-copy-line text-light-text-tertiary group-hover:text-light-text-secondary"},null,-1)),a.copied?((0,s.uX)(),(0,s.CE)("span",fl)):(0,s.Q3)("",!0)],10,hl)])]),t[10]||(t[10]=(0,s.Lk)("div",{class:"flex items-center gap-1.5 text-xs text-light-text-tertiary bg-blue-500/5 p-2 rounded-lg"},[(0,s.Lk)("i",{class:"ri-information-line text-blue-500"}),(0,s.Lk)("span",null,"请妥善保管账户名称，用于登录验证")],-1))])])):a.loading?((0,s.uX)(),(0,s.CE)("div",kl,t[11]||(t[11]=[(0,s.Lk)("div",{class:"loading-spinner mb-4"},null,-1),(0,s.Lk)("p",{class:"text-sm text-light-text-secondary"},"正在生成二维码...",-1)]))):((0,s.uX)(),(0,s.CE)("div",vl,t[12]||(t[12]=[(0,s.Fv)('<div class="flex items-start gap-3" data-v-1b7d966f><div class="flex-shrink-0 w-8 h-8 rounded-full bg-emerald-500/10 flex items-center justify-center text-emerald-500" data-v-1b7d966f><i class="ri-google-line" data-v-1b7d966f></i></div><div data-v-1b7d966f><h3 class="text-sm font-medium text-light-text-primary mb-1" data-v-1b7d966f> 使用 Google Authenticator </h3><p class="text-xs text-light-text-tertiary leading-relaxed" data-v-1b7d966f> 扫描二维码以启用双重认证，增强账户安全性 </p></div></div><div class="flex items-start gap-3" data-v-1b7d966f><div class="flex-shrink-0 w-8 h-8 rounded-full bg-emerald-500/10 flex items-center justify-center text-emerald-500" data-v-1b7d966f><i class="ri-lock-password-line" data-v-1b7d966f></i></div><div data-v-1b7d966f><h3 class="text-sm font-medium text-light-text-primary mb-1" data-v-1b7d966f> 安全登录保障 </h3><p class="text-xs text-light-text-tertiary leading-relaxed" data-v-1b7d966f> 通过验证码进行二次验证，有效防止未授权访问 </p></div></div>',2)]))),(0,s.Lk)("div",yl,[a.qrCodeUrl?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[2]||(t[2]=(...e)=>a.fetchQRCode&&a.fetchQRCode(...e)),disabled:a.loading,class:"primary-button"},t[13]||(t[13]=[(0,s.Lk)("i",{class:"ri-qr-code-line mr-1.5"},null,-1),(0,s.eW)(" 生成二维码 ")]),8,Ll)),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>a.goToLogin&&a.goToLogin(...e)),class:"secondary-button"},t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-login-circle-line mr-1.5"},null,-1),(0,s.eW)(" 去登录 ")]))])]))])]),a.showNotification?((0,s.uX)(),(0,s.Wv)(n,{key:0,message:a.notificationMessage,type:a.notificationType,onClose:t[4]||(t[4]=e=>a.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0)])}var Cl={name:"GoogleAuthQRCode",components:{PopupNotification:m},setup(){const e=(0,n.rd)(),t=(0,o.KR)(""),l=(0,o.KR)(!1),a=(0,o.KR)(!1),s=(0,o.KR)(""),i=(0,o.KR)(!1),{showNotification:r,notificationMessage:d,notificationType:c,showSuccess:u,showError:g}=Xe(),x=async()=>{try{await navigator.clipboard.writeText(s.value),i.value=!0,u("账户名已复制到剪贴板"),setTimeout((()=>{i.value=!1}),2e3)}catch(e){g("复制失败，请手动复制")}},m=async()=>{l.value=!0;try{const e=await se.get("/auth/qrcode"),{qrcode:l,account:i}=e.data;t.value=`data:image/png;base64,${l}`,s.value=i,a.value=!1,u("二维码已成功生成")}catch(e){console.error("获取二维码失败:",e),a.value=!0,"二维码接口已关闭"===e.response?.data?.error?g("注册接口暂时关闭，请稍后再试"):g("生成二维码失败，请重试")}finally{l.value=!1}},p=()=>{e.push("/login")};return{qrCodeUrl:t,loading:l,interfaceClosed:a,accountName:s,copied:i,fetchQRCode:m,copyAccountName:x,showNotification:r,notificationMessage:d,notificationType:c,goToLogin:p}}};const Rl=(0,g.A)(Cl,[["render",wl],["__scopeId","data-v-1b7d966f"]]);var _l=Rl;const Tl={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Sl={class:"flex items-center justify-between mb-6"},El={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Wl={class:"lg:col-span-2"},Dl={class:"bg-white/70 backdrop-blur-xl p-6 rounded-2xl shadow-light-card border border-light-border h-full"},Xl={class:"lg:col-span-1"},Pl={class:"bg-white/70 backdrop-blur-xl p-6 rounded-2xl shadow-light-card border border-light-border sticky top-24"},Al={class:"fixed bottom-6 right-6 flex flex-col space-y-3"};function Il(e,t,l,a,i,r){const o=(0,s.g2)("TaskList"),n=(0,s.g2)("TaskForm"),d=(0,s.g2)("PopupNotification"),c=(0,s.g2)("ConfirmDialog"),u=(0,s.g2)("PageContainer");return(0,s.uX)(),(0,s.Wv)(u,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",Tl,[(0,s.Lk)("div",Sl,[t[5]||(t[5]=(0,s.Lk)("h1",{class:"text-2xl font-bold text-light-text-primary flex items-center"},[(0,s.Lk)("i",{class:"ri-task-line mr-3 text-primary"}),(0,s.eW)(" 任务管理中心 ")],-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.handleRefreshTasks&&a.handleRefreshTasks(...e)),class:"px-4 py-2 rounded-xl text-sm font-medium bg-white/80 hover:bg-white/90 text-light-text-secondary hover:text-primary transition-all duration-200 flex items-center border border-light-border shadow-light-card"},t[4]||(t[4]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2"},null,-1),(0,s.eW)(" 刷新任务 ")]))]),(0,s.Lk)("div",El,[(0,s.Lk)("div",Wl,[(0,s.Lk)("div",Dl,[(0,s.bF)(o,{tasks:a.tasks,onToggleTask:a.toggleTask,onStopTask:a.stopTask,onDeleteTask:a.handleDelete,onRefreshTasks:a.handleRefreshTasks,onBatchStart:a.handleBatchStart,onBatchStop:a.handleBatchStop,onBatchDelete:a.handleBatchDelete},null,8,["tasks","onToggleTask","onStopTask","onDeleteTask","onRefreshTasks","onBatchStart","onBatchStop","onBatchDelete"])])]),(0,s.Lk)("div",Xl,[(0,s.Lk)("div",Pl,[t[6]||(t[6]=(0,s.Lk)("div",{class:"flex items-center mb-4"},[(0,s.Lk)("i",{class:"ri-add-circle-line mr-2 text-primary text-xl"}),(0,s.Lk)("h2",{class:"text-lg font-medium text-light-text-primary"},"创建新任务")],-1)),(0,s.bF)(n,{onCreateTask:a.createTask},null,8,["onCreateTask"])])])]),(0,s.Lk)("div",Al,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.scrollToTop&&a.scrollToTop(...e)),class:"w-12 h-12 rounded-full bg-primary/90 hover:bg-primary text-white flex items-center justify-center shadow-light-dropdown transition-all duration-200 hover:transform hover:scale-105",title:"返回顶部"},t[7]||(t[7]=[(0,s.Lk)("i",{class:"ri-arrow-up-line text-xl"},null,-1)])),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>a.scrollToForm&&a.scrollToForm(...e)),class:"w-12 h-12 rounded-full bg-primary/90 hover:bg-primary text-white flex items-center justify-center shadow-light-dropdown transition-all duration-200 hover:transform hover:scale-105",title:"创建任务"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"ri-add-line text-xl"},null,-1)]))])]),a.showNotification?((0,s.uX)(),(0,s.Wv)(d,{key:0,message:a.notificationMessage,type:a.notificationType,onClose:t[3]||(t[3]=e=>a.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(c,{show:a.showDialog,title:a.dialogTitle,message:a.dialogMessage,confirmText:a.confirmText,cancelText:a.cancelText,type:a.dialogType,onConfirm:a.handleConfirm,onCancel:a.handleCancel},null,8,["show","title","message","confirmText","cancelText","type","onConfirm","onCancel"])])),_:1})}const Fl={class:"flex flex-col"},Kl={class:"list-header"},jl={class:"flex flex-wrap gap-3"},Vl={key:0,class:"flex gap-3 animate-fadeIn"},Ml={key:0,class:"bg-white/80 rounded-xl border border-light-border overflow-hidden shadow-light-card"},Ql={class:"overflow-x-auto scrollbar-thin"},$l={class:"task-table"},Nl={class:"bg-light-bg"},Bl={class:"table-header w-[60px]"},Ul={class:"flex items-center justify-center"},Hl=["checked"],zl={class:"table-cell w-[60px]"},ql={class:"flex items-center justify-center"},Ol=["value"],Jl={class:"table-cell w-[120px] whitespace-nowrap font-mono text-xs"},Gl={class:"table-cell w-[140px] whitespace-nowrap"},Zl={class:"flex items-center"},Yl={class:"table-cell w-[180px] max-w-[180px]"},ea=["data-tooltip"],ta={class:"table-cell w-[100px]"},la={class:"table-cell w-[160px] whitespace-nowrap"},aa={class:"table-cell w-[160px] whitespace-nowrap text-light-text-disabled"},sa={class:"table-cell min-w-[120px] max-w-[200px]"},ia=["data-tooltip"],ra={key:1,class:"text-light-text-disabled"},oa={class:"table-cell w-[160px] whitespace-nowrap"},na={class:"flex gap-2"},da=["onClick","disabled"],ca=["onClick","disabled"],ua=["onClick"],ga={key:1,class:"empty-state bg-white/80 rounded-xl border border-light-border shadow-light-card my-4"},xa={class:"flex gap-4"};function ma(e,t,l,r,o,n){const d=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",Fl,[(0,s.Lk)("div",Kl,[t[10]||(t[10]=(0,s.Lk)("h2",{class:"list-title"},[(0,s.Lk)("i",{class:"ri-task-line"}),(0,s.eW)(" 任务管理 ")],-1)),(0,s.Lk)("div",jl,[o.selectedTasks.length>0?((0,s.uX)(),(0,s.CE)("div",Vl,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.handleBatchStart&&n.handleBatchStart(...e)),class:"btn-success"},[t[6]||(t[6]=(0,s.Lk)("i",{class:"ri-play-line mr-2"},null,-1)),(0,s.eW)(" 批量启动 ("+(0,i.v_)(o.selectedTasks.length)+") ",1)]),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>n.handleBatchStop&&n.handleBatchStop(...e)),class:"btn-warning"},[t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-stop-line mr-2"},null,-1)),(0,s.eW)(" 批量终止 ("+(0,i.v_)(o.selectedTasks.length)+") ",1)]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>n.handleBatchDelete&&n.handleBatchDelete(...e)),class:"btn-danger"},[t[8]||(t[8]=(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1)),(0,s.eW)(" 批量删除 ("+(0,i.v_)(o.selectedTasks.length)+") ",1)])])):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[3]||(t[3]=t=>e.$emit("refresh-tasks")),class:"btn-default"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2"},null,-1),(0,s.eW)(" 刷新列表 ")]))])]),l.tasks?.length>0?((0,s.uX)(),(0,s.CE)("div",Ml,[(0,s.Lk)("div",Ql,[(0,s.Lk)("table",$l,[(0,s.Lk)("thead",Nl,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",Bl,[(0,s.Lk)("div",Ul,[(0,s.Lk)("input",{type:"checkbox",checked:n.isAllSelected,onChange:t[4]||(t[4]=(...e)=>n.toggleSelectAll&&n.toggleSelectAll(...e)),class:"checkbox-input"},null,40,Hl)])]),t[11]||(t[11]=(0,s.Lk)("th",{class:"table-header"},"任务ID",-1)),t[12]||(t[12]=(0,s.Lk)("th",{class:"table-header"},"描述",-1)),t[13]||(t[13]=(0,s.Lk)("th",{class:"table-header"},"目标",-1)),t[14]||(t[14]=(0,s.Lk)("th",{class:"table-header"},"状态",-1)),t[15]||(t[15]=(0,s.Lk)("th",{class:"table-header"},"创建时间",-1)),t[16]||(t[16]=(0,s.Lk)("th",{class:"table-header"},"完成时间",-1)),t[17]||(t[17]=(0,s.Lk)("th",{class:"table-header"},"结果",-1)),t[18]||(t[18]=(0,s.Lk)("th",{class:"table-header"},"操作",-1))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.tasks,(l=>((0,s.uX)(),(0,s.CE)("tr",{key:l.id,class:"border-t border-light-border hover:bg-light-bg-active transition-all duration-200"},[(0,s.Lk)("td",zl,[(0,s.Lk)("div",ql,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>o.selectedTasks=e),value:l.id,class:"checkbox-input"},null,8,Ol),[[a.lH,o.selectedTasks]])])]),(0,s.Lk)("td",Jl,(0,i.v_)(l.id),1),(0,s.Lk)("td",Gl,[(0,s.Lk)("div",Zl,[(0,s.Lk)("i",{class:(0,i.C4)([n.getTypeIcon(l.type),"mr-2 text-primary"])},null,2),(0,s.eW)(" "+(0,i.v_)(n.formatDescription(l.type)),1)])]),(0,s.Lk)("td",Yl,[(0,s.Lk)("div",{class:"tooltip truncate","data-tooltip":l.payload},(0,i.v_)(l.payload),9,ea)]),(0,s.Lk)("td",ta,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",n.getStatusStyle(l.status)])},[(0,s.Lk)("i",{class:(0,i.C4)([n.getStatusIcon(l.status),"mr-1"])},null,2),(0,s.eW)(" "+(0,i.v_)(n.formatStatus(l.status)),1)],2)]),(0,s.Lk)("td",la,(0,i.v_)(n.formatDate(l.created_at)),1),(0,s.Lk)("td",aa,(0,i.v_)(l.completed_at?n.formatDate(l.completed_at):"—"),1),(0,s.Lk)("td",sa,[l.result?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"tooltip","data-tooltip":l.result},(0,i.v_)(n.truncateText(l.result,20)),9,ia)):((0,s.uX)(),(0,s.CE)("span",ra,"—"))]),(0,s.Lk)("td",oa,[(0,s.Lk)("div",na,[(0,s.Lk)("button",{onClick:t=>e.$emit("toggle-task",l),disabled:"running"===l.status,class:(0,i.C4)(["task-button","running"===l.status?"bg-light-bg text-light-text-disabled cursor-not-allowed":"bg-primary/10 hover:bg-primary/20 text-primary"])},[(0,s.Lk)("i",{class:(0,i.C4)("running"===l.status?"ri-loader-2-line animate-spin":"ri-play-line")},null,2),(0,s.eW)(" "+(0,i.v_)("running"===l.status?"运行中":"启动"),1)],10,da),(0,s.Lk)("button",{onClick:t=>e.$emit("stop-task",l),disabled:"running"!==l.status,class:(0,i.C4)(["task-button","running"!==l.status?"bg-light-bg text-light-text-disabled cursor-not-allowed":"bg-yellow-50 hover:bg-yellow-100 text-yellow-600"])},t[19]||(t[19]=[(0,s.Lk)("i",{class:"ri-stop-line"},null,-1),(0,s.eW)(" 终止 ")]),10,ca),(0,s.Lk)("button",{onClick:e=>n.handleDelete(l.id),class:"task-button bg-red-50 hover:bg-red-100 text-red-600"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-delete-bin-line"},null,-1),(0,s.eW)(" 删除 ")]),8,ua)])])])))),128))])])])])):((0,s.uX)(),(0,s.CE)("div",ga,[t[22]||(t[22]=(0,s.Lk)("div",{class:"p-6 rounded-full bg-light-bg mb-6"},[(0,s.Lk)("i",{class:"ri-file-list-3-line empty-state-icon"})],-1)),t[23]||(t[23]=(0,s.Lk)("span",{class:"text-xl font-medium text-light-text-primary mb-3"},"暂无任务",-1)),t[24]||(t[24]=(0,s.Lk)("p",{class:"empty-state-text max-w-md px-4"}," 当前还没有创建任何扫描任务，可以在右方创建或前往综合扫描添加 ",-1)),(0,s.Lk)("div",xa,[(0,s.bF)(d,{to:"/under-development"},{default:(0,s.k6)((()=>t[21]||(t[21]=[(0,s.Lk)("button",{class:"empty-state-button"},[(0,s.Lk)("i",{class:"ri-focus-3-line mr-2"}),(0,s.eW)(" 综合扫描 ")],-1)]))),_:1})])]))])}var pa={name:"TaskList",props:{tasks:{type:Array,required:!0,default:()=>[]}},data(){return{selectedTasks:[]}},computed:{isAllSelected(){return!(!this.tasks||!Array.isArray(this.tasks))&&(this.tasks.length>0&&this.selectedTasks.length===this.tasks.length)}},methods:{formatStatus(e){const t={running:"运行中",completed:"已完成",pending:"等待中"};return t[e]||"未知状态"},getStatusStyle(e){const t={running:"status-running",completed:"status-completed",pending:"status-pending",failed:"status-failed"};return t[e]||"bg-light-bg text-light-text-secondary"},getStatusIcon(e){const t={running:"ri-loader-2-line animate-spin",completed:"ri-check-line",pending:"ri-time-line"};return t[e]||"ri-question-line"},getTypeIcon(e){const t={subfinder:"ri-global-line",nmap:"ri-scan-2-line",ffuf:"ri-folders-line",gogo:"ri-bug-line"};return t[e]||"ri-question-line"},formatDescription(e){const t={subfinder:"子域名扫描",nmap:"端口扫描",ffuf:"路径扫描",gogo:"漏洞扫描"};return t[e]||"未知任务"},formatDate(e){return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},truncateText(e,t){return e?e.length>t?e.substring(0,t)+"...":e:""},handleDelete(e){this.$emit("delete-task",e)},toggleSelectAll(){this.isAllSelected?this.selectedTasks=[]:this.selectedTasks=this.tasks.map((e=>e.id))},handleBatchStart(){this.$emit("batch-start",this.selectedTasks)},handleBatchStop(){this.$emit("batch-stop",this.selectedTasks)},handleBatchDelete(){this.$emit("batch-delete",this.selectedTasks),this.selectedTasks=[]}}};const ba=(0,g.A)(pa,[["render",ma],["__scopeId","data-v-3eecf566"]]);var ha=ba;const fa={class:"space-y-6"},ka={class:"form-group"},va={class:"relative"},ya=["value"],La={class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},wa={key:0,class:"form-hint"},Ca={class:"form-group"},Ra={class:"relative"},_a=["placeholder"],Ta=["disabled"],Sa={key:0,class:"ri-add-circle-line mr-2 group-hover:animate-pulse"},Ea={key:1,class:"ri-error-warning-line mr-2"},Wa={class:"mt-8 pt-6 border-t border-light-border"},Da={class:"grid grid-cols-3 gap-3"},Xa=["onClick"],Pa={class:"text-xs font-medium"};function Aa(e,t,l,r,o,n){return(0,s.uX)(),(0,s.CE)(s.FK,null,[t[8]||(t[8]=(0,s.Lk)("div",{class:"mb-6"},[(0,s.Lk)("h2",{class:"text-lg font-medium text-light-text-primary flex items-center"},[(0,s.Lk)("i",{class:"ri-add-line mr-2 text-primary"}),(0,s.eW)(" 创建任务 ")]),(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mt-1"},"填写以下信息以创建新的扫描任务")],-1)),(0,s.Lk)("div",fa,[(0,s.Lk)("div",ka,[t[4]||(t[4]=(0,s.Lk)("label",{class:"form-label flex items-center"},[(0,s.Lk)("i",{class:"ri-bar-chart-horizontal-line mr-1.5"}),(0,s.eW)(" 任务类型 ")],-1)),(0,s.Lk)("div",va,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.newTaskType=e),class:"form-select pl-10"},[t[3]||(t[3]=(0,s.Lk)("option",{value:"",disabled:""},"选择任务类型",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.taskTypes,((e,t)=>((0,s.uX)(),(0,s.CE)("option",{key:t,value:t},(0,i.v_)(e),9,ya)))),128))],512),[[a.u1,r.newTaskType]]),(0,s.Lk)("div",La,[(0,s.Lk)("i",{class:(0,i.C4)([r.getTaskTypeIcon(r.newTaskType),"text-light-text-secondary text-lg"])},null,2)])]),r.newTaskType?((0,s.uX)(),(0,s.CE)("div",wa,(0,i.v_)(r.getTaskTypeDescription(r.newTaskType)),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Ca,[t[6]||(t[6]=(0,s.Lk)("label",{class:"form-label flex items-center"},[(0,s.Lk)("i",{class:"ri-focus-3-line mr-1.5"}),(0,s.eW)(" 目标地址 ")],-1)),(0,s.Lk)("div",Ra,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.newTaskAddress=e),type:"text",placeholder:r.getAddressPlaceholder(r.newTaskType),class:"form-input pl-10"},null,8,_a),[[a.Jo,r.newTaskAddress]]),t[5]||(t[5]=(0,s.Lk)("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[(0,s.Lk)("i",{class:"ri-global-line text-light-text-secondary text-lg"})],-1))])]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.handleCreateTask&&r.handleCreateTask(...e)),disabled:!r.isValidInput,class:(0,i.C4)(["submit-button group w-full",r.isValidInput?"":"opacity-60 cursor-not-allowed"])},[r.isValidInput?((0,s.uX)(),(0,s.CE)("i",Sa)):((0,s.uX)(),(0,s.CE)("i",Ea)),(0,s.eW)(" "+(0,i.v_)(r.isValidInput?"创建任务":"请完善任务信息"),1)],10,Ta)]),(0,s.Lk)("div",Wa,[t[7]||(t[7]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mb-4"},"快速选择任务类型:",-1)),(0,s.Lk)("div",Da,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.taskTypes,((e,t)=>((0,s.uX)(),(0,s.CE)("button",{key:t,onClick:e=>r.selectTaskType(t),class:(0,i.C4)(["type-button flex flex-col items-center justify-center p-3 rounded-lg border transition-all duration-200",r.newTaskType===t?"bg-primary/10 border-primary/30 text-primary":"bg-white border-light-border text-light-text-secondary hover:bg-light-bg-active"])},[(0,s.Lk)("i",{class:(0,i.C4)([r.getTaskTypeIcon(t),"text-xl mb-2"])},null,2),(0,s.Lk)("span",Pa,(0,i.v_)(e),1)],10,Xa)))),128))])])],64)}var Ia={name:"TaskForm",setup(e,{emit:t}){const{showSuccess:l,showError:a}=Xe(),i=(0,o.KR)(""),r=(0,o.KR)(""),n={subfinder:"子域名扫描",nmap:"端口扫描",ffuf:"路径扫描",gogo:"漏洞扫描"},d=e=>{const t={subfinder:"ri-global-line",nmap:"ri-scan-2-line",ffuf:"ri-folders-line",gogo:"ri-bug-line","":"ri-question-line"};return t[e]||"ri-question-line"},c=e=>{const t={subfinder:"扫描目标域名的所有子域名，帮助发现攻击面",nmap:"扫描目标主机开放的端口和服务信息",ffuf:"对Web应用进行路径扫描，发现隐藏资源",gogo:"对目标进行漏洞扫描，发现安全漏洞"};return t[e]||""},u=e=>{const t={subfinder:"example.com",nmap:"192.168.1.1 或 example.com",ffuf:"https://example.com/",gogo:"10.8.1.1 or 10.8.1.0/24","":"输入目标地址"};return t[e]||"输入目标地址"},g=e=>{i.value=e},x=(0,s.EW)((()=>""!==i.value.trim()&&""!==r.value.trim())),m=()=>{if(x.value)try{t("create-task",{type:i.value,payload:r.value}),i.value="",r.value="",l("任务已创建")}catch(e){a("创建任务失败")}else a("请填写完整信息")};return{newTaskType:i,newTaskAddress:r,taskTypes:n,isValidInput:x,handleCreateTask:m,getTaskTypeIcon:d,getTaskTypeDescription:c,getAddressPlaceholder:u,selectTaskType:g}}};const Fa=(0,g.A)(Ia,[["render",Aa],["__scopeId","data-v-2624289a"]]);var Ka=Fa,ja={name:"TaskManagement",components:{PageContainer:dt,PopupNotification:m,ConfirmDialog:Yt,TaskList:ha,TaskForm:Ka},setup(){const e=(0,o.KR)([]),t=(0,o.KR)(!1),{showNotification:l,notificationMessage:a,notificationType:i,showSuccess:r,showError:n}=Xe(),{showDialog:d,dialogTitle:c,dialogMessage:u,dialogType:g,confirm:x,handleConfirm:m,handleCancel:p}=el(),b=async()=>{try{t.value=!0;const l=await se.get("/tasks");e.value=l.data}catch(l){n("获取任务列表失败")}finally{t.value=!1}},h=async t=>{try{const l=await se.post("/tasks",t);l.data&&l.data.id?(e.value.unshift(l.data),r("已创建新任务"),setTimeout((()=>R()),300)):(await b(),r("已创建新任务"))}catch(l){n(l.response?.data?.message||"创建任务失败")}},f=async t=>{try{const l=await se.post("/tasks/start",{taskIds:[t.id]}),a=l.data.result,s=e.value.findIndex((e=>e.id===t.id));if(-1!==s&&(e.value[s].status="running"),a.success.includes(t.id))r("已启动任务");else{const e=a.failed[t.id]||"启动失败";n(`启动任务失败: ${e}`),await b()}}catch(l){n("启动任务失败"),await b()}},k=async t=>{try{const l=await se.post("/tasks/stop",{taskIds:[t.id]}),a=l.data.result,s=e.value.findIndex((e=>e.id===t.id));if(-1!==s&&(e.value[s].status="pending"),a.success.includes(t.id))r("已终止任务");else{const e=a.failed[t.id]||"终止失败";n(`终止任务失败: ${e}`),await b()}}catch(l){n("终止任务失败"),await b()}},v=async t=>{try{const l=await x({title:"确认删除",message:`是否确认删除任务 ${t}？此操作不可撤销。`,type:"danger"});if(l){e.value=e.value.filter((e=>e.id!==t));const l=await se.delete("/tasks",{data:{taskIds:[t]}}),a=l.data.result;if(a.success.includes(t))r("已删除任务");else{const e=a.failed[t]||"删除失败";n(`删除任务失败: ${e}`),await b()}}}catch(l){n("删除任务失败"),await b()}},y=async t=>{if(0!==t.length)try{const l=await x({title:"确认批量启动",message:`是否确认启动选中的 ${t.length} 个任务？`,type:"warning"});if(l){e.value=e.value.map((e=>t.includes(e.id)?{...e,status:"running"}:e));const l=await se.post("/tasks/start",{taskIds:t}),a=l.data.result;a.success.length>0&&r(`成功启动 ${a.success.length} 个任务`),Object.keys(a.failed).length>0&&(n(`${Object.keys(a.failed).length} 个任务启动失败`),await b())}}catch(l){n("批量启动任务失败"),await b()}else n("请选择要启动的任务")},L=async t=>{if(0!==t.length)try{const l=await x({title:"确认批量终止",message:`是否确认终止选中的 ${t.length} 个任务？`,type:"warning"});if(l){e.value=e.value.map((e=>t.includes(e.id)?{...e,status:"pending"}:e));const l=await se.post("/tasks/stop",{taskIds:t}),a=l.data.result;a.success.length>0&&r(`成功终止 ${a.success.length} 个任务`),Object.keys(a.failed).length>0&&(n(`${Object.keys(a.failed).length} 个任务终止失败`),await b())}}catch(l){n("批量终止任务失败"),await b()}else n("请选择要终止的任务")},w=async t=>{if(0!==t.length)try{const l=await x({title:"确认批量删除",message:`是否确认删除选中的 ${t.length} 个任务？此操作不可撤销。`,type:"danger"});if(l){e.value=e.value.filter((e=>!t.includes(e.id)));const l=await se.delete("/tasks",{data:{taskIds:t}}),a=l.data.result;a.success.length>0&&r(`成功删除 ${a.success.length} 个任务`),Object.keys(a.failed).length>0&&(n(`${Object.keys(a.failed).length} 个任务删除失败`),await b())}}catch(l){n("批量删除任务失败"),await b()}else n("请选择要删除的任务")},C=async()=>{try{await b(),r("已刷新任务列表")}catch(e){n("刷新任务列表失败")}},R=()=>{window.scrollTo({top:0,behavior:"smooth"})},_=()=>{const e=document.querySelector(".sticky");e&&e.scrollIntoView({behavior:"smooth"})};return(0,s.sV)(b),{tasks:e,isLoading:t,showNotification:l,notificationMessage:a,notificationType:i,showDialog:d,dialogTitle:c,dialogMessage:u,dialogType:g,handleConfirm:m,handleCancel:p,confirmText:"确认",cancelText:"取消",createTask:h,toggleTask:f,stopTask:k,handleDelete:v,handleRefreshTasks:C,handleBatchStart:y,handleBatchStop:L,handleBatchDelete:w,scrollToTop:R,scrollToForm:_}}};const Va=(0,g.A)(ja,[["render",Il],["__scopeId","data-v-6e68786a"]]);var Ma=Va;const Qa={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},$a={class:"container mx-auto px-6 py-8 flex-1"},Na={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Ba={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},Ua={class:"flex items-center"},Ha={class:"flex gap-3"},za={class:"bg-light-bg p-4 rounded-xl mb-6 border border-light-border"},qa={class:"flex flex-col md:flex-row gap-4"},Oa={class:"flex-1 relative"},Ja={class:"flex gap-4"},Ga={class:"relative min-w-[140px]"},Za={key:0,class:"flex items-center gap-2 mt-3 text-sm text-light-text-secondary"},Ya={key:0,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},es={key:1,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},ts={key:0,class:"flex flex-col items-center justify-center py-12 text-center"},ls={class:"text-light-text-secondary max-w-md mb-6"},as={key:1,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},ss={class:"text-sm text-red-500"};function is(e,t,l,r,o,n){const d=(0,s.g2)("PortScanTable"),c=(0,s.g2)("PopupNotification"),u=(0,s.g2)("ConfirmDialog");return(0,s.uX)(),(0,s.CE)("div",Qa,[(0,s.Lk)("div",$a,[(0,s.Lk)("div",Na,[(0,s.Lk)("div",Ba,[(0,s.Lk)("div",Ua,[t[12]||(t[12]=(0,s.Lk)("div",{class:"w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-scan-2-line text-purple-500 text-xl"})],-1)),t[13]||(t[13]=(0,s.Lk)("div",null,[(0,s.Lk)("h2",{class:"text-xl font-medium tracking-wide text-light-text-primary"}," 端口扫描结果 "),(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mt-1"}," 查看和管理端口扫描任务的结果 ")],-1)),(0,s.Lk)("div",{class:(0,i.C4)(["ml-4 px-3 py-1 rounded-lg bg-light-bg text-light-text-secondary text-sm flex items-center",r.filteredResults.length>0?"bg-purple-500/10 text-purple-600":""])},[t[11]||(t[11]=(0,s.Lk)("i",{class:"ri-database-2-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.filteredResults.length)+" 个结果 ",1)],2)]),(0,s.Lk)("div",Ha,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.handleRefreshTasks&&r.handleRefreshTasks(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 flex items-center justify-center"},t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2"},null,-1),(0,s.eW)(" 刷新列表 ")])),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-purple-500/10 hover:bg-purple-500/20 text-purple-600 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500/30 flex items-center justify-center border border-purple-500/30"},t[15]||(t[15]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描 ")]))])]),(0,s.Lk)("div",za,[(0,s.Lk)("div",qa,[(0,s.Lk)("div",Oa,[t[16]||(t[16]=(0,s.Lk)("i",{class:"ri-search-line absolute left-4 top-3 text-light-text-secondary"},null,-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchQuery=e),type:"text",placeholder:"搜索目标地址...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-purple-500/50 focus:ring-2 focus:ring-purple-500/20 focus:outline-none transition-all duration-200"},null,512),[[a.Jo,r.searchQuery,void 0,{trim:!0}]])]),(0,s.Lk)("div",Ja,[(0,s.Lk)("div",Ga,[t[18]||(t[18]=(0,s.Lk)("i",{class:"ri-filter-line absolute left-4 top-3 text-light-text-secondary"},null,-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.statusFilter=e),class:"w-full pl-10 pr-8 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-purple-500/50 focus:ring-2 focus:ring-purple-500/20 focus:outline-none transition-all duration-200 appearance-none"},t[17]||(t[17]=[(0,s.Lk)("option",{value:""},"所有状态",-1),(0,s.Lk)("option",{value:"true"},"已读",-1),(0,s.Lk)("option",{value:"false"},"未读",-1)]),512),[[a.u1,r.statusFilter]]),t[19]||(t[19]=(0,s.Lk)("i",{class:"ri-arrow-down-s-line absolute right-4 top-3 text-light-text-secondary pointer-events-none"},null,-1))]),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.handleSearch&&r.handleSearch(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 flex items-center justify-center min-w-[100px]"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-search-line mr-2"},null,-1),(0,s.eW)(" 查询 ")]))])]),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("div",Za,[t[23]||(t[23]=(0,s.Lk)("i",{class:"ri-filter-3-line"},null,-1)),t[24]||(t[24]=(0,s.Lk)("span",null,"已过滤: ",-1)),r.searchQuery?((0,s.uX)(),(0,s.CE)("div",Ya,[(0,s.eW)(' 搜索 "'+(0,i.v_)(r.searchQuery)+'" ',1),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>r.searchQuery=""),class:"ml-1 text-light-text-secondary hover:text-light-text-primary"},t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),r.statusFilter?((0,s.uX)(),(0,s.CE)("div",es,[(0,s.eW)((0,i.v_)("true"===r.statusFilter?"已读":"未读")+" ",1),(0,s.Lk)("button",{onClick:t[6]||(t[6]=e=>r.statusFilter=""),class:"ml-1 text-light-text-secondary hover:text-light-text-primary"},t[22]||(t[22]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"ml-2 text-purple-500 hover:text-purple-600 text-xs underline"}," 清除全部 ")])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",{class:(0,i.C4)(["bg-white/90 rounded-xl overflow-hidden border border-light-border shadow-light-card",{"opacity-50":r.isLoading}])},[(0,s.bF)(d,{portScanResults:r.filteredResults,loading:r.isLoading,onViewDetails:r.handleViewDetails,onDeleteResult:r.handleDeleteResult,onDeleteSelected:r.handleDeleteSelected,onToggleReadStatus:r.handleToggleReadStatus,onMarkSelectedRead:r.handleMarkSelectedRead},null,8,["portScanResults","loading","onViewDetails","onDeleteResult","onDeleteSelected","onToggleReadStatus","onMarkSelectedRead"])],2),r.isLoading||0!==r.filteredResults.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",ts,[t[27]||(t[27]=(0,s.Lk)("div",{class:"w-16 h-16 rounded-full bg-light-bg flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-scan-2-line text-light-text-disabled text-3xl"})],-1)),t[28]||(t[28]=(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary mb-2"},"无扫描结果",-1)),(0,s.Lk)("p",ls,(0,i.v_)(r.hasActiveFilters?"没有符合当前过滤条件的端口扫描结果，请尝试修改过滤条件或清除筛选":"当前还没有任何端口扫描结果。创建一个新的扫描任务来检测开放端口。"),1),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[8]||(t[8]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 flex items-center"},t[25]||(t[25]=[(0,s.Lk)("i",{class:"ri-filter-off-line mr-2"},null,-1),(0,s.eW)(" 清除筛选条件 ")]))):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t[9]||(t[9]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-purple-500/10 hover:bg-purple-500/20 text-purple-600 transition-all duration-200 flex items-center border border-purple-500/30"},t[26]||(t[26]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描任务 ")])))])),r.errorMessage?((0,s.uX)(),(0,s.CE)("div",as,[t[29]||(t[29]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2"},null,-1)),(0,s.Lk)("p",ss,(0,i.v_)(r.errorMessage),1)])):(0,s.Q3)("",!0)])]),r.showNotification?((0,s.uX)(),(0,s.Wv)(c,{key:0,message:r.notificationMessage,type:r.notificationType,onClose:t[10]||(t[10]=e=>r.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(u,{show:r.showDialog,title:r.dialogTitle,message:r.dialogMessage,type:r.dialogType,onConfirm:r.handleConfirm,onCancel:r.handleCancel},null,8,["show","title","message","type","onConfirm","onCancel"])])}const rs={class:"space-y-6"},os={key:0},ns={class:"relative overflow-x-auto rounded-xl border border-light-border bg-white/90 shadow-sm"},ds={class:"w-full"},cs={class:"bg-light-bg border-b border-light-border"},us={class:"py-3 px-4 text-left w-10"},gs=["checked"],xs={class:"py-3 px-4"},ms=["value","id"],ps=["for"],bs={class:"py-3 px-4 text-sm font-mono text-light-text-primary"},hs={class:"py-3 px-4 text-sm text-light-text-primary"},fs={class:"flex items-center"},ks={class:"py-3 px-4 text-sm text-light-text-primary"},vs={class:"flex items-center"},ys={class:"py-3 px-4 text-sm text-light-text-primary"},Ls={class:"px-2 py-1 rounded-md bg-purple-500/10 text-purple-600 border border-purple-500/20 inline-flex items-center"},ws={class:"py-3 px-4"},Cs={class:"py-3 px-4"},Rs={class:"flex gap-2 flex-wrap"},_s=["onClick"],Ts=["onClick"],Ss=["onClick"],Es={class:"flex items-center justify-between flex-wrap gap-4 p-4 rounded-xl border border-light-border bg-light-bg shadow-sm mt-6"},Ws={class:"flex items-center gap-3"},Ds={class:"text-sm text-light-text-secondary"},Xs={class:"text-light-text-primary font-medium"},Ps={class:"flex flex-wrap gap-3"},As=["disabled"],Is={key:0},Fs=["disabled"],Ks={key:0};function js(e,t,l,r,o,n){return(0,s.uX)(),(0,s.CE)("div",rs,[l.portScanResults?.length>0?((0,s.uX)(),(0,s.CE)("div",os,[(0,s.Lk)("div",ns,[(0,s.Lk)("table",ds,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",cs,[(0,s.Lk)("th",us,[(0,s.Lk)("input",{type:"checkbox",onChange:t[0]||(t[0]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e)),checked:r.isAllSelected,class:"checkbox-input",id:"select-all-header",title:"全选/取消全选"},null,40,gs),t[4]||(t[4]=(0,s.Lk)("label",{for:"select-all-header",class:"sr-only"},"全选/取消全选",-1))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.tableHeaders,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e,class:"py-3 px-4 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider"},(0,i.v_)(e),1)))),128))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.portScanResults,((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,i.C4)(["border-b border-light-border transition-all duration-200 hover:bg-light-bg/70",l%2===0?"bg-light-bg/50":""])},[(0,s.Lk)("td",xs,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedResults=e),value:e.id,class:"checkbox-input",id:`select-result-${e.id}`},null,8,ms),[[a.lH,r.selectedResults]]),(0,s.Lk)("label",{for:`select-result-${e.id}`,class:"sr-only"},"选择此结果",8,ps)]),(0,s.Lk)("td",bs,(0,i.v_)(e.id),1),(0,s.Lk)("td",hs,[(0,s.Lk)("span",fs,[t[5]||(t[5]=(0,s.Lk)("i",{class:"ri-global-line mr-2 text-blue-500"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.target),1)])]),(0,s.Lk)("td",ks,[(0,s.Lk)("span",vs,[t[6]||(t[6]=(0,s.Lk)("i",{class:"ri-time-line mr-2 text-light-text-secondary"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.formatDate(e.timestamp)),1)])]),(0,s.Lk)("td",ys,[(0,s.Lk)("span",Ls,[t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-scan-2-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.getPortCount(e))+" 个 ",1)])]),(0,s.Lk)("td",ws,[(0,s.Lk)("span",{class:(0,i.C4)(["px-2 py-1 rounded-md text-xs font-medium inline-flex items-center",e.is_read?"bg-green-500/10 text-green-600 border border-green-500/30":"bg-yellow-500/10 text-yellow-600 border border-yellow-500/30"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-line":"ri-eye-off-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"已读":"未读"),1)],2)]),(0,s.Lk)("td",Cs,[(0,s.Lk)("div",Rs,[(0,s.Lk)("button",{onClick:t=>r.handleViewDetails(e.id),class:"action-button bg-blue-500/10 text-blue-600 border border-blue-500/30 hover:bg-blue-500/20"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"ri-eye-line mr-1.5"},null,-1),(0,s.eW)(" 查看 ")]),8,_s),(0,s.Lk)("button",{onClick:t=>r.handleToggleRead(e),class:(0,i.C4)(["action-button",e.is_read?"bg-light-bg text-light-text-primary border border-light-border":"bg-green-500/10 text-green-600 border border-green-500/30 hover:bg-green-500/20"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-off-line":"ri-eye-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"标为未读":"标为已读"),1)],10,Ts),(0,s.Lk)("button",{onClick:t=>r.handleDelete(e.id),class:"action-button bg-red-500/10 text-red-600 border border-red-500/30 hover:bg-red-500/20"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-1.5"},null,-1),(0,s.eW)(" 删除 ")]),8,Ss)])])],2)))),128))])])]),(0,s.Lk)("div",Es,[(0,s.Lk)("div",Ws,[(0,s.Lk)("span",Ds,[r.hasSelected?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[t[10]||(t[10]=(0,s.eW)(" 已选择 ")),(0,s.Lk)("span",Xs,(0,i.v_)(r.selectedResults.length),1),t[11]||(t[11]=(0,s.eW)(" 项 "))],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)(" 请选择要操作的项目 ")],64))])]),(0,s.Lk)("div",Ps,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.handleBatchRead&&r.handleBatchRead(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20":"bg-light-bg text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[12]||(t[12]=(0,s.Lk)("i",{class:"ri-eye-line mr-2"},null,-1)),t[13]||(t[13]=(0,s.eW)(" 标记已读 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",Is,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,As),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.handleBatchDelete&&r.handleBatchDelete(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-red-500/10 text-red-600 border-red-500/30 hover:bg-red-500/20":"bg-light-bg text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[14]||(t[14]=(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1)),t[15]||(t[15]=(0,s.eW)(" 批量删除 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",Ks,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,Fs)])])])):(0,s.Q3)("",!0)])}var Vs={name:"PortScanTable",props:{portScanResults:{type:Array,required:!0,default:()=>[]}},emits:["view-details","delete-result","delete-selected","toggle-read-status","mark-selected-read"],setup(e,{emit:t}){const l=["ID","目标地址","扫描时间","端口数量","状态","操作"],a=(0,o.KR)([]),i=(0,s.EW)((()=>a.value.length>0)),r=(0,s.EW)((()=>!!e.portScanResults?.length&&a.value.length===e.portScanResults.length)),n=e=>{if(!e)return"-";try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return e||"未知时间"}},d=e=>{if(!e||!e.data||!Array.isArray(e.data))return 0;const t=e.data.find((e=>"ports"===e.Key));return t?.Value?.length||0},c=()=>{r.value?a.value=[]:a.value=e.portScanResults.map((e=>e.id))},u=e=>t("view-details",e),g=e=>t("delete-result",e),x=e=>t("toggle-read-status",e.id,!e.is_read),m=()=>{0!==a.value.length&&(t("delete-selected",a.value),a.value=[])},p=()=>{0!==a.value.length&&(t("mark-selected-read",a.value),a.value=[])};return(0,s.wB)((()=>e.portScanResults),(()=>{a.value=[]})),{selectedResults:a,tableHeaders:l,hasSelected:i,isAllSelected:r,formatDate:n,getPortCount:d,toggleSelectAll:c,handleViewDetails:u,handleDelete:g,handleToggleRead:x,handleBatchDelete:m,handleBatchRead:p}}};const Ms=(0,g.A)(Vs,[["render",js],["__scopeId","data-v-8df9f846"]]);var Qs=Ms,$s={name:"PortScanResults",components:{PortScanTable:Qs,PopupNotification:m,ConfirmDialog:Yt},setup(){const e=(0,n.rd)(),t=(0,o.KR)([]),l=(0,o.KR)(""),a=(0,o.KR)(""),i=(0,o.KR)(""),r=(0,o.KR)(!1),{showNotification:d,notificationMessage:c,notificationType:u,showSuccess:g,showError:x}=Xe(),{showDialog:m,dialogTitle:p,dialogMessage:b,dialogType:h,confirm:f,handleConfirm:k,handleCancel:v}=el(),y=(0,s.EW)((()=>""!==a.value.trim()||""!==i.value)),L=(0,s.EW)((()=>{if(!t.value)return[];let e=[...t.value];if(a.value){const t=a.value.toLowerCase();e=e.filter((e=>e.target.toLowerCase().includes(t)))}return""!==i.value&&(e=e.filter((e=>String(e.is_read)===i.value))),e.sort(((e,t)=>new Date(t.Timestamp)-new Date(e.Timestamp))),e})),w=async()=>{try{r.value=!0,l.value="";const e=await se.get("/results/type/Port");t.value=e.data,g("已刷新扫描结果")}catch(e){l.value="获取扫描结果失败，请重试或联系管理员",x("获取扫描结果失败")}finally{r.value=!1}},C=()=>{r.value=!0,setTimeout((()=>{r.value=!1}),300)},R=()=>{a.value="",i.value="",C()},_=t=>{e.push({name:"PortScanDetail",params:{id:t}})},T=async e=>{try{const t=await f({title:"确认删除",message:"是否确认删除此扫描结果？此操作不可撤销。",type:"danger"});if(!t)return;r.value=!0,await se.delete(`/results/${e}`),await w(),g("已删除扫描结果")}catch(t){x("删除扫描结果失败"),r.value=!1}},S=async(e,l)=>{try{r.value=!0,await se.put(`/results/${e}/read`,{is_read:l});const a=t.value.findIndex((t=>t.id===e));-1!==a&&(t.value[a].is_read=l),g("已更新状态"),r.value=!1}catch(a){x("更新状态失败"),await w()}},E=async e=>{if(0!==e.length)try{const t=await f({title:"批量标记",message:`是否将选中的 ${e.length} 项标记为已读？`,type:"info"});if(!t)return;r.value=!0,await Promise.all(e.map((e=>se.put(`/results/${e}/read`,{is_read:!0})))),await w(),g(`已将 ${e.length} 个结果标记为已读`)}catch(t){x("批量标记失败")}finally{r.value=!1}else x("请选择要标记的结果")},W=async e=>{if(0!==e.length)try{const t=await f({title:"批量删除",message:`是否确认删除选中的 ${e.length} 个结果？此操作不可撤销。`,type:"danger"});if(!t)return;r.value=!0,await Promise.all(e.map((e=>se.delete(`/results/${e}`)))),await w(),g(`已删除 ${e.length} 个结果`)}catch(t){x("批量删除失败"),r.value=!1}else x("请选择要删除的结果")};return(0,s.sV)(w),{router:e,portScanResults:t,errorMessage:l,showNotification:d,notificationMessage:c,notificationType:u,showDialog:m,dialogTitle:p,dialogMessage:b,dialogType:h,searchQuery:a,statusFilter:i,filteredResults:L,isLoading:r,hasActiveFilters:y,handleConfirm:k,handleCancel:v,handleRefreshTasks:w,handleViewDetails:_,handleDeleteResult:T,handleDeleteSelected:W,handleToggleReadStatus:S,handleMarkSelectedRead:E,handleSearch:C,clearFilters:R}}};const Ns=(0,g.A)($s,[["render",is],["__scopeId","data-v-5de89f2c"]]);var Bs=Ns;const Us={"2xx":"bg-green-500/20 text-green-300","3xx":"bg-blue-500/20 text-blue-300","4xx":"bg-yellow-500/20 text-yellow-300","5xx":"bg-red-500/20 text-red-300",default:"bg-gray-500/20 text-gray-300"},Hs=e=>e>=200&&e<300?Us["2xx"]:e>=300&&e<400?Us["3xx"]:e>=400&&e<500?Us["4xx"]:e>=500?Us["5xx"]:Us["default"];function zs(){const e=(0,n.lq)(),{showNotification:t,notificationMessage:l,notificationType:a,showSuccess:i,showError:r,showWarning:d}=Xe(),{confirm:c,showDialog:u,dialogTitle:g,dialogMessage:x,dialogType:m,handleConfirm:p,handleCancel:b}=el(),h=(0,o.KR)(null),f=(0,o.KR)(""),k=(0,o.KR)([]),v=(0,o.KR)(!1),y=(0,o.KR)(!1),L=(0,o.KR)(1),w=(0,o.KR)(10),C=[10,20,50,100];(0,s.wB)(k,(e=>{v.value=e.length===T.value.length&&e.length>0}));const R=async e=>{try{const t=await se.get(`/results/${e}`);h.value=t.data,f.value=""}catch(t){f.value="获取扫描结果详情失败",r("获取扫描结果详情失败")}},_=(e,t)=>{if(!e)return"";if(Array.isArray(e)){const l=e.find((e=>e.Key===t));return l?l.Value:""}return"object"===typeof e&&e[t]||""},T=(0,s.EW)((()=>{if(!h.value?.data)return[];const e=h.value.data.find((e=>"ports"===e.Key));return e?.Value||[]})),S=(0,s.EW)((()=>Math.ceil(T.value.length/w.value)||1)),E=(0,s.EW)((()=>{const e=(L.value-1)*w.value,t=e+w.value;return T.value.slice(e,t)})),W=e=>{e<1&&(e=1),e>S.value&&(e=S.value),L.value=e},D=()=>{L.value<S.value&&L.value++},X=()=>{L.value>1&&L.value--},P=e=>{w.value=e,L.value=1},A=()=>{k.value=v.value?T.value.map((e=>_(e,"_id"))):[]},I=async t=>{const l=_(t,"_id"),a=_(t,"is_read");try{await se.put(`/results/${e.params.id}/entries/${l}/read`,{is_read:!a}),await R(e.params.id),i("已"+(a?"标记为未读":"标记为已读"))}catch(s){r("更新状态失败")}},F=async e=>{const t=Array.isArray(e)?e.map((e=>T.value.find((t=>_(t,"_id")===e)))).filter((e=>e)):[e];if(!t.length)return void d("请先选择要扫描的端口");if(!h.value?.target_id)return void d("无法获取目标ID");const l=await c({title:t.length>1?"批量发送到路径扫描":"发送到路径扫描",message:t.length>1?`是否将选中的 ${t.length} 个端口发送到路径扫描？`:`是否将端口 ${_(t[0],"number")} 发送到路径扫描？`,type:"info"});if(l)try{for(const e of t){const t=_(e,"number"),l=_(e,"host"),a="https"===_(e,"service")?"https":"http";await se.post("/tasks",{type:"ffuf",payload:`${a}://${l}:${t}`,target_id:h.value.target_id})}i(t.length>1?`已发送 ${t.length} 个端口到路径扫描`:"已发送到路径扫描")}catch(a){r(t.length>1?"批量发送失败":"发送失败")}},K=async t=>{const l=Array.isArray(t)?t.map((e=>T.value.find((t=>_(t,"_id")===e)))):[t],a=l.map((e=>_(e,"_id")));if(!a.length)return void d("请先选择端口");const s=await c({title:a.length>1?"批量HTTP探测":"HTTP探测",message:a.length>1?`是否对选中的 ${a.length} 个端口进行HTTP探测？`:`是否对端口 ${_(l[0],"number")} 进行HTTP探测？`,type:"info"});if(s)try{y.value=!0,await se.put(`/results/${e.params.id}/entries/probe`,{entryIds:a}),await R(e.params.id),i(a.length>1?"批量探测成功":"HTTP探测成功")}catch(o){r(a.length>1?"批量探测失败":"HTTP探测失败")}finally{y.value=!1}},j=async e=>{try{await navigator.clipboard.writeText(e),i("已复制到剪贴板")}catch(t){r("复制失败")}};return{scanResult:h,errorMessage:f,selectedPorts:k,selectAll:v,filteredPorts:T,isProbing:y,currentPage:L,pageSize:w,pageSizeOptions:C,getPortValue:_,toggleReadStatus:I,toggleSelectAll:A,sendToPathScan:F,fetchScanResult:R,probePort:K,getHttpStatusClass:Hs,copyToClipboard:j,showNotification:t,notificationMessage:l,notificationType:a,showDialog:u,dialogTitle:g,dialogMessage:x,dialogType:m,handleConfirm:p,handleCancel:b,totalPages:S,paginatedPorts:E,goToPage:W,nextPage:D,prevPage:X,changePageSize:P}}const qs={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},Os={class:"container mx-auto px-6 py-8 flex-1 mt-16"},Js={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Gs={class:"flex items-center text-sm text-light-text-secondary mb-6"},Zs={class:"bg-light-bg rounded-xl border border-light-border mb-6 overflow-hidden"},Ys={class:"p-5 border-b border-light-border flex items-center space-x-3"},ei={class:"text-xl font-medium tracking-wide text-light-text-primary"},ti={class:"grid grid-cols-1 md:grid-cols-3 gap-6 p-5"},li={class:"flex flex-col"},ai={class:"flex items-center"},si={class:"text-sm font-mono text-light-text-primary"},ii={class:"flex flex-col"},ri={class:"flex items-center"},oi={class:"text-sm text-light-text-primary"},ni={class:"flex flex-col"},di={class:"flex items-center"},ci={class:"text-sm text-light-text-primary"},ui={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},gi={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},xi={class:"text-2xl font-medium text-light-text-primary"},mi={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},pi={class:"text-2xl font-medium text-green-600"},bi={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},hi={class:"text-2xl font-medium text-purple-600"},fi={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},ki={class:"text-2xl font-medium text-blue-500"},vi={class:"bg-light-bg rounded-xl border border-light-border p-4 mb-6"},yi={class:"flex flex-wrap items-center gap-3"},Li={class:"flex items-center mr-2"},wi={key:0,class:"text-sm text-light-text-secondary"},Ci={class:"flex flex-wrap gap-3 ml-auto"},Ri=["disabled"],_i=["disabled"],Ti={class:"bg-white/90 rounded-xl border border-light-border overflow-hidden mb-4 shadow-sm"},Si={class:"relative overflow-x-auto custom-scrollbar"},Ei={class:"w-full"},Wi={class:"bg-light-bg border-b border-light-border"},Di={class:"py-3 px-4 w-10"},Xi=["value"],Pi={class:"py-3 px-4 text-xs font-mono text-light-text-primary w-20"},Ai={class:"py-3 px-4 text-sm text-light-text-primary w-16"},Ii={class:"flex items-center"},Fi={class:"py-3 px-4 text-sm text-light-text-primary w-20"},Ki={class:"py-3 px-4 text-sm text-light-text-primary w-24"},ji={class:"py-3 px-4 w-20"},Vi={class:"py-3 px-4 text-sm w-24"},Mi={key:0,class:"flex items-center"},Qi=["onClick"],$i={class:"py-3 px-4 text-sm text-light-text-primary w-48"},Ni=["title"],Bi={class:"py-3 px-4 w-20"},Ui={class:"py-3 px-4 w-48"},Hi={class:"flex gap-2"},zi=["onClick"],qi=["onClick"],Oi={key:0,class:"mt-4 flex flex-col gap-4"},Ji={class:"flex justify-between items-center"},Gi={class:"flex items-center space-x-2"},Zi=["value"],Yi={class:"text-sm text-light-text-secondary"},er={class:"flex justify-center items-center space-x-2"},tr=["disabled"],lr=["disabled"],ar={class:"page-button bg-blue-500/30 text-blue-500 border-blue-500/50"},sr=["disabled"],ir=["disabled"],rr={key:1,class:"flex flex-col items-center justify-center py-12 text-center"},or={key:2,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},nr={class:"text-sm text-red-500"};var dr={__name:"PortScanDetail",setup(e){const t=(0,n.lq)(),l=(0,o.KR)(!1),r=["ID","端口","协议","服务","状态","HTTP状态","HTTP标题","读取状态","操作"],{scanResult:d,errorMessage:c,selectedPorts:u,selectAll:g,filteredPorts:x,currentPage:p,pageSize:b,pageSizeOptions:h,totalPages:f,paginatedPorts:k,goToPage:v,nextPage:y,prevPage:L,changePageSize:w,getPortValue:R,toggleReadStatus:_,toggleSelectAll:T,sendToPathScan:S,fetchScanResult:E,probePort:W,getHttpStatusClass:D,copyToClipboard:X,showNotification:P,notificationMessage:A,notificationType:I,showDialog:F,dialogTitle:K,dialogMessage:j,dialogType:V,handleConfirm:M,handleCancel:Q}=zs(),$=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return e||"未知时间"}};return(0,s.sV)((()=>{E(t.params.id)})),(e,t)=>{const n=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",qs,[(0,s.bF)(C),(0,s.Lk)("div",Os,[(0,s.Lk)("div",Js,[(0,s.Lk)("div",Gs,[(0,s.bF)(n,{to:"/port-scan-results",class:"hover:text-blue-500 transition-colors flex items-center"},{default:(0,s.k6)((()=>t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-arrow-left-line mr-1"},null,-1),(0,s.eW)(" 返回列表 ")]))),_:1}),t[15]||(t[15]=(0,s.Lk)("i",{class:"ri-arrow-right-s-line mx-2"},null,-1)),t[16]||(t[16]=(0,s.Lk)("span",{class:"text-light-text-primary"},"端口扫描详情",-1))]),(0,s.Lk)("div",Zs,[(0,s.Lk)("div",Ys,[t[18]||(t[18]=(0,s.Lk)("div",{class:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center"},[(0,s.Lk)("i",{class:"ri-scan-2-line text-blue-500 text-xl"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h2",ei,(0,i.v_)((0,o.R1)(d)?.target||"加载中..."),1),t[17]||(t[17]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mt-1"},"端口扫描结果详情",-1))])]),(0,s.Lk)("div",ti,[(0,s.Lk)("div",li,[t[20]||(t[20]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-fingerprint-line mr-1.5"}),(0,s.eW)(" 扫描ID ")],-1)),(0,s.Lk)("div",ai,[(0,s.Lk)("span",si,(0,i.v_)((0,o.R1)(d)?.id||"-"),1),(0,o.R1)(d)?.id?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>(0,o.R1)(X)((0,o.R1)(d).id)),class:"ml-2 text-light-text-tertiary hover:text-light-text-secondary transition-colors",title:"复制ID"},t[19]||(t[19]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",ii,[t[22]||(t[22]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-global-line mr-1.5"}),(0,s.eW)(" 目标地址 ")],-1)),(0,s.Lk)("div",ri,[(0,s.Lk)("span",oi,(0,i.v_)((0,o.R1)(d)?.target||"-"),1),(0,o.R1)(d)?.target?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[1]||(t[1]=e=>(0,o.R1)(X)((0,o.R1)(d).target)),class:"ml-2 text-light-text-tertiary hover:text-light-text-secondary transition-colors",title:"复制目标"},t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",ni,[t[23]||(t[23]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-time-line mr-1.5"}),(0,s.eW)(" 扫描时间 ")],-1)),(0,s.Lk)("div",di,[(0,s.Lk)("span",ci,(0,i.v_)((0,o.R1)(d)?$((0,o.R1)(d).timestamp):"-"),1)])])])]),(0,s.Lk)("div",ui,[(0,s.Lk)("div",gi,[t[24]||(t[24]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"总端口数",-1)),(0,s.Lk)("span",xi,(0,i.v_)((0,o.R1)(x).length),1)]),(0,s.Lk)("div",mi,[t[25]||(t[25]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"开放端口",-1)),(0,s.Lk)("span",pi,(0,i.v_)((0,o.R1)(x).filter((e=>"open"===(0,o.R1)(R)(e,"state"))).length),1)]),(0,s.Lk)("div",bi,[t[26]||(t[26]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"已探测HTTP",-1)),(0,s.Lk)("span",hi,(0,i.v_)((0,o.R1)(x).filter((e=>(0,o.R1)(R)(e,"http_status"))).length),1)]),(0,s.Lk)("div",fi,[t[27]||(t[27]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"已读状态",-1)),(0,s.Lk)("span",ki,(0,i.v_)((0,o.R1)(x).filter((e=>(0,o.R1)(R)(e,"is_read"))).length),1)])]),(0,s.Lk)("div",vi,[(0,s.Lk)("div",yi,[(0,s.Lk)("div",Li,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",onChange:t[2]||(t[2]=(...e)=>(0,o.R1)(T)&&(0,o.R1)(T)(...e)),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.i9)(g)?g.value=e:null),class:"rounded border-light-border bg-white text-blue-500 focus:ring-blue-500/30 mr-2",id:"select-all"},null,544),[[a.lH,(0,o.R1)(g)]]),t[28]||(t[28]=(0,s.Lk)("label",{for:"select-all",class:"text-sm text-light-text-primary cursor-pointer"}," 全选 ",-1))]),(0,o.R1)(u).length>0?((0,s.uX)(),(0,s.CE)("span",wi," 已选择 "+(0,i.v_)((0,o.R1)(u).length)+" 项 ",1)):(0,s.Q3)("",!0),(0,s.Lk)("div",Ci,[(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>(0,o.R1)(W)((0,o.R1)(u))),disabled:0===(0,o.R1)(u).length||l.value,class:(0,i.C4)(["tool-button bg-purple-500/10 border-purple-500/30 text-purple-600 hover:bg-purple-500/20",{"opacity-60 cursor-not-allowed":0===(0,o.R1)(u).length||l.value}])},[t[29]||(t[29]=(0,s.Lk)("i",{class:"ri-search-eye-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(l.value?"正在探测...":"HTTPX探测"),1)],10,Ri),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>(0,o.R1)(S)((0,o.R1)(u))),disabled:0===(0,o.R1)(u).length,class:(0,i.C4)(["tool-button bg-blue-500/10 border-blue-500/30 text-blue-500 hover:bg-blue-500/20",{"opacity-60 cursor-not-allowed":0===(0,o.R1)(u).length}])},t[30]||(t[30]=[(0,s.Lk)("i",{class:"ri-folders-line mr-1.5"},null,-1),(0,s.eW)(" 发送到路径扫描 ")]),10,_i)])])]),(0,s.Lk)("div",Ti,[(0,s.Lk)("div",Si,[(0,s.Lk)("table",Ei,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",Wi,[t[31]||(t[31]=(0,s.Lk)("th",{class:"py-3 px-4 text-left"},[(0,s.Lk)("span",{class:"sr-only"},"选择")],-1)),((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(r,(e=>(0,s.Lk)("th",{key:e,class:"py-3 px-4 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider"},(0,i.v_)(e),1))),64))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(k),((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:(0,o.R1)(R)(e,"_id"),class:(0,i.C4)(["border-t border-light-border transition-colors duration-200",[l%2===0?"bg-light-bg/50":"bg-transparent","hover:bg-light-bg/70"]])},[(0,s.Lk)("td",Di,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>(0,o.i9)(u)?u.value=e:null),value:(0,o.R1)(R)(e,"_id"),class:"rounded border-light-border bg-white text-blue-500 focus:ring-blue-500/30"},null,8,Xi),[[a.lH,(0,o.R1)(u)]])]),(0,s.Lk)("td",Pi,(0,i.v_)((0,o.R1)(R)(e,"_id")),1),(0,s.Lk)("td",Ai,[(0,s.Lk)("span",Ii,[t[32]||(t[32]=(0,s.Lk)("i",{class:"ri-door-lock-line mr-2 text-blue-500"},null,-1)),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(R)(e,"number")),1)])]),(0,s.Lk)("td",Fi,(0,i.v_)((0,o.R1)(R)(e,"protocol")),1),(0,s.Lk)("td",Ki,(0,i.v_)((0,o.R1)(R)(e,"service")),1),(0,s.Lk)("td",ji,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",{"bg-green-500/10 text-green-600 border-green-500/30":"open"===(0,o.R1)(R)(e,"state"),"bg-red-500/10 text-red-600 border-red-500/30":"closed"===(0,o.R1)(R)(e,"state"),"bg-yellow-500/10 text-yellow-600 border-yellow-500/30":"filtered"===(0,o.R1)(R)(e,"state")}])},[t[33]||(t[33]=(0,s.Lk)("i",{class:"ri-checkbox-blank-circle-fill mr-1 text-xs"},null,-1)),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(R)(e,"state")),1)],2)]),(0,s.Lk)("td",Vi,[(0,o.R1)(R)(e,"http_status")?((0,s.uX)(),(0,s.CE)("div",Mi,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",(0,o.R1)(D)((0,o.R1)(R)(e,"http_status"))])},[t[34]||(t[34]=(0,s.Lk)("i",{class:"ri-earth-line mr-1"},null,-1)),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(R)(e,"http_status")),1)],2)])):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t=>(0,o.R1)(W)([(0,o.R1)(R)(e,"_id")]),class:"status-button bg-purple-500/10 text-purple-600 border-purple-500/30"},t[35]||(t[35]=[(0,s.Lk)("i",{class:"ri-search-eye-line mr-1"},null,-1),(0,s.eW)(" 探测 ")]),8,Qi))]),(0,s.Lk)("td",$i,[(0,s.Lk)("div",{class:"truncate",title:(0,o.R1)(R)(e,"http_title")},(0,i.v_)((0,o.R1)(R)(e,"http_title")||"-"),9,Ni)]),(0,s.Lk)("td",Bi,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",(0,o.R1)(R)(e,"is_read")?"bg-green-500/10 text-green-600 border-green-500/30":"bg-yellow-500/10 text-yellow-600 border-yellow-500/30"])},[(0,s.Lk)("i",{class:(0,i.C4)([(0,o.R1)(R)(e,"is_read")?"ri-eye-line":"ri-eye-off-line","mr-1"])},null,2),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(R)(e,"is_read")?"已读":"未读"),1)],2)]),(0,s.Lk)("td",Ui,[(0,s.Lk)("div",Hi,[(0,s.Lk)("button",{onClick:t=>(0,o.R1)(_)(e),class:(0,i.C4)(["action-button",(0,o.R1)(R)(e,"is_read")?"bg-light-bg text-light-text-primary border-light-border":"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20"])},[(0,s.Lk)("i",{class:(0,i.C4)([(0,o.R1)(R)(e,"is_read")?"ri-eye-off-line":"ri-eye-line"])},null,2),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(R)(e,"is_read")?"标为未读":"标为已读"),1)],10,zi),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(S)([(0,o.R1)(R)(e,"_id")]),class:"action-button bg-blue-500/10 text-blue-500 border-blue-500/30 hover:bg-blue-500/20"},t[36]||(t[36]=[(0,s.Lk)("i",{class:"ri-folders-line"},null,-1),(0,s.eW)(" 路径扫描 ")]),8,qi)])])],2)))),128))])])])]),(0,o.R1)(x).length>0?((0,s.uX)(),(0,s.CE)("div",Oi,[(0,s.Lk)("div",Ji,[(0,s.Lk)("div",Gi,[t[37]||(t[37]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary"},"每页显示:",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>(0,o.i9)(b)?b.value=e:null),onChange:t[8]||(t[8]=e=>(0,o.R1)(w)((0,o.R1)(b))),class:"bg-white border border-light-border text-light-text-primary text-sm rounded-lg focus:ring-blue-500/30 focus:border-blue-500/50 px-2.5 py-1"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(h),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Zi)))),128))],544),[[a.u1,(0,o.R1)(b)]])]),(0,s.Lk)("div",Yi," 显示 "+(0,i.v_)(0===(0,o.R1)(x).length?0:((0,o.R1)(p)-1)*(0,o.R1)(b)+1)+" - "+(0,i.v_)(Math.min((0,o.R1)(p)*(0,o.R1)(b),(0,o.R1)(x).length))+" 共 "+(0,i.v_)((0,o.R1)(x).length)+" 条 ",1)]),(0,s.Lk)("div",er,[(0,s.Lk)("button",{onClick:t[9]||(t[9]=e=>(0,o.R1)(v)(1)),disabled:1===(0,o.R1)(p),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":1===(0,o.R1)(p)}])},t[38]||(t[38]=[(0,s.Lk)("i",{class:"ri-arrow-left-double-line"},null,-1)]),10,tr),(0,s.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>(0,o.R1)(L)&&(0,o.R1)(L)(...e)),disabled:1===(0,o.R1)(p),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":1===(0,o.R1)(p)}])},t[39]||(t[39]=[(0,s.Lk)("i",{class:"ri-arrow-left-s-line"},null,-1)]),10,lr),(0,s.Lk)("span",ar,(0,i.v_)((0,o.R1)(p)),1),(0,s.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>(0,o.R1)(y)&&(0,o.R1)(y)(...e)),disabled:(0,o.R1)(p)===(0,o.R1)(f),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":(0,o.R1)(p)===(0,o.R1)(f)}])},t[40]||(t[40]=[(0,s.Lk)("i",{class:"ri-arrow-right-s-line"},null,-1)]),10,sr),(0,s.Lk)("button",{onClick:t[12]||(t[12]=e=>(0,o.R1)(v)((0,o.R1)(f))),disabled:(0,o.R1)(p)===(0,o.R1)(f),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":(0,o.R1)(p)===(0,o.R1)(f)}])},t[41]||(t[41]=[(0,s.Lk)("i",{class:"ri-arrow-right-double-line"},null,-1)]),10,ir)])])):(0,s.Q3)("",!0),0!==(0,o.R1)(x).length||(0,o.R1)(c)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",rr,t[42]||(t[42]=[(0,s.Lk)("div",{class:"w-16 h-16 rounded-full bg-light-bg flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-search-line text-light-text-disabled text-3xl"})],-1),(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary mb-2"},"无端口数据",-1),(0,s.Lk)("p",{class:"text-light-text-secondary max-w-md mb-6"}," 该扫描结果中没有发现端口数据，或正在加载中... ",-1)]))),(0,o.R1)(c)?((0,s.uX)(),(0,s.CE)("div",or,[t[43]||(t[43]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2 text-lg"},null,-1)),(0,s.Lk)("p",nr,(0,i.v_)((0,o.R1)(c)),1)])):(0,s.Q3)("",!0)])]),(0,o.R1)(P)?((0,s.uX)(),(0,s.Wv)(m,{key:0,message:(0,o.R1)(A),type:(0,o.R1)(I),onClose:t[13]||(t[13]=e=>P.value=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(Yt,{show:(0,o.R1)(F),title:(0,o.R1)(K),message:(0,o.R1)(j),type:(0,o.R1)(V),onConfirm:(0,o.R1)(M),onCancel:(0,o.R1)(Q)},null,8,["show","title","message","type","onConfirm","onCancel"])])}}};const cr=(0,g.A)(dr,[["__scopeId","data-v-0f8e4775"]]);var ur=cr;const gr={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},xr={class:"container mx-auto px-6 py-8 flex-1"},mr={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},pr={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},br={class:"flex items-center"},hr={class:"flex gap-3"},fr={class:"bg-light-bg p-4 rounded-xl mb-6 border border-light-border"},kr={class:"flex flex-col md:flex-row gap-4"},vr={class:"flex-1 relative"},yr={class:"flex gap-4"},Lr={class:"relative min-w-[140px]"},wr={key:0,class:"flex items-center gap-2 mt-3 text-sm text-light-text-secondary"},Cr={key:0,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},Rr={key:1,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},_r={key:0,class:"flex flex-col items-center justify-center py-12 text-center"},Tr={class:"text-light-text-secondary max-w-md mb-6"},Sr={key:1,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},Er={class:"text-sm text-red-500"};function Wr(e,t,l,r,o,n){const d=(0,s.g2)("SubdomainScanTable"),c=(0,s.g2)("PopupNotification"),u=(0,s.g2)("ConfirmDialog");return(0,s.uX)(),(0,s.CE)("div",gr,[(0,s.Lk)("div",xr,[(0,s.Lk)("div",mr,[(0,s.Lk)("div",pr,[(0,s.Lk)("div",br,[t[12]||(t[12]=(0,s.Fv)('<div class="flex items-center" data-v-e22b4db8><div class="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center mr-3" data-v-e22b4db8><i class="ri-radar-line text-blue-500 text-xl" data-v-e22b4db8></i></div><div data-v-e22b4db8><h2 class="text-xl font-medium tracking-wide text-light-text-primary" data-v-e22b4db8> 子域名扫描结果 </h2><p class="text-sm text-light-text-secondary mt-1" data-v-e22b4db8> 管理和查看子域名扫描结果 </p></div></div>',1)),(0,s.Lk)("div",{class:(0,i.C4)(["ml-4 px-3 py-1 rounded-lg bg-light-bg text-light-text-secondary text-sm flex items-center",r.filteredResults.length>0?"bg-blue-500/10 text-blue-600":""])},[t[11]||(t[11]=(0,s.Lk)("i",{class:"ri-database-2-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.filteredResults.length)+" 个结果 ",1)],2)]),(0,s.Lk)("div",hr,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.handleRefreshTasks&&r.handleRefreshTasks(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 flex items-center justify-center"},t[13]||(t[13]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2"},null,-1),(0,s.eW)(" 刷新列表 ")])),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-blue-500/10 hover:bg-blue-500/20 text-blue-600 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/30 flex items-center justify-center border border-blue-500/30"},t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描 ")]))])]),(0,s.Lk)("div",fr,[(0,s.Lk)("div",kr,[(0,s.Lk)("div",vr,[t[15]||(t[15]=(0,s.Lk)("i",{class:"ri-search-line absolute left-4 top-3 text-light-text-secondary"},null,-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchQuery=e),type:"text",placeholder:"搜索目标地址...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all duration-200"},null,512),[[a.Jo,r.searchQuery,void 0,{trim:!0}]])]),(0,s.Lk)("div",yr,[(0,s.Lk)("div",Lr,[t[17]||(t[17]=(0,s.Lk)("i",{class:"ri-filter-line absolute left-4 top-3 text-light-text-secondary"},null,-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.statusFilter=e),class:"w-full pl-10 pr-8 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all duration-200 appearance-none"},t[16]||(t[16]=[(0,s.Lk)("option",{value:""},"所有状态",-1),(0,s.Lk)("option",{value:"true"},"已读",-1),(0,s.Lk)("option",{value:"false"},"未读",-1)]),512),[[a.u1,r.statusFilter]]),t[18]||(t[18]=(0,s.Lk)("i",{class:"ri-arrow-down-s-line absolute right-4 top-3 text-light-text-secondary pointer-events-none"},null,-1))]),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.handleSearch&&r.handleSearch(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 flex items-center justify-center min-w-[100px]"},t[19]||(t[19]=[(0,s.Lk)("i",{class:"ri-search-line mr-2"},null,-1),(0,s.eW)(" 查询 ")]))])]),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("div",wr,[t[22]||(t[22]=(0,s.Lk)("i",{class:"ri-filter-3-line"},null,-1)),t[23]||(t[23]=(0,s.Lk)("span",null,"已过滤: ",-1)),r.searchQuery?((0,s.uX)(),(0,s.CE)("div",Cr,[(0,s.eW)(' 搜索 "'+(0,i.v_)(r.searchQuery)+'" ',1),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>r.searchQuery=""),class:"ml-1 text-light-text-secondary hover:text-light-text-primary"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),r.statusFilter?((0,s.uX)(),(0,s.CE)("div",Rr,[(0,s.eW)((0,i.v_)("true"===r.statusFilter?"已读":"未读")+" ",1),(0,s.Lk)("button",{onClick:t[6]||(t[6]=e=>r.statusFilter=""),class:"ml-1 text-light-text-secondary hover:text-light-text-primary"},t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"ml-2 text-blue-500 hover:text-blue-600 text-xs underline"}," 清除全部 ")])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",{class:(0,i.C4)(["bg-white/90 rounded-xl overflow-hidden border border-light-border shadow-light-card",{"opacity-50":r.isLoading}])},[(0,s.bF)(d,{subdomainScanResults:r.filteredResults,loading:r.isLoading,onViewDetails:r.handleViewDetails,onDeleteResult:r.handleDeleteResult,onDeleteSelected:r.handleDeleteSelected,onToggleReadStatus:r.handleToggleReadStatus,onMarkSelectedRead:r.handleMarkSelectedRead},null,8,["subdomainScanResults","loading","onViewDetails","onDeleteResult","onDeleteSelected","onToggleReadStatus","onMarkSelectedRead"])],2),r.isLoading||0!==r.filteredResults.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",_r,[t[26]||(t[26]=(0,s.Lk)("div",{class:"w-16 h-16 rounded-full bg-light-bg flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-radar-line text-light-text-disabled text-3xl"})],-1)),t[27]||(t[27]=(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary mb-2"},"无扫描结果",-1)),(0,s.Lk)("p",Tr,(0,i.v_)(r.hasActiveFilters?"没有符合当前过滤条件的子域名扫描结果，请尝试修改过滤条件或清除筛选":"当前还没有任何子域名扫描结果。创建一个新的扫描任务来发现子域名。"),1),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[8]||(t[8]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 flex items-center"},t[24]||(t[24]=[(0,s.Lk)("i",{class:"ri-filter-off-line mr-2"},null,-1),(0,s.eW)(" 清除筛选条件 ")]))):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t[9]||(t[9]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-blue-500/10 hover:bg-blue-500/20 text-blue-600 transition-all duration-200 flex items-center border border-blue-500/30"},t[25]||(t[25]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描任务 ")])))])),r.errorMessage?((0,s.uX)(),(0,s.CE)("div",Sr,[t[28]||(t[28]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2"},null,-1)),(0,s.Lk)("p",Er,(0,i.v_)(r.errorMessage),1)])):(0,s.Q3)("",!0)])]),r.showNotification?((0,s.uX)(),(0,s.Wv)(c,{key:0,message:r.notificationMessage,type:r.notificationType,onClose:t[10]||(t[10]=e=>r.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(u,{show:r.showDialog,title:r.dialogTitle,message:r.dialogMessage,type:r.dialogType,onConfirm:r.handleConfirm,onCancel:r.handleCancel},null,8,["show","title","message","type","onConfirm","onCancel"])])}const Dr={class:"space-y-6"},Xr={key:0,class:"flex flex-col gap-6"},Pr={class:"relative overflow-hidden rounded-xl border border-light-border bg-white/90 shadow-sm"},Ar={class:"overflow-x-auto custom-scrollbar"},Ir={class:"w-full"},Fr={class:"bg-light-bg border-b border-light-border"},Kr={class:"py-3 px-4 text-left w-10"},jr=["checked","disabled"],Vr={class:"py-3 px-4"},Mr=["value","id"],Qr=["for"],$r={class:"py-3 px-4 text-sm font-mono text-light-text-primary"},Nr={class:"py-3 px-4 text-sm text-light-text-primary"},Br={class:"flex items-center"},Ur={class:"py-3 px-4 text-sm text-light-text-primary"},Hr={class:"flex items-center"},zr={class:"py-3 px-4 text-sm text-light-text-primary"},qr={class:"px-2 py-1 rounded-md bg-blue-500/10 text-blue-600 border border-blue-500/20 inline-flex items-center"},Or={class:"py-3 px-4"},Jr={class:"py-3 px-4"},Gr={class:"flex gap-1 flex-nowrap"},Zr=["onClick"],Yr=["onClick"],eo=["onClick"],to={class:"flex items-center justify-between flex-wrap gap-4 p-4 rounded-xl border border-light-border bg-light-bg shadow-sm"},lo={class:"flex items-center gap-3"},ao={class:"text-sm text-light-text-secondary"},so={class:"text-light-text-primary font-medium"},io={class:"flex flex-wrap gap-3"},ro=["disabled"],oo={key:0},no=["disabled"],co={key:0};function uo(e,t,l,r,o,n){return(0,s.uX)(),(0,s.CE)("div",Dr,[l.subdomainScanResults?.length>0?((0,s.uX)(),(0,s.CE)("div",Xr,[(0,s.Lk)("div",Pr,[(0,s.Lk)("div",Ar,[(0,s.Lk)("table",Ir,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",Fr,[(0,s.Lk)("th",Kr,[(0,s.Lk)("input",{type:"checkbox",onChange:t[0]||(t[0]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e)),checked:r.isAllSelected,class:"checkbox-input",disabled:0===l.subdomainScanResults.length,id:"select-all-header",title:"全选/取消全选"},null,40,jr),t[4]||(t[4]=(0,s.Lk)("label",{for:"select-all-header",class:"sr-only"},"全选/取消全选",-1))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.tableHeaders,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e.key,class:(0,i.C4)(["py-3 px-4 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider",e.width])},(0,i.v_)(e.label),3)))),128))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.subdomainScanResults,((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,i.C4)(["border-b border-light-border transition-all duration-200 hover:bg-light-bg/70",l%2===0?"bg-light-bg/50":""])},[(0,s.Lk)("td",Vr,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedResults=e),value:e.id,class:"checkbox-input",id:`select-result-${e.id}`},null,8,Mr),[[a.lH,r.selectedResults]]),(0,s.Lk)("label",{for:`select-result-${e.id}`,class:"sr-only"},"选择此结果",8,Qr)]),(0,s.Lk)("td",$r,(0,i.v_)(e.id),1),(0,s.Lk)("td",Nr,[(0,s.Lk)("span",Br,[t[5]||(t[5]=(0,s.Lk)("i",{class:"ri-global-line mr-2 text-blue-500"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.target),1)])]),(0,s.Lk)("td",Ur,[(0,s.Lk)("span",Hr,[t[6]||(t[6]=(0,s.Lk)("i",{class:"ri-time-line mr-2 text-light-text-secondary"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.formatDate(e.timestamp)),1)])]),(0,s.Lk)("td",zr,[(0,s.Lk)("span",qr,[t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-radar-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.getSubdomainCount(e))+" 个 ",1)])]),(0,s.Lk)("td",Or,[(0,s.Lk)("span",{class:(0,i.C4)(["px-2 py-1 rounded-md text-xs font-medium inline-flex items-center",e.is_read?"bg-green-500/10 text-green-600 border border-green-500/30":"bg-yellow-500/10 text-yellow-600 border border-yellow-500/30"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-line":"ri-eye-off-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"已读":"未读"),1)],2)]),(0,s.Lk)("td",Jr,[(0,s.Lk)("div",Gr,[(0,s.Lk)("button",{onClick:t=>r.handleViewDetails(e.id),class:"action-button bg-blue-500/10 text-blue-600 border border-blue-500/30 hover:bg-blue-500/20"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"ri-eye-line mr-1"},null,-1),(0,s.eW)(" 查看 ")]),8,Zr),(0,s.Lk)("button",{onClick:t=>r.handleToggleRead(e),class:(0,i.C4)(["action-button",e.is_read?"bg-light-bg text-light-text-primary border border-light-border":"bg-green-500/10 text-green-600 border border-green-500/30 hover:bg-green-500/20"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-off-line":"ri-eye-line","mr-1"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"标为未读":"标为已读"),1)],10,Yr),(0,s.Lk)("button",{onClick:t=>r.handleDelete(e.id),class:"action-button bg-red-500/10 text-red-600 border border-red-500/30 hover:bg-red-500/20"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-1"},null,-1),(0,s.eW)(" 删除 ")]),8,eo)])])],2)))),128))])])])]),(0,s.Lk)("div",to,[(0,s.Lk)("div",lo,[(0,s.Lk)("span",ao,[r.hasSelected?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[t[10]||(t[10]=(0,s.eW)(" 已选择 ")),(0,s.Lk)("span",so,(0,i.v_)(r.selectedResults.length),1),t[11]||(t[11]=(0,s.eW)(" 项 "))],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)(" 请选择要操作的项目 ")],64))])]),(0,s.Lk)("div",io,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.handleBatchRead&&r.handleBatchRead(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20":"bg-light-bg text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[12]||(t[12]=(0,s.Lk)("i",{class:"ri-eye-line mr-2"},null,-1)),t[13]||(t[13]=(0,s.eW)(" 标记已读 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",oo,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,ro),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.handleBatchDelete&&r.handleBatchDelete(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-red-500/10 text-red-600 border-red-500/30 hover:bg-red-500/20":"bg-light-bg text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[14]||(t[14]=(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1)),t[15]||(t[15]=(0,s.eW)(" 批量删除 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",co,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,no)])])])):(0,s.Q3)("",!0)])}var go={name:"SubdomainScanTable",props:{subdomainScanResults:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["view-details","delete-result","delete-selected","toggle-read-status","mark-selected-read"],setup(e,{emit:t}){const l=(0,o.KR)([]),a=[{key:"id",label:"ID",width:"w-24"},{key:"target",label:"目标地址",width:"w-48"},{key:"timestamp",label:"扫描时间",width:"w-44"},{key:"count",label:"子域名数量",width:"w-32"},{key:"status",label:"状态",width:"w-24"},{key:"actions",label:"操作",width:"w-52"}],i=(0,s.EW)((()=>l.value.length>0)),r=(0,s.EW)((()=>!!e.subdomainScanResults?.length&&l.value.length===e.subdomainScanResults.length));(0,s.wB)((()=>e.subdomainScanResults),(()=>{l.value=[]}));const n=()=>{r.value?l.value=[]:l.value=e.subdomainScanResults.map((e=>e.id))},d=e=>{if(!e||!e.data||!Array.isArray(e.data))return 0;const t=e.data.find((e=>"subdomains"===e.Key));return t?.Value?.length||0},c=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return e||"未知时间"}},u=e=>t("view-details",e),g=e=>t("toggle-read-status",e.id,!e.is_read),x=e=>t("delete-result",e),m=()=>{0!==l.value.length&&t("mark-selected-read",l.value)},p=()=>{0!==l.value.length&&t("delete-selected",l.value)};return{selectedResults:l,tableHeaders:a,hasSelected:i,isAllSelected:r,toggleSelectAll:n,getSubdomainCount:d,formatDate:c,handleViewDetails:u,handleToggleRead:g,handleDelete:x,handleBatchRead:m,handleBatchDelete:p}}};const xo=(0,g.A)(go,[["render",uo],["__scopeId","data-v-2f85451f"]]);var mo=xo,po={name:"SubdomainScanResults",components:{SubdomainScanTable:mo,PopupNotification:m,ConfirmDialog:Yt},setup(){const e=(0,n.rd)(),t=(0,o.KR)([]),l=(0,o.KR)(""),a=(0,o.KR)(""),i=(0,o.KR)(""),r=(0,o.KR)(!1),{showNotification:d,notificationMessage:c,notificationType:u,showSuccess:g,showError:x}=Xe(),{confirm:m,showDialog:p,dialogTitle:b,dialogMessage:h,dialogType:f,handleConfirm:k,handleCancel:v}=el(),y=(0,s.EW)((()=>""!==a.value.trim()||""!==i.value)),L=async()=>{try{r.value=!0,l.value="";const e=await se.get("/results/type/Subdomain");t.value=e.data,g("已刷新扫描结果")}catch(e){l.value="获取扫描结果失败，请重试或联系管理员",x("获取扫描结果失败")}finally{r.value=!1}},w=()=>{r.value=!0,setTimeout((()=>{r.value=!1}),300)},C=()=>{a.value="",i.value="",w()},R=t=>{e.push({name:"SubdomainScanDetail",params:{id:t}})},_=async e=>{try{const t=await m({title:"确认删除",message:"是否确认删除此扫描结果？此操作不可撤销。",type:"danger"});t&&(r.value=!0,await se.delete(`/results/${e}`),await L(),g("已删除扫描结果"))}catch(t){x("删除扫描结果失败"),r.value=!1}},T=async(e,l)=>{try{r.value=!0,await se.put(`/results/${e}/read`,{is_read:l});const a=t.value.findIndex((t=>t.id===e));-1!==a&&(t.value[a].is_read=l),g("已更新状态"),r.value=!1}catch(a){x("更新状态失败"),await L()}},S=async e=>{if(0!==e.length)try{r.value=!0,await Promise.all(e.map((e=>se.put(`/results/${e}/read`,{is_read:!0})))),await L(),g(`已将 ${e.length} 个结果标记为已读`)}catch(t){x("批量标记失败")}finally{r.value=!1}else x("请选择要标记的结果")},E=async e=>{if(0!==e.length)try{const t=await m({title:"批量删除",message:`是否确认删除选中的 ${e.length} 个结果？此操作不可撤销。`,type:"danger"});t&&(r.value=!0,await Promise.all(e.map((e=>se.delete(`/results/${e}`)))),await L(),g(`已删除 ${e.length} 个结果`))}catch(t){x("批量删除失败"),r.value=!1}else x("请选择要删除的结果")},W=(0,s.EW)((()=>{if(!Array.isArray(t.value)||!t.value.length)return[];let e=[...t.value];if(a.value.trim()){const t=a.value.toLowerCase().trim();e=e.filter((e=>e.Target&&e.Target.toLowerCase().includes(t)))}if(""!==i.value){const t="true"===i.value;e=e.filter((e=>e.is_read===t))}return e.sort(((e,t)=>new Date(t.Timestamp).getTime()-new Date(e.Timestamp).getTime()))}));return(0,s.sV)(L),{router:e,subdomainScanResults:t,errorMessage:l,showNotification:d,notificationMessage:c,notificationType:u,showDialog:p,dialogTitle:b,dialogMessage:h,dialogType:f,searchQuery:a,statusFilter:i,filteredResults:W,isLoading:r,hasActiveFilters:y,handleConfirm:k,handleCancel:v,handleRefreshTasks:L,handleViewDetails:R,handleDeleteResult:_,handleDeleteSelected:E,handleToggleReadStatus:T,handleMarkSelectedRead:S,handleSearch:w,clearFilters:C}}};const bo=(0,g.A)(po,[["render",Wr],["__scopeId","data-v-e22b4db8"]]);var ho=bo;l(7642),l(8004),l(3853),l(5876),l(2475),l(5024),l(1698);const fo=e=>({id:e.find((e=>"_id"===e.Key))?.Value||"",domain:e.find((e=>"domain"===e.Key))?.Value||"",is_read:e.find((e=>"is_read"===e.Key))?.Value||!1,ip:e.find((e=>"ip"===e.Key))?.Value||"",httpStatus:e.find((e=>"http_status"===e.Key))?.Value||null,httpTitle:e.find((e=>"http_title"===e.Key))?.Value||""}),ko=(e,t)=>{if(e.ip&&t.ip){const l=e.ip.split(".").map(Number),a=t.ip.split(".").map(Number);for(let e=0;e<4;e++)if(l[e]!==a[e])return l[e]-a[e];return e.domain.localeCompare(t.domain)}return e.ip?-1:t.ip?1:e.domain.localeCompare(t.domain)};function vo(){const e=(0,n.lq)(),{showNotification:t,notificationMessage:l,notificationType:a,showSuccess:i,showError:r,showWarning:d}=Xe(),{confirm:c,showDialog:u,dialogTitle:g,dialogMessage:x,dialogType:m,handleConfirm:p,handleCancel:b}=el(),h=(0,o.KR)(null),f=(0,o.KR)(""),k=(0,o.KR)([]),v=(0,o.KR)(!1),y=(0,o.KR)(!1),L=(0,o.KR)(!1),w=(0,o.KR)(1),C=(0,o.KR)(10),R=[10,20,50,100];(0,s.wB)(k,(e=>{v.value=e.length===T.value.length&&e.length>0}));const _=async e=>{try{const t=await se.get(`/results/${e}`);h.value=t.data,f.value=""}catch(t){f.value="获取扫描结果详情失败",r("获取扫描结果详情失败")}},T=(0,s.EW)((()=>{if(!h.value?.data)return[];const e=h.value.data.find((e=>"subdomains"===e.Key));if(!e?.Value?.length)return[];const t=e.Value.map(fo),l=t.sort(ko),a=new Set;return l.map((e=>({...e,isFirstIP:e.ip&&!a.has(e.ip)&&a.add(e.ip)})))})),S=(0,s.EW)((()=>Math.ceil(T.value.length/C.value)||1)),E=(0,s.EW)((()=>{const e=(w.value-1)*C.value,t=e+C.value;return T.value.slice(e,t)})),W=e=>{e<1&&(e=1),e>S.value&&(e=S.value),w.value=e},D=()=>{w.value<S.value&&w.value++},X=()=>{w.value>1&&w.value--},P=e=>{C.value=e,w.value=1},A=()=>{k.value=v.value?T.value.map((e=>e.id)):[]},I=async t=>{try{await se.put(`/results/${e.params.id}/entries/${t.id}/read`,{is_read:!t.is_read}),await _(e.params.id),i("已"+(t.is_read?"标记为未读":"标记为已读"))}catch(l){r("更新状态失败")}},F=async t=>{const l=Array.isArray(t)?t.map((e=>e.id||e)):[t.id||t];if(!l.length)return void d("请先选择子域名");const a=await c({title:l.length>1?"批量解析IP":"解析IP",message:l.length>1?`是否解析选中的 ${l.length} 个子域名的IP？`:`是否解析 ${t.domain} 的IP地址？`,type:"info"});if(a)try{y.value=!0,await se.put(`/results/${e.params.id}/entries/resolve`,{entryIds:l}),await _(e.params.id),i(l.length>1?"批量解析成功":"IP解析成功")}catch(s){r(l.length>1?"批量解析失败":"IP解析失败")}finally{y.value=!1}},K=async e=>{const t=Array.isArray(e)?e.map((e=>T.value.find((t=>t.id===e)))).filter((e=>e?.ip)):[e],l=[...new Set(t.map((e=>e.ip)))];if(!l.length)return void d("没有可用的IP");if(!h.value?.target_id)return void d("无法获取目标ID");const a=await c({title:t.length>1?"批量发送到端口扫描":"发送到端口扫描",message:t.length>1?`是否将选中的 ${l.length} 个IP发送到端口扫描？`:`是否将 ${t[0].domain} (${t[0].ip}) 发送到端口扫描？`,type:"info"});if(a)try{for(const e of l)await se.post("/tasks",{type:"nmap",payload:e,target_id:h.value.target_id});i(t.length>1?`已发送 ${l.length} 个IP到端口扫描`:"已发送到端口扫描")}catch(s){r(t.length>1?"批量发送失败":"发送失败")}},j=async t=>{const l=Array.isArray(t)?t.map((e=>e.id||e)):[t.id||t];if(!l.length)return void d("请先选择子域名");const a=await c({title:l.length>1?"批量HTTPX探测":"HTTPX探测",message:l.length>1?`是否对选中的 ${l.length} 个子域名进行HTTPX探测？`:`是否对 ${t.domain} 进行HTTPX探测？`,type:"info"});if(a)try{L.value=!0,await se.put(`/results/${e.params.id}/entries/probe`,{entryIds:l}),await _(e.params.id),i(l.length>1?"批量探测成功":"HTTPX探测成功")}catch(s){r(l.length>1?"批量探测失败":"HTTPX探测失败")}finally{L.value=!1}},V=async e=>{try{await navigator.clipboard.writeText(e),i("已复制到剪贴板")}catch(t){r("复制失败")}};return{scanResult:h,subdomains:T,selectedSubdomains:k,selectAll:v,errorMessage:f,isResolving:y,isProbing:L,currentPage:w,pageSize:C,pageSizeOptions:R,fetchScanResult:_,toggleSelectAll:A,toggleReadStatus:I,resolveIPs:F,sendToPortScan:K,probeHosts:j,getHttpStatusClass:Hs,copyToClipboard:V,confirm:c,showNotification:t,notificationMessage:l,notificationType:a,showDialog:u,dialogTitle:g,dialogMessage:x,dialogType:m,handleConfirm:p,handleCancel:b,totalPages:S,paginatedSubdomains:E,goToPage:W,nextPage:D,prevPage:X,changePageSize:P}}const yo={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},Lo={class:"container mx-auto px-6 py-8 flex-1 mt-16"},wo={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Co={class:"flex items-center text-sm text-light-text-secondary mb-6"},Ro={class:"bg-light-bg rounded-xl border border-light-border mb-6 overflow-hidden"},_o={class:"p-5 border-b border-light-border flex items-center space-x-3"},To={class:"text-xl font-medium tracking-wide text-light-text-primary"},So={class:"grid grid-cols-1 md:grid-cols-3 gap-6 p-5"},Eo={class:"flex flex-col"},Wo={class:"flex items-center"},Do={class:"text-sm font-mono text-light-text-primary"},Xo={class:"flex flex-col"},Po={class:"flex items-center"},Ao={class:"text-sm text-light-text-primary"},Io={class:"flex flex-col"},Fo={class:"flex items-center"},Ko={class:"text-sm text-light-text-primary"},jo={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},Vo={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},Mo={class:"text-2xl font-medium text-light-text-primary"},Qo={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},$o={class:"text-2xl font-medium text-blue-600"},No={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},Bo={class:"text-2xl font-medium text-purple-600"},Uo={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},Ho={class:"text-2xl font-medium text-green-600"},zo={class:"bg-light-bg rounded-xl border border-light-border p-4 mb-6"},qo={class:"flex flex-wrap items-center gap-3"},Oo={class:"flex items-center mr-2"},Jo={key:0,class:"text-sm text-light-text-secondary"},Go={class:"flex flex-wrap gap-3 ml-auto"},Zo=["disabled"],Yo=["disabled"],en=["disabled"],tn={class:"bg-white/90 rounded-xl border border-light-border overflow-hidden mb-4"},ln={class:"relative overflow-x-auto custom-scrollbar"},an={class:"w-full"},sn={class:"bg-light-bg"},rn={class:"py-3 px-4 w-10"},on=["value"],nn={class:"py-3 px-4 text-xs font-mono text-light-text-primary w-20"},dn={class:"py-3 px-4 text-sm w-64"},cn={class:"flex items-center"},un=["href","title"],gn=["onClick"],xn={class:"py-3 px-4 text-sm w-36"},mn={key:0,class:"flex items-center"},pn=["onClick"],bn=["onClick"],hn={class:"py-3 px-4 text-sm w-28"},fn=["onClick"],kn={class:"py-3 px-4 text-sm text-light-text-primary w-48"},vn=["title"],yn={class:"py-3 px-4 w-20"},Ln={class:"py-3 px-4 w-48"},wn={class:"flex gap-2"},Cn=["onClick"],Rn=["onClick","disabled"],_n={key:0,class:"mt-4 flex flex-col gap-4"},Tn={class:"flex justify-between items-center"},Sn={class:"flex items-center space-x-2"},En=["value"],Wn={class:"text-sm text-light-text-secondary"},Dn={class:"flex justify-center items-center space-x-2"},Xn=["disabled"],Pn=["disabled"],An={class:"page-button bg-blue-500/20 text-blue-600 border-blue-500/50"},In=["disabled"],Fn=["disabled"],Kn={key:1,class:"flex flex-col items-center justify-center py-12 text-center"},jn={key:2,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},Vn={class:"text-sm text-red-500"};var Mn={__name:"SubdomainScanDetail",setup(e){const t=(0,n.lq)(),l=["ID","子域名","IP地址","HTTP状态","标题","状态","操作"],{scanResult:r,errorMessage:d,subdomains:c,selectedSubdomains:u,selectAll:g,isResolving:x,isProbing:p,currentPage:b,pageSize:h,pageSizeOptions:f,totalPages:k,paginatedSubdomains:v,goToPage:y,nextPage:L,prevPage:w,changePageSize:R,showNotification:_,notificationMessage:T,notificationType:S,showDialog:E,dialogTitle:W,dialogMessage:D,dialogType:X,fetchScanResult:P,toggleSelectAll:A,toggleReadStatus:I,resolveIPs:F,sendToPortScan:K,probeHosts:j,handleConfirm:V,handleCancel:M,getHttpStatusClass:Q,copyToClipboard:$}=vo();return(0,s.sV)((()=>{P(t.params.id)})),(e,t)=>{const n=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",yo,[(0,s.bF)(C),(0,s.Lk)("div",Lo,[(0,s.Lk)("div",wo,[(0,s.Lk)("div",Co,[(0,s.bF)(n,{to:"/subdomain-scan-results",class:"hover:text-blue-500 transition-colors flex items-center"},{default:(0,s.k6)((()=>t[15]||(t[15]=[(0,s.Lk)("i",{class:"ri-arrow-left-line mr-1"},null,-1),(0,s.eW)(" 返回列表 ")]))),_:1}),t[16]||(t[16]=(0,s.Lk)("i",{class:"ri-arrow-right-s-line mx-2"},null,-1)),t[17]||(t[17]=(0,s.Lk)("span",{class:"text-light-text-primary"},"扫描详情",-1))]),(0,s.Lk)("div",Ro,[(0,s.Lk)("div",_o,[t[19]||(t[19]=(0,s.Lk)("div",{class:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center"},[(0,s.Lk)("i",{class:"ri-radar-line text-blue-500 text-xl"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h2",To,(0,i.v_)((0,o.R1)(r)?.target||"加载中..."),1),t[18]||(t[18]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mt-1"},"子域名扫描结果详情",-1))])]),(0,s.Lk)("div",So,[(0,s.Lk)("div",Eo,[t[21]||(t[21]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-fingerprint-line mr-1.5"}),(0,s.eW)(" 扫描ID ")],-1)),(0,s.Lk)("div",Wo,[(0,s.Lk)("span",Do,(0,i.v_)((0,o.R1)(r)?.id||"-"),1),(0,o.R1)(r)?.id?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>(0,o.R1)($)((0,o.R1)(r).id)),class:"ml-2 text-light-text-disabled hover:text-light-text-secondary transition-colors",title:"复制ID"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",Xo,[t[23]||(t[23]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-global-line mr-1.5"}),(0,s.eW)(" 目标地址 ")],-1)),(0,s.Lk)("div",Po,[(0,s.Lk)("span",Ao,(0,i.v_)((0,o.R1)(r)?.target||"-"),1),(0,o.R1)(r)?.target?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[1]||(t[1]=e=>(0,o.R1)($)((0,o.R1)(r).target)),class:"ml-2 text-light-text-disabled hover:text-light-text-secondary transition-colors",title:"复制目标"},t[22]||(t[22]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",Io,[t[24]||(t[24]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-time-line mr-1.5"}),(0,s.eW)(" 扫描时间 ")],-1)),(0,s.Lk)("div",Fo,[(0,s.Lk)("span",Ko,(0,i.v_)((0,o.R1)(r)?new Date((0,o.R1)(r).timestamp).toLocaleString():"-"),1)])])])]),(0,s.Lk)("div",jo,[(0,s.Lk)("div",Vo,[t[25]||(t[25]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"总子域名",-1)),(0,s.Lk)("span",Mo,(0,i.v_)((0,o.R1)(c).length),1)]),(0,s.Lk)("div",Qo,[t[26]||(t[26]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"已解析IP",-1)),(0,s.Lk)("span",$o,(0,i.v_)((0,o.R1)(c).filter((e=>e.ip)).length),1)]),(0,s.Lk)("div",No,[t[27]||(t[27]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"已探测HTTP",-1)),(0,s.Lk)("span",Bo,(0,i.v_)((0,o.R1)(c).filter((e=>e.httpStatus)).length),1)]),(0,s.Lk)("div",Uo,[t[28]||(t[28]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"已读状态",-1)),(0,s.Lk)("span",Ho,(0,i.v_)((0,o.R1)(c).filter((e=>e.is_read)).length),1)])]),(0,s.Lk)("div",zo,[(0,s.Lk)("div",qo,[(0,s.Lk)("div",Oo,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",onChange:t[2]||(t[2]=(...e)=>(0,o.R1)(A)&&(0,o.R1)(A)(...e)),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.i9)(g)?g.value=e:null),class:"rounded border-light-border bg-white text-blue-500 focus:ring-blue-500/30 mr-2",id:"select-all"},null,544),[[a.lH,(0,o.R1)(g)]]),t[29]||(t[29]=(0,s.Lk)("label",{for:"select-all",class:"text-sm text-light-text-primary cursor-pointer"}," 全选 ",-1))]),(0,o.R1)(u).length>0?((0,s.uX)(),(0,s.CE)("span",Jo," 已选择 "+(0,i.v_)((0,o.R1)(u).length)+" 项 ",1)):(0,s.Q3)("",!0),(0,s.Lk)("div",Go,[(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>(0,o.R1)(F)((0,o.R1)(u))),disabled:0===(0,o.R1)(u).length||(0,o.R1)(x),class:(0,i.C4)(["tool-button bg-blue-500/10 border-blue-500/30 text-blue-600 hover:bg-blue-500/20",{"opacity-60 cursor-not-allowed":0===(0,o.R1)(u).length||(0,o.R1)(x)}])},[t[30]||(t[30]=(0,s.Lk)("i",{class:"ri-radar-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(x)?"正在解析...":"解析选中IP"),1)],10,Zo),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>(0,o.R1)(j)((0,o.R1)(u))),disabled:0===(0,o.R1)(u).length||(0,o.R1)(p),class:(0,i.C4)(["tool-button bg-purple-500/10 border-purple-500/30 text-purple-600 hover:bg-purple-500/20",{"opacity-60 cursor-not-allowed":0===(0,o.R1)(u).length||(0,o.R1)(p)}])},[t[31]||(t[31]=(0,s.Lk)("i",{class:"ri-search-eye-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(p)?"正在探测...":"HTTPX探测"),1)],10,Yo),(0,s.Lk)("button",{onClick:t[6]||(t[6]=e=>(0,o.R1)(K)((0,o.R1)(u))),disabled:0===(0,o.R1)(u).length,class:(0,i.C4)(["tool-button bg-yellow-500/10 border-yellow-500/30 text-yellow-600 hover:bg-yellow-500/20",{"opacity-60 cursor-not-allowed":0===(0,o.R1)(u).length}])},t[32]||(t[32]=[(0,s.Lk)("i",{class:"ri-scan-2-line mr-1.5"},null,-1),(0,s.eW)(" 发送到端口扫描 ")]),10,en)])])]),(0,s.Lk)("div",tn,[(0,s.Lk)("div",ln,[(0,s.Lk)("table",an,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",sn,[t[33]||(t[33]=(0,s.Lk)("th",{class:"py-3 px-4 text-left"},[(0,s.Lk)("span",{class:"sr-only"},"选择")],-1)),((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(l,(e=>(0,s.Lk)("th",{key:e,class:"py-3 px-4 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider"},(0,i.v_)(e),1))),64))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(v),((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,i.C4)(["border-t border-light-border transition-colors duration-200",[e.isFirstIP?"bg-blue-50":l%2===0?"bg-light-bg/50":"bg-transparent",e.isFirstIP?"border-blue-500/30":"","hover:bg-light-bg/70"]])},[(0,s.Lk)("td",rn,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>(0,o.i9)(u)?u.value=e:null),value:e.id,class:"rounded border-light-border bg-white text-blue-500 focus:ring-blue-500/30"},null,8,on),[[a.lH,(0,o.R1)(u)]])]),(0,s.Lk)("td",nn,(0,i.v_)(e.id),1),(0,s.Lk)("td",dn,[(0,s.Lk)("div",cn,[(0,s.Lk)("a",{href:`http://${e.domain}`,target:"_blank",class:"text-light-text-primary hover:text-blue-500 transition-colors truncate max-w-xs",title:e.domain},(0,i.v_)(e.domain),9,un),(0,s.Lk)("button",{onClick:t=>(0,o.R1)($)(e.domain),class:"ml-2 text-light-text-disabled hover:text-light-text-secondary transition-colors",title:"复制域名"},t[34]||(t[34]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]),8,gn)])]),(0,s.Lk)("td",xn,[e.ip?((0,s.uX)(),(0,s.CE)("div",mn,[(0,s.Lk)("span",{class:(0,i.C4)(["text-light-text-primary",e.isFirstIP?"text-blue-600":""])},(0,i.v_)(e.ip),3),(0,s.Lk)("button",{onClick:t=>(0,o.R1)($)(e.ip),class:"ml-2 text-light-text-disabled hover:text-light-text-secondary transition-colors",title:"复制IP"},t[35]||(t[35]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]),8,pn)])):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t=>(0,o.R1)(F)([e.id]),class:"status-button bg-blue-500/10 text-blue-600 border-blue-500/30"},t[36]||(t[36]=[(0,s.Lk)("i",{class:"ri-radar-line mr-1"},null,-1),(0,s.eW)(" 解析IP ")]),8,bn))]),(0,s.Lk)("td",hn,[e.httpStatus?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,i.C4)(["status-badge",(0,o.R1)(Q)(e.httpStatus)])},(0,i.v_)(e.httpStatus),3)):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t=>(0,o.R1)(j)([e.id]),class:"status-button bg-purple-500/10 text-purple-600 border-purple-500/30"},t[37]||(t[37]=[(0,s.Lk)("i",{class:"ri-search-eye-line mr-1"},null,-1),(0,s.eW)(" 探测 ")]),8,fn))]),(0,s.Lk)("td",kn,[(0,s.Lk)("div",{class:"truncate",title:e.httpTitle},(0,i.v_)(e.httpTitle||"-"),9,vn)]),(0,s.Lk)("td",yn,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",e.is_read?"bg-green-500/10 text-green-600 border-green-500/30":"bg-yellow-500/10 text-yellow-600 border-yellow-500/30"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-line":"ri-eye-off-line","mr-1"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"已读":"未读"),1)],2)]),(0,s.Lk)("td",Ln,[(0,s.Lk)("div",wn,[(0,s.Lk)("button",{onClick:t=>(0,o.R1)(I)(e),class:(0,i.C4)(["action-button",e.is_read?"bg-light-bg text-light-text-primary border-light-border":"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-off-line":"ri-eye-line"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"标为未读":"标为已读"),1)],10,Cn),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(K)([e.id]),disabled:!e.ip,class:(0,i.C4)(["action-button",[e.ip?"bg-yellow-500/10 text-yellow-600 border-yellow-500/30 hover:bg-yellow-500/20":"bg-light-bg text-light-text-disabled border-light-border opacity-60 cursor-not-allowed"]])},t[38]||(t[38]=[(0,s.Lk)("i",{class:"ri-scan-2-line"},null,-1),(0,s.eW)(" 端口扫描 ")]),10,Rn)])])],2)))),128))])])])]),(0,o.R1)(c).length>0?((0,s.uX)(),(0,s.CE)("div",_n,[(0,s.Lk)("div",Tn,[(0,s.Lk)("div",Sn,[t[39]||(t[39]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary"},"每页显示:",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>(0,o.i9)(h)?h.value=e:null),onChange:t[9]||(t[9]=e=>(0,o.R1)(R)((0,o.R1)(h))),class:"bg-white border border-light-border text-light-text-primary text-sm rounded-lg focus:ring-blue-500/30 focus:border-blue-500/50 px-2.5 py-1"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(f),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,i.v_)(e),9,En)))),128))],544),[[a.u1,(0,o.R1)(h)]])]),(0,s.Lk)("div",Wn," 显示 "+(0,i.v_)(0===(0,o.R1)(c).length?0:((0,o.R1)(b)-1)*(0,o.R1)(h)+1)+" - "+(0,i.v_)(Math.min((0,o.R1)(b)*(0,o.R1)(h),(0,o.R1)(c).length))+" 共 "+(0,i.v_)((0,o.R1)(c).length)+" 条 ",1)]),(0,s.Lk)("div",Dn,[(0,s.Lk)("button",{onClick:t[10]||(t[10]=e=>(0,o.R1)(y)(1)),disabled:1===(0,o.R1)(b),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":1===(0,o.R1)(b)}])},t[40]||(t[40]=[(0,s.Lk)("i",{class:"ri-arrow-left-double-line"},null,-1)]),10,Xn),(0,s.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>(0,o.R1)(w)&&(0,o.R1)(w)(...e)),disabled:1===(0,o.R1)(b),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":1===(0,o.R1)(b)}])},t[41]||(t[41]=[(0,s.Lk)("i",{class:"ri-arrow-left-s-line"},null,-1)]),10,Pn),(0,s.Lk)("span",An,(0,i.v_)((0,o.R1)(b)),1),(0,s.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>(0,o.R1)(L)&&(0,o.R1)(L)(...e)),disabled:(0,o.R1)(b)===(0,o.R1)(k),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":(0,o.R1)(b)===(0,o.R1)(k)}])},t[42]||(t[42]=[(0,s.Lk)("i",{class:"ri-arrow-right-s-line"},null,-1)]),10,In),(0,s.Lk)("button",{onClick:t[13]||(t[13]=e=>(0,o.R1)(y)((0,o.R1)(k))),disabled:(0,o.R1)(b)===(0,o.R1)(k),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":(0,o.R1)(b)===(0,o.R1)(k)}])},t[43]||(t[43]=[(0,s.Lk)("i",{class:"ri-arrow-right-double-line"},null,-1)]),10,Fn)])])):(0,s.Q3)("",!0),0!==(0,o.R1)(c).length||(0,o.R1)(d)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Kn,t[44]||(t[44]=[(0,s.Lk)("div",{class:"w-16 h-16 rounded-full bg-light-bg flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-search-line text-light-text-disabled text-3xl"})],-1),(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary mb-2"},"无子域名数据",-1),(0,s.Lk)("p",{class:"text-light-text-secondary max-w-md mb-6"}," 该扫描结果中没有发现子域名数据，或正在加载中... ",-1)]))),(0,o.R1)(d)?((0,s.uX)(),(0,s.CE)("div",jn,[t[45]||(t[45]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2 text-lg"},null,-1)),(0,s.Lk)("p",Vn,(0,i.v_)((0,o.R1)(d)),1)])):(0,s.Q3)("",!0)])]),(0,o.R1)(_)?((0,s.uX)(),(0,s.Wv)(m,{key:0,message:(0,o.R1)(T),type:(0,o.R1)(S),onClose:t[14]||(t[14]=e=>_.value=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(Yt,{show:(0,o.R1)(E),title:(0,o.R1)(W),message:(0,o.R1)(D),type:(0,o.R1)(X),onConfirm:(0,o.R1)(V),onCancel:(0,o.R1)(M)},null,8,["show","title","message","type","onConfirm","onCancel"])])}}};const Qn=(0,g.A)(Mn,[["__scopeId","data-v-05dccf5c"]]);var $n=Qn;const Nn={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},Bn={class:"container mx-auto px-6 py-8 flex-1"},Un={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Hn={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},zn={class:"flex items-center"},qn={class:"flex gap-3"},On={class:"bg-light-bg p-4 rounded-xl mb-6 border border-light-border"},Jn={class:"flex flex-col md:flex-row gap-4"},Gn={class:"flex-1 relative"},Zn={class:"flex gap-4"},Yn={class:"relative min-w-[140px]"},ed={key:0,class:"flex items-center gap-2 mt-3 text-sm text-light-text-secondary"},td={key:0,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},ld={key:1,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},ad={key:0,class:"flex flex-col items-center justify-center py-12 text-center"},sd={class:"text-light-text-secondary max-w-md mb-6"},id={key:1,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},rd={class:"text-sm text-red-500"};function od(e,t,l,r,o,n){const d=(0,s.g2)("PathScanTable"),c=(0,s.g2)("PopupNotification"),u=(0,s.g2)("ConfirmDialog");return(0,s.uX)(),(0,s.CE)("div",Nn,[(0,s.Lk)("div",Bn,[(0,s.Lk)("div",Un,[(0,s.Lk)("div",Hn,[(0,s.Lk)("div",zn,[t[12]||(t[12]=(0,s.Fv)('<div class="flex items-center" data-v-7f903264><div class="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center mr-3" data-v-7f903264><i class="ri-folders-line text-blue-500 text-xl" data-v-7f903264></i></div><div data-v-7f903264><h2 class="text-xl font-medium tracking-wide text-light-text-primary" data-v-7f903264> 路径扫描结果 </h2><p class="text-sm text-light-text-secondary mt-1" data-v-7f903264>管理和查看路径发现结果</p></div></div>',1)),(0,s.Lk)("div",{class:(0,i.C4)(["ml-4 px-3 py-1 rounded-lg bg-light-bg text-light-text-primary text-sm flex items-center",r.filteredResults.length>0?"bg-blue-500/10 text-blue-500":""])},[t[11]||(t[11]=(0,s.Lk)("i",{class:"ri-database-2-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.filteredResults.length)+" 个结果 ",1)],2)]),(0,s.Lk)("div",qn,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.handleRefreshTasks&&r.handleRefreshTasks(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-light-border flex items-center justify-center"},t[13]||(t[13]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2"},null,-1),(0,s.eW)(" 刷新列表 ")])),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-blue-500/10 hover:bg-blue-500/20 text-blue-500 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/30 flex items-center justify-center border border-blue-500/30"},t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描 ")]))])]),(0,s.Lk)("div",On,[(0,s.Lk)("div",Jn,[(0,s.Lk)("div",Gn,[t[15]||(t[15]=(0,s.Lk)("i",{class:"ri-search-line absolute left-4 top-3 text-light-text-tertiary"},null,-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchQuery=e),type:"text",placeholder:"搜索目标地址...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all duration-200"},null,512),[[a.Jo,r.searchQuery,void 0,{trim:!0}]])]),(0,s.Lk)("div",Zn,[(0,s.Lk)("div",Yn,[t[17]||(t[17]=(0,s.Lk)("i",{class:"ri-filter-line absolute left-4 top-3 text-light-text-tertiary"},null,-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.statusFilter=e),class:"w-full pl-10 pr-8 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all duration-200 appearance-none"},t[16]||(t[16]=[(0,s.Lk)("option",{value:""},"所有状态",-1),(0,s.Lk)("option",{value:"true"},"已读",-1),(0,s.Lk)("option",{value:"false"},"未读",-1)]),512),[[a.u1,r.statusFilter]]),t[18]||(t[18]=(0,s.Lk)("i",{class:"ri-arrow-down-s-line absolute right-4 top-3 text-light-text-tertiary pointer-events-none"},null,-1))]),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.handleSearch&&r.handleSearch(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-light-border flex items-center justify-center min-w-[100px]"},t[19]||(t[19]=[(0,s.Lk)("i",{class:"ri-search-line mr-2"},null,-1),(0,s.eW)(" 查询 ")]))])]),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("div",ed,[t[22]||(t[22]=(0,s.Lk)("i",{class:"ri-filter-3-line"},null,-1)),t[23]||(t[23]=(0,s.Lk)("span",null,"已过滤: ",-1)),r.searchQuery?((0,s.uX)(),(0,s.CE)("div",td,[(0,s.eW)(' 搜索 "'+(0,i.v_)(r.searchQuery)+'" ',1),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>r.searchQuery=""),class:"ml-1 text-light-text-tertiary hover:text-light-text-secondary"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),r.statusFilter?((0,s.uX)(),(0,s.CE)("div",ld,[(0,s.eW)((0,i.v_)("true"===r.statusFilter?"已读":"未读")+" ",1),(0,s.Lk)("button",{onClick:t[6]||(t[6]=e=>r.statusFilter=""),class:"ml-1 text-light-text-tertiary hover:text-light-text-secondary"},t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"ml-2 text-blue-500 hover:text-blue-600 text-xs underline"}," 清除全部 ")])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",{class:(0,i.C4)(["bg-white/90 rounded-xl overflow-hidden border border-light-border shadow-sm",{"opacity-50":r.isLoading}])},[(0,s.bF)(d,{pathScanResults:r.filteredResults,loading:r.isLoading,onViewDetails:r.handleViewDetails,onDeleteResult:r.handleDeleteResult,onDeleteSelected:r.handleDeleteSelected,onToggleReadStatus:r.handleToggleReadStatus,onMarkSelectedRead:r.handleMarkSelectedRead},null,8,["pathScanResults","loading","onViewDetails","onDeleteResult","onDeleteSelected","onToggleReadStatus","onMarkSelectedRead"])],2),r.isLoading||0!==r.filteredResults.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",ad,[t[26]||(t[26]=(0,s.Lk)("div",{class:"w-16 h-16 rounded-full bg-light-bg flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-folders-line text-light-text-disabled text-3xl"})],-1)),t[27]||(t[27]=(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary mb-2"},"无扫描结果",-1)),(0,s.Lk)("p",sd,(0,i.v_)(r.hasActiveFilters?"没有符合当前过滤条件的路径扫描结果，请尝试修改过滤条件或清除筛选":"当前还没有任何路径扫描结果。创建一个新的扫描任务来发现目标路径。"),1),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[8]||(t[8]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 flex items-center"},t[24]||(t[24]=[(0,s.Lk)("i",{class:"ri-filter-off-line mr-2"},null,-1),(0,s.eW)(" 清除筛选条件 ")]))):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t[9]||(t[9]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-blue-500/10 hover:bg-blue-500/20 text-blue-500 transition-all duration-200 flex items-center border border-blue-500/30"},t[25]||(t[25]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描任务 ")])))])),r.errorMessage?((0,s.uX)(),(0,s.CE)("div",id,[t[28]||(t[28]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2"},null,-1)),(0,s.Lk)("p",rd,(0,i.v_)(r.errorMessage),1)])):(0,s.Q3)("",!0)])]),r.showNotification?((0,s.uX)(),(0,s.Wv)(c,{key:0,message:r.notificationMessage,type:r.notificationType,onClose:t[10]||(t[10]=e=>r.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(u,{show:r.showDialog,title:r.dialogTitle,message:r.dialogMessage,type:r.dialogType,onConfirm:r.handleConfirm,onCancel:r.handleCancel},null,8,["show","title","message","type","onConfirm","onCancel"])])}const nd={class:"space-y-6"},dd={key:0,class:"flex flex-col gap-6"},cd={class:"relative overflow-hidden rounded-xl border border-light-border bg-white/90 shadow-sm"},ud={class:"overflow-x-auto custom-scrollbar"},gd={class:"w-full"},xd={class:"bg-light-bg border-b border-light-border"},md={class:"py-3 px-4 text-left w-10"},pd=["checked","disabled"],bd={class:"py-3 px-4"},hd=["value","id"],fd=["for"],kd={class:"py-3 px-4 text-sm font-mono text-light-text-primary"},vd={class:"py-3 px-4 text-sm text-light-text-primary"},yd={class:"flex items-center"},Ld={class:"py-3 px-4 text-sm text-light-text-primary"},wd={class:"flex items-center"},Cd={class:"py-3 px-4 text-sm text-light-text-primary"},Rd={class:"px-2 py-1 rounded-md bg-blue-500/10 text-blue-500 border border-blue-500/20 inline-flex items-center"},_d={class:"py-3 px-4"},Td={class:"py-3 px-4"},Sd={class:"flex gap-1 flex-nowrap"},Ed=["onClick"],Wd=["onClick"],Dd=["onClick"],Xd={class:"flex items-center justify-between flex-wrap gap-4 p-4 rounded-xl border border-light-border bg-light-bg"},Pd={class:"flex items-center gap-3"},Ad={class:"text-sm text-light-text-secondary"},Id={class:"text-light-text-primary font-medium"},Fd={class:"flex flex-wrap gap-3"},Kd=["disabled"],jd={key:0},Vd=["disabled"],Md={key:0};function Qd(e,t,l,r,o,n){return(0,s.uX)(),(0,s.CE)("div",nd,[l.pathScanResults?.length>0?((0,s.uX)(),(0,s.CE)("div",dd,[(0,s.Lk)("div",cd,[(0,s.Lk)("div",ud,[(0,s.Lk)("table",gd,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",xd,[(0,s.Lk)("th",md,[(0,s.Lk)("input",{type:"checkbox",onChange:t[0]||(t[0]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e)),checked:r.isAllSelected,class:"checkbox-input",disabled:0===l.pathScanResults.length,id:"select-all-header",title:"全选/取消全选"},null,40,pd),t[4]||(t[4]=(0,s.Lk)("label",{for:"select-all-header",class:"sr-only"},"全选/取消全选",-1))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.tableHeaders,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e.key,class:(0,i.C4)(["py-3 px-4 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider",e.width])},(0,i.v_)(e.label),3)))),128))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.pathScanResults,((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,i.C4)(["border-b border-light-border transition-all duration-200 hover:bg-light-bg/70",l%2===0?"bg-light-bg/50":"bg-white"])},[(0,s.Lk)("td",bd,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedResults=e),value:e.id,class:"checkbox-input",id:`select-result-${e.id}`},null,8,hd),[[a.lH,r.selectedResults]]),(0,s.Lk)("label",{for:`select-result-${e.id}`,class:"sr-only"},"选择此结果",8,fd)]),(0,s.Lk)("td",kd,(0,i.v_)(e.id),1),(0,s.Lk)("td",vd,[(0,s.Lk)("span",yd,[t[5]||(t[5]=(0,s.Lk)("i",{class:"ri-global-line mr-2 text-blue-500"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.target),1)])]),(0,s.Lk)("td",Ld,[(0,s.Lk)("span",wd,[t[6]||(t[6]=(0,s.Lk)("i",{class:"ri-time-line mr-2 text-gray-400"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.formatDate(e.timestamp)),1)])]),(0,s.Lk)("td",Cd,[(0,s.Lk)("span",Rd,[t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-folders-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.getPathCount(e))+" 个 ",1)])]),(0,s.Lk)("td",_d,[(0,s.Lk)("span",{class:(0,i.C4)(["px-2 py-1 rounded-md text-xs font-medium inline-flex items-center",e.is_read?"bg-green-500/10 text-green-600 border border-green-500/30":"bg-yellow-500/10 text-yellow-600 border border-yellow-500/30"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-line":"ri-eye-off-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"已读":"未读"),1)],2)]),(0,s.Lk)("td",Td,[(0,s.Lk)("div",Sd,[(0,s.Lk)("button",{onClick:t=>r.handleViewDetails(e.id),class:"action-button bg-blue-500/10 text-blue-500 border border-blue-500/30 hover:bg-blue-500/20"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"ri-eye-line mr-1"},null,-1),(0,s.eW)(" 查看 ")]),8,Ed),(0,s.Lk)("button",{onClick:t=>r.handleToggleRead(e),class:(0,i.C4)(["action-button",e.is_read?"bg-light-bg text-light-text-primary border border-light-border":"bg-green-500/10 text-green-600 border border-green-500/30 hover:bg-green-500/20"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-off-line":"ri-eye-line","mr-1"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"标为未读":"标为已读"),1)],10,Wd),(0,s.Lk)("button",{onClick:t=>r.handleDelete(e.id),class:"action-button bg-red-500/10 text-red-500 border border-red-500/30 hover:bg-red-500/20"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-1"},null,-1),(0,s.eW)(" 删除 ")]),8,Dd)])])],2)))),128))])])])]),(0,s.Lk)("div",Xd,[(0,s.Lk)("div",Pd,[(0,s.Lk)("span",Ad,[r.hasSelected?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[t[10]||(t[10]=(0,s.eW)(" 已选择 ")),(0,s.Lk)("span",Id,(0,i.v_)(r.selectedResults.length),1),t[11]||(t[11]=(0,s.eW)(" 项 "))],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)(" 请选择要操作的项目 ")],64))])]),(0,s.Lk)("div",Fd,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.handleBatchRead&&r.handleBatchRead(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20":"bg-light-bg-disabled text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[12]||(t[12]=(0,s.Lk)("i",{class:"ri-eye-line mr-2"},null,-1)),t[13]||(t[13]=(0,s.eW)(" 标记已读 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",jd,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,Kd),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.handleBatchDelete&&r.handleBatchDelete(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-red-500/10 text-red-500 border-red-500/30 hover:bg-red-500/20":"bg-light-bg-disabled text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[14]||(t[14]=(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1)),t[15]||(t[15]=(0,s.eW)(" 批量删除 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",Md,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,Vd)])])])):(0,s.Q3)("",!0)])}var $d={name:"PathScanTable",props:{pathScanResults:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["view-details","delete-result","delete-selected","toggle-read-status","mark-selected-read"],setup(e,{emit:t}){const l=(0,o.KR)([]),a=[{key:"id",label:"ID",width:"w-24"},{key:"target",label:"目标地址",width:"w-48"},{key:"timestamp",label:"扫描时间",width:"w-44"},{key:"count",label:"路径数量",width:"w-32"},{key:"status",label:"状态",width:"w-24"},{key:"actions",label:"操作",width:"w-52"}],i=(0,s.EW)((()=>l.value.length>0)),r=(0,s.EW)((()=>!!e.pathScanResults?.length&&l.value.length===e.pathScanResults.length));(0,s.wB)((()=>e.pathScanResults),(()=>{l.value=[]}));const n=()=>{r.value?l.value=[]:l.value=e.pathScanResults.map((e=>e.id))},d=e=>{if(!e)return"-";try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return e||"未知时间"}},c=e=>{if(!e||!e.data||!Array.isArray(e.data))return 0;const t=e.data.find((e=>"paths"===e.Key));return t?.Value?.length||0},u=e=>t("view-details",e),g=e=>t("delete-result",e),x=e=>t("toggle-read-status",e.id,!e.is_read),m=()=>{0!==l.value.length&&t("delete-selected",l.value)},p=()=>{0!==l.value.length&&t("mark-selected-read",l.value)};return{selectedResults:l,tableHeaders:a,hasSelected:i,isAllSelected:r,formatDate:d,getPathCount:c,toggleSelectAll:n,handleViewDetails:u,handleDelete:g,handleToggleRead:x,handleBatchDelete:m,handleBatchRead:p}}};const Nd=(0,g.A)($d,[["render",Qd],["__scopeId","data-v-3f917409"]]);var Bd=Nd,Ud={name:"PathScanResults",components:{PathScanTable:Bd,PopupNotification:m,ConfirmDialog:Yt},setup(){const e=(0,n.rd)(),t=(0,o.KR)([]),l=(0,o.KR)(""),a=(0,o.KR)(""),i=(0,o.KR)(""),r=(0,o.KR)(!1),{showNotification:d,notificationMessage:c,notificationType:u,showSuccess:g,showError:x}=Xe(),{showDialog:m,dialogTitle:p,dialogMessage:b,dialogType:h,confirm:f,handleConfirm:k,handleCancel:v}=el(),y=(0,s.EW)((()=>""!==a.value.trim()||""!==i.value)),L=(0,s.EW)((()=>{if(!t.value||!Array.isArray(t.value))return[];let e=[...t.value];if(a.value.trim()){const t=a.value.toLowerCase().trim();e=e.filter((e=>e.target&&e.target.toLowerCase().includes(t)))}if(""!==i.value){const t="true"===i.value;e=e.filter((e=>e.is_read===t))}return e.sort(((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()))})),w=async()=>{try{r.value=!0,l.value="";const e=await se.get("/results/type/Path");t.value=e.data,g("已刷新扫描结果")}catch(e){l.value="获取扫描结果失败，请重试或联系管理员",x("获取扫描结果失败")}finally{r.value=!1}},C=()=>{r.value=!0,setTimeout((()=>{r.value=!1}),300)},R=()=>{a.value="",i.value="",C()},_=t=>{e.push({name:"PathScanDetail",params:{id:t}})},T=async e=>{try{const t=await f({title:"确认删除",message:"是否确认删除此扫描结果？此操作不可撤销。",type:"danger"});t&&(r.value=!0,await se.delete(`/results/${e}`),await w(),g("已删除扫描结果"))}catch(t){x("删除扫描结果失败"),r.value=!1}},S=async(e,l)=>{try{r.value=!0,await se.put(`/results/${e}/read`,{is_read:l});const a=t.value.findIndex((t=>t.id===e));-1!==a&&(t.value[a].is_read=l),g("已更新状态"),r.value=!1}catch(a){x("更新状态失败"),await w()}},E=async e=>{if(0!==e.length)try{r.value=!0,await Promise.all(e.map((e=>se.put(`/results/${e}/read`,{is_read:!0})))),await w(),g(`已将 ${e.length} 个结果标记为已读`)}catch(t){x("批量标记失败")}finally{r.value=!1}else x("请选择要标记的结果")},W=async e=>{if(0!==e.length)try{const t=await f({title:"批量删除",message:`是否确认删除选中的 ${e.length} 个结果？此操作不可撤销。`,type:"danger"});t&&(r.value=!0,await Promise.all(e.map((e=>se.delete(`/results/${e}`)))),await w(),g(`已删除 ${e.length} 个结果`))}catch(t){x("批量删除失败"),r.value=!1}else x("请选择要删除的结果")};return(0,s.sV)(w),{router:e,pathScanResults:t,errorMessage:l,showNotification:d,notificationMessage:c,notificationType:u,showDialog:m,dialogTitle:p,dialogMessage:b,dialogType:h,searchQuery:a,statusFilter:i,filteredResults:L,isLoading:r,hasActiveFilters:y,handleConfirm:k,handleCancel:v,handleRefreshTasks:w,handleViewDetails:_,handleDeleteResult:T,handleDeleteSelected:W,handleToggleReadStatus:S,handleMarkSelectedRead:E,handleSearch:C,clearFilters:R}}};const Hd=(0,g.A)(Ud,[["render",od],["__scopeId","data-v-7f903264"]]);var zd=Hd;function qd(){const e=(0,n.lq)(),{showSuccess:t,showError:l,showNotification:a,notificationMessage:i,notificationType:r}=Xe(),{showDialog:d,dialogTitle:c,dialogMessage:u,dialogType:g,handleConfirm:x,handleCancel:m}=el(),p=(0,o.KR)(null),b=(0,o.KR)(""),h=(0,o.KR)([]),f=(0,o.KR)(!1),k=(0,o.KR)(!1),v=(0,o.KR)(1),y=(0,o.KR)(10),L=[10,20,50,100],w=async e=>{try{const t=await se.get(`/results/${e}`);p.value=t.data,b.value=""}catch(t){b.value="获取扫描结果详情失败",l("获取扫描结果详情失败")}},C=(0,s.EW)((()=>{if(!p.value?.data)return[];const e=p.value.data.find((e=>"paths"===e.Key));return e?.Value?.length?e.Value.map((e=>({id:e.find((e=>"_id"===e.Key))?.Value||"",path:e.find((e=>"path"===e.Key))?.Value||"",status:e.find((e=>"status"===e.Key))?.Value||"",is_read:e.find((e=>"is_read"===e.Key))?.Value||!1}))):[]})),R=(0,s.EW)((()=>Math.ceil(C.value.length/y.value)||1)),_=(0,s.EW)((()=>{const e=(v.value-1)*y.value,t=e+y.value;return C.value.slice(e,t)})),T=e=>{e<1&&(e=1),e>R.value&&(e=R.value),v.value=e},S=()=>{v.value<R.value&&v.value++},E=()=>{v.value>1&&v.value--},W=e=>{y.value=e,v.value=1},D=()=>{h.value=f.value?C.value.map((e=>e.id)):[]},X=async a=>{try{await se.put(`/results/${e.params.id}/entries/${a.id}/read`,{is_read:!a.is_read}),await w(e.params.id),t("已"+(a.is_read?"标记为未读":"标记为已读"))}catch(s){l("更新状态失败")}},P=async e=>{try{await navigator.clipboard.writeText(e),t("已复制到剪贴板")}catch(a){l("复制失败，请手动复制"),console.error("剪贴板操作失败:",a)}},A=async()=>{if(0!==h.value.length)try{k.value=!0,await new Promise((e=>setTimeout(e,1e3))),t(`已解析 ${h.value.length} 个路径`)}catch(e){l("解析路径失败")}finally{k.value=!1}else l("请选择要解析的路径")},I=e=>{t(`已将路径 ${e.path} 发送到端口扫描`)},F=()=>{0!==h.value.length?t(`已将 ${h.value.length} 个路径发送到端口扫描`):l("请选择要发送的路径")};return{scanResult:p,errorMessage:b,paths:C,selectedPaths:h,selectAll:f,isResolving:k,currentPage:v,pageSize:y,pageSizeOptions:L,fetchScanResult:w,toggleSelectAll:D,toggleReadStatus:X,copyToClipboard:P,resolveSelectedPaths:A,sendToPortScan:I,sendSelectedToPortScan:F,showNotification:a,notificationMessage:i,notificationType:r,showDialog:d,dialogTitle:c,dialogMessage:u,dialogType:g,handleConfirm:x,handleCancel:m,totalPages:R,paginatedPaths:_,goToPage:T,nextPage:S,prevPage:E,changePageSize:W}}const Od={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},Jd={class:"container mx-auto px-6 py-8 flex-1 mt-16"},Gd={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Zd={class:"flex items-center text-sm text-light-text-secondary mb-6"},Yd={class:"bg-light-bg rounded-xl border border-light-border mb-6 overflow-hidden"},ec={class:"p-5 border-b border-light-border flex items-center space-x-3"},tc={class:"text-xl font-medium tracking-wide text-light-text-primary"},lc={class:"grid grid-cols-1 md:grid-cols-3 gap-6 p-5"},ac={class:"flex flex-col"},sc={class:"flex items-center"},ic={class:"text-sm font-mono text-light-text-primary"},rc={class:"flex flex-col"},oc={class:"flex items-center"},nc={class:"text-sm text-light-text-primary"},dc={class:"flex flex-col"},cc={class:"flex items-center"},uc={class:"text-sm text-light-text-primary"},gc={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},xc={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},mc={class:"text-2xl font-medium text-light-text-primary"},pc={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},bc={class:"text-2xl font-medium text-green-600"},hc={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},fc={class:"text-2xl font-medium text-blue-500"},kc={class:"bg-light-bg rounded-xl border border-light-border p-4 flex flex-col"},vc={class:"text-2xl font-medium text-yellow-600"},yc={class:"bg-light-bg rounded-xl border border-light-border p-4 mb-6"},Lc={class:"flex flex-wrap items-center gap-3"},wc={class:"flex items-center mr-2"},Cc={key:0,class:"text-sm text-light-text-secondary"},Rc={class:"flex flex-wrap gap-3 ml-auto"},_c=["disabled"],Tc=["disabled"],Sc={class:"bg-white/90 rounded-xl border border-light-border overflow-hidden mb-4 shadow-sm"},Ec={class:"relative overflow-x-auto custom-scrollbar"},Wc={class:"w-full"},Dc={class:"bg-light-bg border-b border-light-border"},Xc={class:"py-3 px-4 w-10"},Pc=["value"],Ac={class:"py-3 px-4 text-xs font-mono text-light-text-primary w-20"},Ic={class:"py-3 px-4 text-sm text-light-text-primary"},Fc={class:"flex items-center"},Kc=["title"],jc={class:"py-3 px-4 w-20"},Vc={class:"py-3 px-4 text-sm text-light-text-primary w-32"},Mc={class:"py-3 px-4 text-sm text-light-text-primary w-24"},Qc={class:"py-3 px-4 w-20"},$c={class:"py-3 px-4 w-48"},Nc={class:"flex gap-2"},Bc=["onClick"],Uc=["href"],Hc={key:0,class:"mt-4 flex flex-col gap-4"},zc={class:"flex justify-between items-center"},qc={class:"flex items-center space-x-2"},Oc=["value"],Jc={class:"text-sm text-light-text-secondary"},Gc={class:"flex justify-center items-center space-x-2"},Zc=["disabled"],Yc=["disabled"],eu={class:"page-button bg-blue-500/30 text-blue-500 border-blue-500/50"},tu=["disabled"],lu=["disabled"],au={key:1,class:"flex flex-col items-center justify-center py-12 text-center"},su={key:2,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},iu={class:"text-sm text-red-500"};var ru={__name:"PathScanDetail",setup(e){const t=(0,n.lq)(),l=["ID","路径","状态","内容类型","内容长度","读取状态","操作"],{scanResult:r,errorMessage:d,paths:c,selectedPaths:u,selectAll:g,isResolving:x,currentPage:p,pageSize:b,pageSizeOptions:h,totalPages:f,paginatedPaths:k,showNotification:v,notificationMessage:y,notificationType:L,showDialog:w,dialogTitle:R,dialogMessage:_,dialogType:T,fetchScanResult:S,toggleSelectAll:E,toggleReadStatus:W,resolveSelectedPaths:D,sendSelectedToPortScan:X,copyToClipboard:P,goToPage:A,nextPage:I,prevPage:F,changePageSize:K,handleConfirm:j,handleCancel:V}=qd(),M=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return e||"未知时间"}},Q=e=>e?(e=String(e),"200"===e?"bg-green-500/10 text-green-600 border-green-500/30":e.startsWith("3")?"bg-blue-500/10 text-blue-500 border-blue-500/30":e.startsWith("4")?"bg-yellow-500/10 text-yellow-600 border-yellow-500/30":e.startsWith("5")?"bg-red-500/10 text-red-500 border-red-500/30":"bg-gray-500/10 text-gray-500 border-gray-500/30"):"bg-gray-500/10 text-gray-500 border-gray-500/30";return(0,s.sV)((()=>{S(t.params.id)})),(e,t)=>{const n=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",Od,[(0,s.bF)(C),(0,s.Lk)("div",Jd,[(0,s.Lk)("div",Gd,[(0,s.Lk)("div",Zd,[(0,s.bF)(n,{to:"/path-scan-results",class:"hover:text-blue-500 transition-colors flex items-center"},{default:(0,s.k6)((()=>t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-arrow-left-line mr-1"},null,-1),(0,s.eW)(" 返回列表 ")]))),_:1}),t[15]||(t[15]=(0,s.Lk)("i",{class:"ri-arrow-right-s-line mx-2"},null,-1)),t[16]||(t[16]=(0,s.Lk)("span",{class:"text-light-text-primary"},"路径扫描详情",-1))]),(0,s.Lk)("div",Yd,[(0,s.Lk)("div",ec,[t[18]||(t[18]=(0,s.Lk)("div",{class:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center"},[(0,s.Lk)("i",{class:"ri-folders-line text-blue-500 text-xl"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h2",tc,(0,i.v_)((0,o.R1)(r)?.target||"加载中..."),1),t[17]||(t[17]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mt-1"},"路径扫描结果详情",-1))])]),(0,s.Lk)("div",lc,[(0,s.Lk)("div",ac,[t[20]||(t[20]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-fingerprint-line mr-1.5"}),(0,s.eW)(" 扫描ID ")],-1)),(0,s.Lk)("div",sc,[(0,s.Lk)("span",ic,(0,i.v_)((0,o.R1)(r)?.id||"-"),1),(0,o.R1)(r)?.id?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>(0,o.R1)(P)((0,o.R1)(r).id)),class:"ml-2 text-light-text-tertiary hover:text-light-text-secondary transition-colors",title:"复制ID"},t[19]||(t[19]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",rc,[t[22]||(t[22]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-global-line mr-1.5"}),(0,s.eW)(" 目标地址 ")],-1)),(0,s.Lk)("div",oc,[(0,s.Lk)("span",nc,(0,i.v_)((0,o.R1)(r)?.target||"-"),1),(0,o.R1)(r)?.target?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[1]||(t[1]=e=>(0,o.R1)(P)((0,o.R1)(r).target)),class:"ml-2 text-light-text-tertiary hover:text-light-text-secondary transition-colors",title:"复制目标"},t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",dc,[t[23]||(t[23]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-time-line mr-1.5"}),(0,s.eW)(" 扫描时间 ")],-1)),(0,s.Lk)("div",cc,[(0,s.Lk)("span",uc,(0,i.v_)((0,o.R1)(r)?M((0,o.R1)(r).timestamp):"-"),1)])])])]),(0,s.Lk)("div",gc,[(0,s.Lk)("div",xc,[t[24]||(t[24]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"总路径数",-1)),(0,s.Lk)("span",mc,(0,i.v_)((0,o.R1)(c).length),1)]),(0,s.Lk)("div",pc,[t[25]||(t[25]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"可访问路径",-1)),(0,s.Lk)("span",bc,(0,i.v_)((0,o.R1)(c).filter((e=>e.status&&"200"===String(e.status))).length),1)]),(0,s.Lk)("div",hc,[t[26]||(t[26]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"重定向路径",-1)),(0,s.Lk)("span",fc,(0,i.v_)((0,o.R1)(c).filter((e=>e.status&&String(e.status).startsWith("3"))).length),1)]),(0,s.Lk)("div",kc,[t[27]||(t[27]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary mb-1"},"已读状态",-1)),(0,s.Lk)("span",vc,(0,i.v_)((0,o.R1)(c).filter((e=>e.is_read)).length),1)])]),(0,s.Lk)("div",yc,[(0,s.Lk)("div",Lc,[(0,s.Lk)("div",wc,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",onChange:t[2]||(t[2]=(...e)=>(0,o.R1)(E)&&(0,o.R1)(E)(...e)),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.i9)(g)?g.value=e:null),class:"rounded border-light-border bg-white text-blue-500 focus:ring-blue-500/30 mr-2",id:"select-all"},null,544),[[a.lH,(0,o.R1)(g)]]),t[28]||(t[28]=(0,s.Lk)("label",{for:"select-all",class:"text-sm text-light-text-primary cursor-pointer"}," 全选 ",-1))]),(0,o.R1)(u).length>0?((0,s.uX)(),(0,s.CE)("span",Cc," 已选择 "+(0,i.v_)((0,o.R1)(u).length)+" 项 ",1)):(0,s.Q3)("",!0),(0,s.Lk)("div",Rc,[(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>(0,o.R1)(D)&&(0,o.R1)(D)(...e)),disabled:0===(0,o.R1)(u).length||(0,o.R1)(x),class:(0,i.C4)(["tool-button bg-blue-500/10 border-blue-500/30 text-blue-500 hover:bg-blue-500/20",{"opacity-60 cursor-not-allowed":0===(0,o.R1)(u).length||(0,o.R1)(x)}])},[t[29]||(t[29]=(0,s.Lk)("i",{class:"ri-search-eye-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(x)?"正在解析...":"解析选中路径"),1)],10,_c),(0,s.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>(0,o.R1)(X)&&(0,o.R1)(X)(...e)),disabled:0===(0,o.R1)(u).length,class:(0,i.C4)(["tool-button bg-yellow-500/10 border-yellow-500/30 text-yellow-600 hover:bg-yellow-500/20",{"opacity-60 cursor-not-allowed":0===(0,o.R1)(u).length}])},t[30]||(t[30]=[(0,s.Lk)("i",{class:"ri-scan-2-line mr-1.5"},null,-1),(0,s.eW)(" 发送到端口扫描 ")]),10,Tc)])])]),(0,s.Lk)("div",Sc,[(0,s.Lk)("div",Ec,[(0,s.Lk)("table",Wc,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",Dc,[t[31]||(t[31]=(0,s.Lk)("th",{class:"py-3 px-4 text-left"},[(0,s.Lk)("span",{class:"sr-only"},"选择")],-1)),((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(l,(e=>(0,s.Lk)("th",{key:e,class:"py-3 px-4 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider"},(0,i.v_)(e),1))),64))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(k),((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:e._id,class:(0,i.C4)(["border-t border-light-border transition-colors duration-200",[l%2===0?"bg-light-bg/50":"bg-transparent","hover:bg-light-bg/70"]])},[(0,s.Lk)("td",Xc,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>(0,o.i9)(u)?u.value=e:null),value:e._id,class:"rounded border-light-border bg-white text-blue-500 focus:ring-blue-500/30"},null,8,Pc),[[a.lH,(0,o.R1)(u)]])]),(0,s.Lk)("td",Ac,(0,i.v_)(e._id),1),(0,s.Lk)("td",Ic,[(0,s.Lk)("div",Fc,[t[32]||(t[32]=(0,s.Lk)("i",{class:"ri-link mr-2 text-blue-500"},null,-1)),(0,s.Lk)("span",{class:"truncate max-w-md",title:e.path},(0,i.v_)(e.path),9,Kc)])]),(0,s.Lk)("td",jc,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",Q(e.status)])},[t[33]||(t[33]=(0,s.Lk)("i",{class:"ri-checkbox-blank-circle-fill mr-1 text-xs"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.status||"未知"),1)],2)]),(0,s.Lk)("td",Vc,(0,i.v_)(e.content_type||"-"),1),(0,s.Lk)("td",Mc,(0,i.v_)(e.content_length||"-"),1),(0,s.Lk)("td",Qc,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",e.is_read?"bg-green-500/10 text-green-600 border-green-500/30":"bg-yellow-500/10 text-yellow-600 border-yellow-500/30"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-line":"ri-eye-off-line","mr-1"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"已读":"未读"),1)],2)]),(0,s.Lk)("td",$c,[(0,s.Lk)("div",Nc,[(0,s.Lk)("button",{onClick:t=>(0,o.R1)(W)(e),class:(0,i.C4)(["action-button",e.is_read?"bg-light-bg text-light-text-primary border-light-border":"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-off-line":"ri-eye-line"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"标为未读":"标为已读"),1)],10,Bc),(0,s.Lk)("a",{href:e.path,target:"_blank",rel:"noopener noreferrer",class:"action-button bg-blue-500/10 text-blue-500 border-blue-500/30 hover:bg-blue-500/20"},t[34]||(t[34]=[(0,s.Lk)("i",{class:"ri-external-link-line"},null,-1),(0,s.eW)(" 访问 ")]),8,Uc)])])],2)))),128))])])])]),(0,o.R1)(c).length>0?((0,s.uX)(),(0,s.CE)("div",Hc,[(0,s.Lk)("div",zc,[(0,s.Lk)("div",qc,[t[35]||(t[35]=(0,s.Lk)("span",{class:"text-sm text-light-text-secondary"},"每页显示:",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>(0,o.i9)(b)?b.value=e:null),onChange:t[8]||(t[8]=e=>(0,o.R1)(K)((0,o.R1)(b))),class:"bg-white border border-light-border text-light-text-primary text-sm rounded-lg focus:ring-blue-500/30 focus:border-blue-500/50 px-2.5 py-1"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(h),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Oc)))),128))],544),[[a.u1,(0,o.R1)(b)]])]),(0,s.Lk)("div",Jc," 显示 "+(0,i.v_)(0===(0,o.R1)(c).length?0:((0,o.R1)(p)-1)*(0,o.R1)(b)+1)+" - "+(0,i.v_)(Math.min((0,o.R1)(p)*(0,o.R1)(b),(0,o.R1)(c).length))+" 共 "+(0,i.v_)((0,o.R1)(c).length)+" 条 ",1)]),(0,s.Lk)("div",Gc,[(0,s.Lk)("button",{onClick:t[9]||(t[9]=e=>(0,o.R1)(A)(1)),disabled:1===(0,o.R1)(p),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":1===(0,o.R1)(p)}])},t[36]||(t[36]=[(0,s.Lk)("i",{class:"ri-arrow-left-double-line"},null,-1)]),10,Zc),(0,s.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>(0,o.R1)(F)&&(0,o.R1)(F)(...e)),disabled:1===(0,o.R1)(p),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":1===(0,o.R1)(p)}])},t[37]||(t[37]=[(0,s.Lk)("i",{class:"ri-arrow-left-s-line"},null,-1)]),10,Yc),(0,s.Lk)("span",eu,(0,i.v_)((0,o.R1)(p)),1),(0,s.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>(0,o.R1)(I)&&(0,o.R1)(I)(...e)),disabled:(0,o.R1)(p)===(0,o.R1)(f),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":(0,o.R1)(p)===(0,o.R1)(f)}])},t[38]||(t[38]=[(0,s.Lk)("i",{class:"ri-arrow-right-s-line"},null,-1)]),10,tu),(0,s.Lk)("button",{onClick:t[12]||(t[12]=e=>(0,o.R1)(A)((0,o.R1)(f))),disabled:(0,o.R1)(p)===(0,o.R1)(f),class:(0,i.C4)(["page-button",{"opacity-50 cursor-not-allowed":(0,o.R1)(p)===(0,o.R1)(f)}])},t[39]||(t[39]=[(0,s.Lk)("i",{class:"ri-arrow-right-double-line"},null,-1)]),10,lu)])])):(0,s.Q3)("",!0),0!==(0,o.R1)(c).length||(0,o.R1)(d)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",au,t[40]||(t[40]=[(0,s.Lk)("div",{class:"w-16 h-16 rounded-full bg-light-bg flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-link-unlink-m text-light-text-disabled text-3xl"})],-1),(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary mb-2"},"无路径数据",-1),(0,s.Lk)("p",{class:"text-light-text-secondary max-w-md mb-6"}," 该扫描结果中没有发现路径数据，或正在加载中... ",-1)]))),(0,o.R1)(d)?((0,s.uX)(),(0,s.CE)("div",su,[t[41]||(t[41]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2 text-lg"},null,-1)),(0,s.Lk)("p",iu,(0,i.v_)((0,o.R1)(d)),1)])):(0,s.Q3)("",!0)])]),(0,o.R1)(v)?((0,s.uX)(),(0,s.Wv)(m,{key:0,message:(0,o.R1)(y),type:(0,o.R1)(L),onClose:t[13]||(t[13]=e=>v.value=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(Yt,{show:(0,o.R1)(w),title:(0,o.R1)(R),message:(0,o.R1)(_),type:(0,o.R1)(T),onConfirm:(0,o.R1)(j),onCancel:(0,o.R1)(V)},null,8,["show","title","message","type","onConfirm","onCancel"])])}}};const ou=(0,g.A)(ru,[["__scopeId","data-v-21e514ef"]]);var nu=ou;function du(){const{showNotification:e,notificationMessage:t,notificationType:l,showSuccess:a,showError:i}=Xe(),{confirm:r,showDialog:n,dialogTitle:d,dialogMessage:c,dialogType:u,handleConfirm:g,handleCancel:x}=el(),m=(0,o.KR)([]),p=(0,o.KR)(!1),b=(0,o.KR)(!1),h=(0,o.KR)(!1),f=(0,o.KR)("create"),k=(0,o.KR)({name:"",description:"",type:"domain",target:""}),v=async()=>{p.value=!0;try{const e=await se.get("/targets");m.value=Array.isArray(e.data)?e.data:[],a("加载目标列表成功")}catch(e){m.value=[],i("加载目标列表失败")}finally{p.value=!1}},y=()=>{f.value="create",k.value={name:"",description:"",type:"domain",target:""},h.value=!0},L=e=>{console.log("Editing target:",e),f.value="edit",k.value={_id:e._id||e.id,name:e.name,description:e.description||"",type:e.type,target:e.target},h.value=!0},w=async e=>{try{const t=await r({title:"确认删除",message:`是否确认删除目标 "${e.name}"？此操作不可撤销。`,type:"danger"});t&&(await se.delete(`/targets/${e.id}`),await v(),a("删除目标成功"))}catch(t){i("删除目标失败")}},C=async e=>{try{const t="active"===e.status?"archived":"active",l="active"===t?"激活":"归档",s=await r({title:`确认${l}`,message:`是否确认${l}目标 "${e.name}"？`,type:"warning"});if(s){const s={...e,status:t,updatedAt:(new Date).toISOString()};await se.put(`/targets/${e.id}`,s),await v(),a(`${l}目标成功`)}}catch(t){i(("active"===e.status?"归档":"激活")+"目标失败")}},R=async e=>{const t="domain"===e.type?"subfinder":"nmap",l="domain"===e.type?"子域名扫描":"端口扫描";try{const s=await r({title:`开始${l}`,message:`是否对 ${e.name} (${e.target}) 进行${l}？`,type:"info"});if(!s)return;await se.post("/tasks",{type:t,payload:e.target,target_id:e.id}),a(`已发送到${l}`)}catch(s){i(`发送到${l}失败`)}},_=async e=>{if(!b.value){b.value=!0;try{const t={name:e.name,description:e.description,type:e.type,target:e.target,status:"active"};if("create"===f.value)await se.post("/targets",t);else{const e=k.value._id||k.value.id;await se.put(`/targets/${e}`,t)}h.value=!1,await v(),a(("create"===f.value?"创建":"更新")+"目标成功")}catch(t){console.error("Submit error:",t.response?.data||t),i(`${"create"===f.value?"创建":"更新"}目标失败: ${t.response?.data?.message||"未知错误"}`)}finally{b.value=!1}}},T=async e=>{try{await ey.push({name:"TargetDetail",params:{id:e.id||e._id}})}catch(t){i("跳转到详情页面失败")}};return(0,s.sV)((()=>{v()})),{targets:m,isLoading:p,isSubmitting:b,targetForm:k,dialogMode:f,showDialog:h,showNotification:e,notificationMessage:t,notificationType:l,showConfirmDialog:n,dialogTitle:d,dialogMessage:c,dialogType:u,fetchTargets:v,openCreateDialog:y,editTarget:L,deleteTarget:w,archiveTarget:C,startScan:R,submitTargetForm:_,handleConfirm:g,handleCancel:x,viewDetails:T}}const cu={class:"flex min-h-screen items-center justify-center p-4"},uu={class:"flex justify-between items-center mb-6"},gu={class:"flex items-center space-x-2"},xu={class:"text-xl font-semibold text-light-text-primary"},mu={key:1,class:"text-sm text-light-text-tertiary ml-2"},pu={key:0,class:"mt-6"},bu={class:"flex justify-end space-x-4"};var hu={__name:"DialogModal",props:{title:{type:String,required:!0},subtitle:{type:String,default:""},width:{type:String,default:"lg"},closeOnEsc:{type:Boolean,default:!0},closeOnBackdropClick:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0},showIndicator:{type:Boolean,default:!0},indicatorColor:{type:String,default:"blue",validator:e=>["blue","green","red","yellow","purple","gray"].includes(e)},scrollable:{type:Boolean,default:!0},customClass:{type:String,default:""},customDialogClass:{type:String,default:""},initialFocus:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const l=t,r=(0,o.KR)(null),n=e,d=(0,s.EW)((()=>{const e={sm:"w-full max-w-md",md:"w-full max-w-lg",lg:"w-full max-w-xl",xl:"w-full max-w-2xl","2xl":"w-full max-w-3xl","3xl":"w-full max-w-4xl","4xl":"w-full max-w-5xl","5xl":"w-full max-w-6xl",full:"w-full max-w-full mx-4",auto:"w-auto"};return e[n.width]||e.lg})),c=(0,s.EW)((()=>{const e={blue:"bg-blue-500",green:"bg-green-500",red:"bg-red-500",yellow:"bg-yellow-500",purple:"bg-purple-500",gray:"bg-gray-400"};return e[n.indicatorColor]||e.blue})),u=e=>{n.closeOnEsc&&"Escape"===e.key&&l("close")},g=()=>{if(n.initialFocus&&r.value){const e=r.value.querySelector(n.initialFocus);e&&e.focus()}},x=e=>{if("Tab"!==e.key||!r.value)return;const t=r.value.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),l=t[0],a=t[t.length-1];e.shiftKey&&document.activeElement===l?(e.preventDefault(),a.focus()):e.shiftKey||document.activeElement!==a||(e.preventDefault(),l.focus())};return(0,s.sV)((()=>{document.addEventListener("keydown",u),document.addEventListener("keydown",x),document.body.style.overflow="hidden",setTimeout((()=>{g()}),50)})),(0,s.xo)((()=>{document.removeEventListener("keydown",u),document.removeEventListener("keydown",x),document.body.style.overflow=""})),(t,l)=>((0,s.uX)(),(0,s.Wv)(a.eB,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",{class:(0,i.C4)(["fixed inset-0 z-50 overflow-y-auto",e.customClass])},[(0,s.Lk)("div",cu,[(0,s.Lk)("div",{class:"fixed inset-0 bg-black/40 backdrop-blur-sm transition-opacity",onClick:l[0]||(l[0]=l=>e.closeOnBackdropClick?t.$emit("close"):null)}),(0,s.bF)(a.eB,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"translate-y-4 opacity-0 scale-95","enter-to-class":"translate-y-0 opacity-100 scale-100","leave-active-class":"transition ease-in duration-200","leave-from-class":"translate-y-0 opacity-100 scale-100","leave-to-class":"translate-y-4 opacity-0 scale-95"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",{class:(0,i.C4)(["relative bg-white/90 rounded-xl p-6 m-4 shadow-light-card border border-light-border",[d.value,e.customDialogClass]]),ref_key:"dialogRef",ref:r},[(0,s.Lk)("div",uu,[(0,s.Lk)("div",gu,[e.showIndicator?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,i.C4)(["w-2 h-2 rounded-full",c.value])},null,2)):(0,s.Q3)("",!0),(0,s.Lk)("h3",xu,(0,i.v_)(e.title),1),e.subtitle?((0,s.uX)(),(0,s.CE)("span",mu,(0,i.v_)(e.subtitle),1)):(0,s.Q3)("",!0)]),e.showCloseButton?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:l[1]||(l[1]=e=>t.$emit("close")),class:"rounded-lg p-2 hover:bg-light-bg transition-colors duration-200 group","aria-label":"关闭"},l[2]||(l[2]=[(0,s.Lk)("i",{class:"ri-close-line text-light-text-tertiary group-hover:text-light-text-primary transition-colors duration-200"},null,-1)]))):(0,s.Q3)("",!0)]),(0,s.Lk)("div",{class:(0,i.C4)(["mt-4",{"max-h-[70vh] overflow-y-auto custom-scrollbar":e.scrollable}])},[(0,s.RG)(t.$slots,"default")],2),t.$slots.footer||t.$slots.actions?((0,s.uX)(),(0,s.CE)("div",pu,[(0,s.RG)(t.$slots,"footer",{},(()=>[(0,s.Lk)("div",bu,[(0,s.RG)(t.$slots,"actions")])]))])):(0,s.Q3)("",!0)],2)])),_:3})])],2)])),_:3}))}};const fu=(0,g.A)(hu,[["__scopeId","data-v-53bcdbee"]]);var ku=fu;const vu={class:"form-field"},yu={class:"input-wrapper"},Lu={class:"form-field"},wu={class:"flex space-x-4 mt-1"},Cu={class:"form-field"},Ru={class:"form-label"},_u=["placeholder"],Tu={key:0,class:"error-message"},Su={key:1,class:"help-text"},Eu={class:"form-field"},Wu={class:"input-wrapper"},Du={class:"flex justify-between mt-1"},Xu={class:"text-xs text-gray-500"},Pu={class:"flex justify-end space-x-4 mt-8 pt-4 border-t border-gray-700/30"},Au=["disabled"],Iu={key:0,class:"loading-dots"};var Fu={__name:"TargetFormContent",props:{initialData:{type:Object,default:()=>({name:"",type:"domain",target:"",description:""})},isSubmitting:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(e,{emit:t}){const l=e,r=t,n=(0,o.KR)({...l.initialData}),d=(0,o.KR)(""),c=e=>{if(!e)return!1;const t=/^(?!http(s)?:\/\/)((?!-)[A-Za-z0-9-]{1,63}(?<!-)\.)+[A-Za-z]{2,}$/;return t.test(e)},u=e=>{if(!e)return!1;const t=/^(\d{1,3}\.){3}\d{1,3}$/;if(!t.test(e))return!1;const l=e.split(".");return l.every((e=>{const t=parseInt(e,10);return t>=0&&t<=255}))},g=(0,s.EW)((()=>n.value.name?n.value.target?"domain"===n.value.type?{isValid:c(n.value.target),error:"请输入有效的域名格式 (如: example.com)"}:"ip"===n.value.type?{isValid:u(n.value.target),error:"请输入有效的 IPv4 地址格式 (如: 192.168.1.1)"}:{isValid:!0,error:""}:{isValid:!1,error:"请填写目标地址"}:{isValid:!1,error:"请填写目标名称"}));(0,s.wB)((()=>[n.value.target,n.value.type]),(()=>{d.value=g.value.isValid?"":g.value.error}),{immediate:!0});const x=(0,s.EW)((()=>!g.value.isValid)),m=()=>{"domain"===n.value.type&&(n.value.target=n.value.target.replace(/^https?:\/\//i,""))},p=async()=>{if(x.value)return;const e={name:n.value.name.trim(),type:n.value.type,target:n.value.target.trim(),description:n.value.description.trim(),status:"active"};try{r("submit",e)}catch(t){console.error("Form submission error:",t),d.value="提交失败，请重试"}};return(0,s.sV)((()=>{n.value={...l.initialData}})),(t,l)=>((0,s.uX)(),(0,s.CE)("form",{onSubmit:(0,a.D$)(p,["prevent"]),class:"space-y-6"},[(0,s.Lk)("div",vu,[l[7]||(l[7]=(0,s.Lk)("label",{class:"form-label"},[(0,s.Lk)("span",{class:"required-indicator"},"*"),(0,s.eW)(" 目标名称 ")],-1)),(0,s.Lk)("div",yu,[l[6]||(l[6]=(0,s.Lk)("i",{class:"ri-file-text-line input-icon"},null,-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>n.value.name=e),type:"text",placeholder:"请输入目标名称",class:"form-input",required:""},null,512),[[a.Jo,n.value.name]])])]),(0,s.Lk)("div",Lu,[l[12]||(l[12]=(0,s.Lk)("label",{class:"form-label"},[(0,s.Lk)("span",{class:"required-indicator"},"*"),(0,s.eW)(" 目标类型 ")],-1)),(0,s.Lk)("div",wu,[(0,s.Lk)("label",{class:(0,i.C4)(["type-radio-button",{active:"domain"===n.value.type}])},[(0,s.bo)((0,s.Lk)("input",{type:"radio","onUpdate:modelValue":l[1]||(l[1]=e=>n.value.type=e),value:"domain",class:"sr-only"},null,512),[[a.XL,n.value.type]]),l[8]||(l[8]=(0,s.Lk)("i",{class:"ri-global-line mr-2"},null,-1)),l[9]||(l[9]=(0,s.eW)(" 域名 "))],2),(0,s.Lk)("label",{class:(0,i.C4)(["type-radio-button",{active:"ip"===n.value.type}])},[(0,s.bo)((0,s.Lk)("input",{type:"radio","onUpdate:modelValue":l[2]||(l[2]=e=>n.value.type=e),value:"ip",class:"sr-only"},null,512),[[a.XL,n.value.type]]),l[10]||(l[10]=(0,s.Lk)("i",{class:"ri-server-line mr-2"},null,-1)),l[11]||(l[11]=(0,s.eW)(" IP地址 "))],2)])]),(0,s.Lk)("div",Cu,[(0,s.Lk)("label",Ru,[l[13]||(l[13]=(0,s.Lk)("span",{class:"required-indicator"},"*",-1)),(0,s.eW)(" "+(0,i.v_)("domain"===n.value.type?"域名":"IP地址"),1)]),(0,s.Lk)("div",{class:(0,i.C4)(["input-wrapper",{error:d.value}])},[(0,s.Lk)("i",{class:(0,i.C4)(["ri-link input-icon",{"text-red-400":d.value}])},null,2),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>n.value.target=e),type:"text",onInput:m,placeholder:"domain"===n.value.type?"请输入域名（不含 http:// 或 https://）":"请输入IP地址（如 192.168.1.1）",class:(0,i.C4)(["form-input",{"border-red-500/50 focus:ring-red-500/20":d.value}]),required:""},null,42,_u),[[a.Jo,n.value.target]])],2),d.value?((0,s.uX)(),(0,s.CE)("div",Tu,[l[14]||(l[14]=(0,s.Lk)("i",{class:"ri-error-warning-line mr-1"},null,-1)),(0,s.eW)(" "+(0,i.v_)(d.value),1)])):(0,s.Q3)("",!0),d.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("p",Su,[l[15]||(l[15]=(0,s.Lk)("i",{class:"ri-information-line mr-1"},null,-1)),(0,s.eW)(" "+(0,i.v_)("domain"===n.value.type?"请输入不带协议的域名，如: example.com":"请输入有效的IPv4地址，如: 192.168.1.1"),1)]))]),(0,s.Lk)("div",Eu,[l[18]||(l[18]=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)(" 描述 "),(0,s.Lk)("span",{class:"text-gray-500 text-xs ml-1"},"(选填)")],-1)),(0,s.Lk)("div",Wu,[l[16]||(l[16]=(0,s.Lk)("i",{class:"ri-file-list-line input-icon"},null,-1)),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":l[4]||(l[4]=e=>n.value.description=e),rows:"3",placeholder:"请输入目标描述信息，帮助您区分不同目标",class:"form-input py-3"},null,512),[[a.Jo,n.value.description]])]),(0,s.Lk)("div",Du,[l[17]||(l[17]=(0,s.Lk)("p",{class:"help-text"},"详细描述有助于更好地管理目标",-1)),(0,s.Lk)("p",Xu,(0,i.v_)(n.value.description.length)+"/200 ",1)])]),(0,s.Lk)("div",Pu,[(0,s.Lk)("button",{type:"button",onClick:l[5]||(l[5]=e=>t.$emit("cancel")),class:"cancel-button"},l[19]||(l[19]=[(0,s.Lk)("i",{class:"ri-close-line mr-1.5"},null,-1),(0,s.eW)(" 取消 ")])),(0,s.Lk)("button",{type:"submit",disabled:x.value||e.isSubmitting,class:(0,i.C4)(["submit-button",{"opacity-70 cursor-not-allowed":x.value||e.isSubmitting}])},[l[20]||(l[20]=(0,s.Lk)("i",{class:"ri-save-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.isSubmitting?"提交中...":"保存")+" ",1),e.isSubmitting?((0,s.uX)(),(0,s.CE)("span",Iu,"...")):(0,s.Q3)("",!0)],10,Au)])],32))}};const Ku=(0,g.A)(Fu,[["__scopeId","data-v-fdfa219a"]]);var ju=Ku;const Vu={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Mu={class:"mb-8"},Qu={class:"flex justify-between items-center mb-6"},$u={class:"flex items-center"},Nu={class:"ml-4 px-3 py-1.5 rounded-xl bg-gray-700/50 text-gray-200 text-sm"},Bu={class:"flex space-x-4"},Uu=["disabled"],Hu={class:"flex flex-col md:flex-row md:items-center gap-4"},zu={class:"flex-1 relative group"},qu={class:"flex space-x-2"},Ou={class:"flex justify-end mb-6"},Ju={class:"bg-gray-700/50 rounded-lg p-1 flex"},Gu={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Zu={class:"p-5 border-b border-gray-700/30"},Yu={class:"flex justify-between items-start"},eg={class:"text-lg font-medium text-gray-200 mb-1"},tg={class:"text-gray-400 text-xs truncate max-w-xs"},lg={class:"p-5 text-sm space-y-4"},ag={class:"text-gray-400 line-clamp-2 min-h-[40px]"},sg={class:"flex justify-between text-xs text-gray-500"},ig={class:"flex items-center"},rg={class:"flex items-center"},og={class:"grid grid-cols-3 divide-x divide-gray-700/30 border-t border-gray-700/30"},ng=["onClick"],dg=["onClick"],cg={class:"relative group"},ug={class:"dropdown-menu origin-bottom-right"},gg=["onClick"],xg=["onClick"],mg=["onClick"],pg={key:1,class:"overflow-x-auto"},bg={class:"w-full"},hg={class:"table-cell font-medium text-white"},fg={class:"table-cell text-gray-400"},kg={class:"table-cell"},vg={class:"table-cell text-gray-400 text-sm"},yg={class:"table-cell text-gray-400 text-sm"},Lg={class:"table-cell text-right space-x-2"},wg=["onClick"],Cg=["onClick"],Rg=["onClick"],_g=["onClick"],Tg=["onClick"],Sg={key:2,class:"flex flex-col items-center justify-center py-16 my-4 bg-gray-800/20 backdrop-blur-xl rounded-2xl border border-dashed border-gray-700/30"};var Eg={__name:"TargetManagement",setup(e){const{targets:t,isLoading:l,isSubmitting:r,targetForm:n,dialogMode:d,showDialog:c,showNotification:u,showConfirmDialog:g,notificationMessage:x,notificationType:p,dialogTitle:b,dialogMessage:h,dialogType:f,fetchTargets:k,openCreateDialog:v,editTarget:y,deleteTarget:L,archiveTarget:w,startScan:C,submitTargetForm:R,handleConfirm:_,handleCancel:T,viewDetails:S}=du(),E=(0,o.KR)(""),W=(0,o.KR)(""),D=(0,o.KR)("card"),X=(0,s.EW)((()=>{if(!t.value||!Array.isArray(t.value))return[];let e=[...t.value];if(E.value){const t=E.value.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(t)||e.target.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t)))}return W.value&&(e=e.filter((e=>e.status===W.value))),e.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))),e})),P=async()=>{try{await k()}catch(e){console.error("Failed to fetch targets:",e)}},A=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(dt,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",Vu,[(0,s.Lk)("div",Mu,[(0,s.Lk)("div",Qu,[(0,s.Lk)("div",$u,[t[11]||(t[11]=(0,s.Lk)("h2",{class:"text-xl font-medium tracking-wide text-gray-200 flex items-center"},[(0,s.Lk)("i",{class:"ri-focus-3-line mr-2"}),(0,s.eW)(" 目标管理 ")],-1)),(0,s.Lk)("span",Nu," 共 "+(0,i.v_)(X.value.length)+" 个目标 ",1)]),(0,s.Lk)("div",Bu,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>(0,o.R1)(v)&&(0,o.R1)(v)(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-blue-600/70 hover:bg-blue-500/70 text-white transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 flex items-center shadow-lg shadow-blue-900/20"},t[12]||(t[12]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建目标 ")])),(0,s.Lk)("button",{onClick:P,class:(0,i.C4)(["control-button",{"opacity-70 cursor-not-allowed":(0,o.R1)(l)}]),disabled:(0,o.R1)(l)},[(0,s.Lk)("i",{class:(0,i.C4)(["ri-refresh-line mr-2",{"animate-spin":(0,o.R1)(l)}])},null,2),(0,s.eW)(" "+(0,i.v_)((0,o.R1)(l)?"加载中...":"刷新"),1)],10,Uu)])]),(0,s.Lk)("div",Hu,[(0,s.Lk)("div",zu,[t[13]||(t[13]=(0,s.Lk)("i",{class:"ri-search-line absolute left-4 top-3 text-gray-400 group-focus-within:text-blue-400 transition-colors duration-200"},null,-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>E.value=e),type:"text",placeholder:"搜索目标名称、地址或描述...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-gray-700/50 text-gray-100 border border-gray-600/30 focus:border-blue-500/50 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all duration-200"},null,512),[[a.Jo,E.value]])]),(0,s.Lk)("div",qu,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>W.value=""),class:(0,i.C4)(["filter-button",{"filter-active":""===W.value}])}," 全部 ",2),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>W.value="active"),class:(0,i.C4)(["filter-button",{"filter-active":"active"===W.value}])},t[14]||(t[14]=[(0,s.Lk)("span",{class:"w-2 h-2 rounded-full bg-emerald-400 mr-2"},null,-1),(0,s.eW)(" 活跃 ")]),2),(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>W.value="archived"),class:(0,i.C4)(["filter-button",{"filter-active":"archived"===W.value}])},t[15]||(t[15]=[(0,s.Lk)("span",{class:"w-2 h-2 rounded-full bg-gray-400 mr-2"},null,-1),(0,s.eW)(" 已归档 ")]),2)])])]),(0,s.Lk)("div",Ou,[(0,s.Lk)("div",Ju,[(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>D.value="card"),class:(0,i.C4)(["px-3 py-1.5 rounded-md flex items-center text-sm transition-all duration-200","card"===D.value?"bg-gray-600 text-white":"text-gray-400 hover:text-gray-200"])},t[16]||(t[16]=[(0,s.Lk)("i",{class:"ri-layout-grid-fill mr-1.5"},null,-1),(0,s.eW)(" 卡片视图 ")]),2),(0,s.Lk)("button",{onClick:t[6]||(t[6]=e=>D.value="table"),class:(0,i.C4)(["px-3 py-1.5 rounded-md flex items-center text-sm transition-all duration-200","table"===D.value?"bg-gray-600 text-white":"text-gray-400 hover:text-gray-200"])},t[17]||(t[17]=[(0,s.Lk)("i",{class:"ri-table-fill mr-1.5"},null,-1),(0,s.eW)(" 表格视图 ")]),2)])]),"card"===D.value?((0,s.uX)(),(0,s.CE)("div",Gu,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(X.value,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"bg-gray-750 rounded-xl border border-gray-700/50 hover:border-blue-500/30 transition-all duration-300 overflow-hidden shadow-lg hover:shadow-xl transform hover:-translate-y-1"},[(0,s.Lk)("div",Zu,[(0,s.Lk)("div",Yu,[(0,s.Lk)("div",null,[(0,s.Lk)("h3",eg,(0,i.v_)(e.name),1),(0,s.Lk)("div",tg,(0,i.v_)(e.target),1)]),(0,s.Lk)("div",{class:(0,i.C4)(["status-indicator","active"===e.status?"active":"archived"])},(0,i.v_)("active"===e.status?"活跃":"已归档"),3)])]),(0,s.Lk)("div",lg,[(0,s.Lk)("p",ag,(0,i.v_)(e.description||"无描述信息"),1),(0,s.Lk)("div",sg,[(0,s.Lk)("div",ig,[t[18]||(t[18]=(0,s.Lk)("i",{class:"ri-time-line mr-1"},null,-1)),(0,s.eW)(" 创建: "+(0,i.v_)(A(e.createdAt)),1)]),(0,s.Lk)("div",rg,[t[19]||(t[19]=(0,s.Lk)("i",{class:"ri-refresh-line mr-1"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.updatedAt?A(e.updatedAt):"未扫描"),1)])])]),(0,s.Lk)("div",og,[(0,s.Lk)("button",{onClick:t=>(0,o.R1)(S)(e),class:"card-action-button"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-file-list-line mr-1"},null,-1),(0,s.eW)(" 详情 ")]),8,ng),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(C)(e),class:"card-action-button text-green-400"},t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-scan-line mr-1"},null,-1),(0,s.eW)(" 扫描 ")]),8,dg),(0,s.Lk)("div",cg,[t[25]||(t[25]=(0,s.Lk)("button",{class:"card-action-button text-gray-400 w-full"},[(0,s.Lk)("i",{class:"ri-more-2-fill"})],-1)),(0,s.Lk)("div",ug,[(0,s.Lk)("button",{onClick:t=>(0,o.R1)(y)(e),class:"dropdown-item"},t[22]||(t[22]=[(0,s.Lk)("i",{class:"ri-edit-line mr-2 text-blue-400"},null,-1),(0,s.eW)(" 编辑 ")]),8,gg),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(w)(e),class:"dropdown-item"},[t[23]||(t[23]=(0,s.Lk)("i",{class:"ri-archive-line mr-2 text-yellow-400"},null,-1)),(0,s.eW)(" "+(0,i.v_)("active"===e.status?"归档":"激活"),1)],8,xg),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(L)(e),class:"dropdown-item text-red-400 border-t border-gray-700/30"},t[24]||(t[24]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1),(0,s.eW)(" 删除 ")]),8,mg)])])])])))),128))])):"table"===D.value?((0,s.uX)(),(0,s.CE)("div",pg,[(0,s.Lk)("table",bg,[t[31]||(t[31]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{class:"bg-gray-750"},[(0,s.Lk)("th",{class:"table-header"},"目标名称"),(0,s.Lk)("th",{class:"table-header"},"目标地址"),(0,s.Lk)("th",{class:"table-header"},"状态"),(0,s.Lk)("th",{class:"table-header"},"创建时间"),(0,s.Lk)("th",{class:"table-header"},"上次更新"),(0,s.Lk)("th",{class:"table-header text-right"},"操作")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(X.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:"border-b border-gray-700/20 hover:bg-gray-800/30 transition-colors duration-150"},[(0,s.Lk)("td",hg,(0,i.v_)(e.name),1),(0,s.Lk)("td",fg,(0,i.v_)(e.target),1),(0,s.Lk)("td",kg,[(0,s.Lk)("span",{class:(0,i.C4)(["status-indicator","active"===e.status?"active":"archived"])},(0,i.v_)("active"===e.status?"活跃":"已归档"),3)]),(0,s.Lk)("td",vg,(0,i.v_)(A(e.createdAt)),1),(0,s.Lk)("td",yg,(0,i.v_)(e.updatedAt?A(e.updatedAt):"未扫描"),1),(0,s.Lk)("td",Lg,[(0,s.Lk)("button",{onClick:t=>(0,o.R1)(S)(e),class:"table-action-button bg-gray-700 hover:bg-gray-600",title:"查看详情"},t[26]||(t[26]=[(0,s.Lk)("i",{class:"ri-file-list-line"},null,-1)]),8,wg),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(C)(e),class:"table-action-button bg-green-700/50 hover:bg-green-600/50 text-green-100",title:"开始扫描"},t[27]||(t[27]=[(0,s.Lk)("i",{class:"ri-scan-line"},null,-1)]),8,Cg),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(y)(e),class:"table-action-button bg-blue-700/50 hover:bg-blue-600/50 text-blue-100",title:"编辑目标"},t[28]||(t[28]=[(0,s.Lk)("i",{class:"ri-edit-line"},null,-1)]),8,Rg),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(w)(e),class:"table-action-button bg-yellow-700/50 hover:bg-yellow-600/50 text-yellow-100",title:"归档/激活"},t[29]||(t[29]=[(0,s.Lk)("i",{class:"ri-archive-line"},null,-1)]),8,_g),(0,s.Lk)("button",{onClick:t=>(0,o.R1)(L)(e),class:"table-action-button bg-red-700/50 hover:bg-red-600/50 text-red-100",title:"删除目标"},t[30]||(t[30]=[(0,s.Lk)("i",{class:"ri-delete-bin-line"},null,-1)]),8,Tg)])])))),128))])])])):(0,s.Q3)("",!0),0===X.value.length?((0,s.uX)(),(0,s.CE)("div",Sg,[t[33]||(t[33]=(0,s.Lk)("div",{class:"empty-illustration mb-6"},[(0,s.Lk)("i",{class:"ri-radar-line text-5xl text-gray-700 animate-pulse"})],-1)),t[34]||(t[34]=(0,s.Lk)("span",{class:"text-xl text-gray-300 mb-3"},"暂无目标数据",-1)),t[35]||(t[35]=(0,s.Lk)("p",{class:"text-gray-500 mb-6 text-center max-w-md"}," 创建你的第一个目标开始使用系统的全部功能 ",-1)),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>(0,o.R1)(v)&&(0,o.R1)(v)(...e)),class:"px-6 py-3 rounded-xl text-sm font-medium bg-blue-600/70 hover:bg-blue-500/70 text-white transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500/50 flex items-center shadow-lg"},t[32]||(t[32]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 创建第一个目标 ")]))])):(0,s.Q3)("",!0)]),(0,o.R1)(u)?((0,s.uX)(),(0,s.Wv)(m,{key:0,message:(0,o.R1)(x),type:(0,o.R1)(p),onClose:t[8]||(t[8]=e=>u.value=!1)},null,8,["message","type"])):(0,s.Q3)("",!0)])),_:1}),(0,o.R1)(c)?((0,s.uX)(),(0,s.Wv)(ku,{key:0,title:"create"===(0,o.R1)(d)?"新建目标":"编辑目标",onClose:t[10]||(t[10]=e=>c.value=!1),class:"bg-gray-800/40 backdrop-blur-xl rounded-2xl border border-gray-700/30"},{default:(0,s.k6)((()=>[(0,s.bF)(ju,{"initial-data":(0,o.R1)(n),"is-submitting":(0,o.R1)(r),onSubmit:(0,o.R1)(R),onCancel:t[9]||(t[9]=e=>c.value=!1)},null,8,["initial-data","is-submitting","onSubmit"])])),_:1},8,["title"])):(0,s.Q3)("",!0),(0,s.bF)(Yt,{show:(0,o.R1)(g),title:(0,o.R1)(b),message:(0,o.R1)(h),type:(0,o.R1)(f),onConfirm:(0,o.R1)(_),onCancel:(0,o.R1)(T)},null,8,["show","title","message","type","onConfirm","onCancel"])],64))}};const Wg=(0,g.A)(Eg,[["__scopeId","data-v-facdc51a"]]);var Dg=Wg;const Xg={class:"bg-gray-900 text-white flex flex-col min-h-screen"},Pg={class:"container mx-auto px-6 py-8 flex-1 mt-16"},Ag={class:"flex justify-between items-center mb-6"},Ig={class:"flex items-center"},Fg={class:"flex space-x-3"},Kg=["disabled"],jg={class:"info-card mb-6"},Vg={class:"flex flex-col md:flex-row md:items-start md:justify-between gap-4"},Mg={class:"flex-1"},Qg={class:"flex items-center gap-3 mb-3"},$g={class:"text-xl font-semibold text-gray-100"},Ng={class:"flex items-center mt-1"},Bg={class:"text-sm text-gray-500 ml-3"},Ug={class:"text-gray-400 mt-2 mb-4"},Hg={class:"bg-gray-800/50 rounded-xl p-4 md:min-w-[300px]"},zg={class:"space-y-3"},qg={class:"flex items-center"},Og={class:"text-gray-200"},Jg={class:"flex items-center"},Gg={class:"text-gray-200 flex-1 font-mono overflow-hidden text-ellipsis"},Zg={class:"flex items-center"},Yg={class:"text-gray-200"},ex={class:"flex items-center"},tx={class:"text-gray-400 font-mono text-sm"},lx={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6"},ax={class:"flex items-center"},sx={class:"text-sm text-gray-400"},ix={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},rx={class:"chart-card"},ox={class:"flex items-center justify-between mb-4"},nx={class:"bg-gray-800/70 text-xs text-gray-400 px-2.5 py-1 rounded-lg"},dx={class:"chart-container"},cx={key:1,class:"empty-chart"},ux={class:"chart-card"},gx={class:"chart-container"},xx={key:1,class:"empty-chart"};function mx(e,t,l,a,r,o){const n=(0,s.g2)("HeaderPage"),d=(0,s.g2)("Bar"),c=(0,s.g2)("Pie"),u=(0,s.g2)("FooterPage");return(0,s.uX)(),(0,s.CE)("div",Xg,[(0,s.bF)(n),(0,s.Lk)("div",Pg,[(0,s.Lk)("div",Ag,[(0,s.Lk)("div",Ig,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.goBack&&a.goBack(...e)),class:"mr-4 p-2 rounded-lg bg-gray-800/50 hover:bg-gray-700/50 transition-all duration-200",title:"返回"},t[3]||(t[3]=[(0,s.Lk)("i",{class:"ri-arrow-left-line text-lg"},null,-1)])),t[4]||(t[4]=(0,s.Lk)("h1",{class:"text-xl font-medium text-gray-100"},"目标详情",-1))]),(0,s.Lk)("div",Fg,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.refreshDetails&&a.refreshDetails(...e)),class:(0,i.C4)(["action-button bg-gray-700/50 hover:bg-gray-600/50",{"opacity-50 cursor-wait":a.isLoading}]),disabled:a.isLoading},[(0,s.Lk)("i",{class:(0,i.C4)(["ri-refresh-line mr-1.5",{"animate-spin":a.isLoading}])},null,2),t[5]||(t[5]=(0,s.eW)(" 刷新 "))],10,Kg),t[6]||(t[6]=(0,s.Lk)("button",{class:"action-button bg-blue-600/50 hover:bg-blue-500/50"},[(0,s.Lk)("i",{class:"ri-scan-line mr-1.5"}),(0,s.eW)(" 扫描 ")],-1))])]),(0,s.Lk)("div",jg,[(0,s.Lk)("div",Vg,[(0,s.Lk)("div",Mg,[(0,s.Lk)("div",Qg,[t[8]||(t[8]=(0,s.Lk)("div",{class:"flex items-center justify-center w-10 h-10 rounded-xl bg-gray-700/50"},[(0,s.Lk)("i",{class:"ri-focus-3-line text-xl text-blue-400"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h2",$g,(0,i.v_)(a.details?.name||"加载中..."),1),(0,s.Lk)("div",Ng,[(0,s.Lk)("span",{class:(0,i.C4)(["status-badge",a.getStatusStyle(a.details?.status)])},(0,i.v_)(a.getStatusText(a.details?.status)),3),(0,s.Lk)("span",Bg,[t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-time-line mr-1"},null,-1)),(0,s.eW)(" "+(0,i.v_)(a.formatTimeAgo(a.details?.createdAt))+"创建 ",1)])])])]),(0,s.Lk)("p",Ug,(0,i.v_)(a.details?.description||"暂无描述"),1)]),(0,s.Lk)("div",Hg,[t[14]||(t[14]=(0,s.Lk)("h3",{class:"text-sm font-medium text-gray-400 mb-3 flex items-center"},[(0,s.Lk)("i",{class:"ri-information-line mr-1.5"}),(0,s.eW)(" 目标信息 ")],-1)),(0,s.Lk)("div",zg,[(0,s.Lk)("div",qg,[t[9]||(t[9]=(0,s.Lk)("span",{class:"text-gray-500 text-sm w-20"},"目标类型:",-1)),(0,s.Lk)("span",Og,(0,i.v_)("domain"===a.details?.type?"域名":"IP地址"),1)]),(0,s.Lk)("div",Jg,[t[11]||(t[11]=(0,s.Lk)("span",{class:"text-gray-500 text-sm w-20"},"目标地址:",-1)),(0,s.Lk)("span",Gg,(0,i.v_)(a.details?.target||"-"),1),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>a.copyToClipboard(a.details?.target)),class:"text-gray-400 hover:text-blue-400 ml-2",title:"复制"},t[10]||(t[10]=[(0,s.Lk)("i",{class:"ri-clipboard-line"},null,-1)]))]),(0,s.Lk)("div",Zg,[t[12]||(t[12]=(0,s.Lk)("span",{class:"text-gray-500 text-sm w-20"},"更新时间:",-1)),(0,s.Lk)("span",Yg,(0,i.v_)(a.formatDate(a.details?.updatedAt)),1)]),(0,s.Lk)("div",ex,[t[13]||(t[13]=(0,s.Lk)("span",{class:"text-gray-500 text-sm w-20"},"目标ID:",-1)),(0,s.Lk)("span",tx,(0,i.v_)(a.details?.id||"-"),1)])])])])]),(0,s.Lk)("div",lx,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.statistics,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.title,class:(0,i.C4)(["stat-card",`border-${e.color}-900/30 hover:border-${e.color}-800/30`])},[(0,s.Lk)("div",ax,[(0,s.Lk)("div",{class:(0,i.C4)(["flex items-center justify-center w-12 h-12 rounded-xl mr-4",`bg-${e.color}-900/30 text-${e.color}-400`])},[(0,s.Lk)("i",{class:(0,i.C4)(`${e.icon} text-xl`)},null,2)],2),(0,s.Lk)("div",null,[(0,s.Lk)("h3",{class:(0,i.C4)(["text-2xl font-bold",`text-${e.color}-400`])},(0,i.v_)(e.value),3),(0,s.Lk)("p",sx,(0,i.v_)(e.title),1)])])],2)))),128))]),(0,s.Lk)("div",ix,[(0,s.Lk)("div",rx,[(0,s.Lk)("div",ox,[t[15]||(t[15]=(0,s.Lk)("h3",{class:"chart-title"},[(0,s.Lk)("i",{class:"ri-door-line mr-1.5"}),(0,s.eW)(" 端口分布 ")],-1)),(0,s.Lk)("div",nx," 显示前 "+(0,i.v_)(a.portChartData.labels.length||0)+" 个 ",1)]),(0,s.Lk)("div",dx,[a.portChartData.datasets[0].data.length>0?((0,s.uX)(),(0,s.Wv)(d,{key:0,data:a.portChartData,options:a.portChartOptions},null,8,["data","options"])):((0,s.uX)(),(0,s.CE)("div",cx,t[16]||(t[16]=[(0,s.Lk)("i",{class:"ri-bar-chart-grouped-line text-4xl text-gray-700 mb-3"},null,-1),(0,s.Lk)("p",null,"暂无端口数据",-1)])))])]),(0,s.Lk)("div",ux,[t[18]||(t[18]=(0,s.Lk)("div",{class:"flex items-center justify-between mb-4"},[(0,s.Lk)("h3",{class:"chart-title"},[(0,s.Lk)("i",{class:"ri-http-fill mr-1.5"}),(0,s.eW)(" HTTP状态码分布 ")])],-1)),(0,s.Lk)("div",gx,[a.httpStatusChartData.datasets[0].data.length>0?((0,s.uX)(),(0,s.Wv)(c,{key:0,data:a.httpStatusChartData,options:a.httpStatusChartOptions},null,8,["data","options"])):((0,s.uX)(),(0,s.CE)("div",xx,t[17]||(t[17]=[(0,s.Lk)("i",{class:"ri-pie-chart-line text-4xl text-gray-700 mb-3"},null,-1),(0,s.Lk)("p",null,"暂无HTTP状态码数据",-1)])))])])]),t[19]||(t[19]=(0,s.Fv)('<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6" data-v-3a6348ee><div class="info-card flex flex-col items-center justify-center py-6 hover:bg-gray-800/50 transition-colors duration-200 group cursor-pointer" data-v-3a6348ee><div class="w-14 h-14 flex items-center justify-center rounded-full bg-purple-900/30 text-purple-400 mb-3 group-hover:scale-110 transition-transform duration-200" data-v-3a6348ee><i class="ri-folder-chart-line text-2xl" data-v-3a6348ee></i></div><h3 class="text-lg font-medium text-gray-200 mb-1" data-v-3a6348ee>子域名报告</h3><p class="text-sm text-gray-500" data-v-3a6348ee>查看子域名扫描发现的详细结果</p></div><div class="info-card flex flex-col items-center justify-center py-6 hover:bg-gray-800/50 transition-colors duration-200 group cursor-pointer" data-v-3a6348ee><div class="w-14 h-14 flex items-center justify-center rounded-full bg-green-900/30 text-green-400 mb-3 group-hover:scale-110 transition-transform duration-200" data-v-3a6348ee><i class="ri-database-2-line text-2xl" data-v-3a6348ee></i></div><h3 class="text-lg font-medium text-gray-200 mb-1" data-v-3a6348ee>端口服务详情</h3><p class="text-sm text-gray-500" data-v-3a6348ee>查看开放的端口和服务详细信息</p></div><div class="info-card flex flex-col items-center justify-center py-6 hover:bg-gray-800/50 transition-colors duration-200 group cursor-pointer" data-v-3a6348ee><div class="w-14 h-14 flex items-center justify-center rounded-full bg-red-900/30 text-red-400 mb-3 group-hover:scale-110 transition-transform duration-200" data-v-3a6348ee><i class="ri-bug-line text-2xl" data-v-3a6348ee></i></div><h3 class="text-lg font-medium text-gray-200 mb-1" data-v-3a6348ee>漏洞分析</h3><p class="text-sm text-gray-500" data-v-3a6348ee>查看已发现的安全漏洞和风险</p></div></div>',1))]),(0,s.bF)(u),a.showCopyNotification?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,i.C4)(["fixed bottom-8 right-8 bg-gray-800 text-gray-200 py-2 px-4 rounded-lg shadow-lg flex items-center transition-opacity duration-300",{"opacity-100":a.showCopyNotification,"opacity-0":!a.showCopyNotification}])},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-check-line mr-2 text-green-400"},null,-1),(0,s.eW)(" 已复制到剪贴板 ")]),2)):(0,s.Q3)("",!0)])}const px={class:"bg-white/80 backdrop-blur-md text-light-text-secondary border-t border-light-border py-6"};var bx={__name:"FooterPage",setup(e){return(e,t)=>((0,s.uX)(),(0,s.CE)("footer",px,t[0]||(t[0]=[(0,s.Fv)('<div class="container mx-auto px-6 flex flex-col items-center justify-center" data-v-ca673d8a><div class="flex flex-col items-center space-y-2 text-center" data-v-ca673d8a><h3 class="text-sm font-medium text-light-text-primary mb-2" data-v-ca673d8a>© 2025 YangMiee 攻击面梳理平台</h3><p class="text-xs" data-v-ca673d8a> 我们致力于为安全团队提供高效、易用的攻击面梳理工具 </p><div class="flex items-center space-x-4 mt-2" data-v-ca673d8a><a href="#" class="text-light-text-secondary hover:text-primary transition-colors duration-300" data-v-ca673d8a><i class="ri-github-fill text-lg" data-v-ca673d8a></i></a><a href="#" class="text-light-text-secondary hover:text-primary transition-colors duration-300" data-v-ca673d8a><i class="ri-twitter-x-fill text-lg" data-v-ca673d8a></i></a><a href="#" class="text-light-text-secondary hover:text-primary transition-colors duration-300" data-v-ca673d8a><i class="ri-mail-fill text-lg" data-v-ca673d8a></i></a></div></div></div>',1)])))}};const hx=(0,g.A)(bx,[["__scopeId","data-v-ca673d8a"]]);var fx=hx,kx=l(1010),vx=l(6912);vx.t1.register(vx.hE,vx.m_,vx.s$,vx.E8,vx.PP,vx.kc,vx.Bs);var yx={name:"TargetDetail",components:{HeaderPage:C,FooterPage:fx,Bar:kx.yP,Pie:kx.Fq},setup(){const e=(0,n.lq)(),t=(0,n.rd)(),l=(0,o.KR)(null),a=(0,o.KR)(!1),i=(0,o.KR)(!1),{showError:r,showSuccess:d}=Xe(),c=(0,s.EW)((()=>l.value?.target||{})),u=(0,s.EW)((()=>l.value?.stats||{})),g=(0,s.EW)((()=>[{title:"子域名数量",value:u.value.subdomain_count||0,icon:"ri-global-line",color:"blue"},{title:"端口数量",value:u.value.port_count||0,icon:"ri-door-open-line",color:"green"},{title:"路径数量",value:u.value.path_count||0,icon:"ri-route-line",color:"purple"},{title:"漏洞数量",value:u.value.vulnerability_count||0,icon:"ri-bug-line",color:"red"}])),x=async()=>{try{a.value=!0;const t=await se.get(`/targets/${e.params.id}/details`);l.value=t.data}catch(t){r("获取目标详情失败"),console.error("获取目标详情失败:",t)}finally{a.value=!1}},m=async()=>{await x(),d("数据已刷新")},p=()=>{t.go(-1)},b=e=>{e&&navigator.clipboard.writeText(e).then((()=>{i.value=!0,setTimeout((()=>{i.value=!1}),2e3)}))},h=e=>e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"未知",f=e=>{if(!e)return"";const t=new Date,l=new Date(e),a=Math.floor((t-l)/1e3);return a<60?"刚刚":a<3600?`${Math.floor(a/60)}分钟前`:a<86400?`${Math.floor(a/3600)}小时前`:a<2592e3?`${Math.floor(a/86400)}天前`:`${l.getFullYear()}年${l.getMonth()+1}月${l.getDate()}日`},k=e=>{const t={active:"活跃",archived:"已归档"};return t[e]||"未知"},v=e=>{const t={active:"bg-green-900/30 text-green-400 border-green-700/30",archived:"bg-gray-800/30 text-gray-400 border-gray-700/30"};return t[e]||"bg-gray-800/30 text-gray-400 border-gray-700/30"},y={backgrounds:["rgba(59, 130, 246, 0.3)","rgba(34, 197, 94, 0.3)","rgba(239, 68, 68, 0.3)","rgba(168, 85, 247, 0.3)","rgba(234, 179, 8, 0.3)","rgba(14, 165, 233, 0.3)","rgba(249, 115, 22, 0.3)","rgba(236, 72, 153, 0.3)","rgba(45, 212, 191, 0.3)","rgba(139, 92, 246, 0.3)"],borders:["rgb(59, 130, 246)","rgb(34, 197, 94)","rgb(239, 68, 68)","rgb(168, 85, 247)","rgb(234, 179, 8)","rgb(14, 165, 233)","rgb(249, 115, 22)","rgb(236, 72, 153)","rgb(45, 212, 191)","rgb(139, 92, 246)"]},L=(0,s.EW)((()=>({labels:u.value.top_ports?.map((e=>`端口 ${e.port}`))||[],datasets:[{label:"端口数量",data:u.value.top_ports?.map((e=>e.count))||[],backgroundColor:y.backgrounds,borderColor:y.borders,borderWidth:1}]}))),w={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(31, 41, 55, 0.8)",titleColor:"rgb(209, 213, 219)",bodyColor:"rgb(229, 231, 235)",borderColor:"rgba(75, 85, 99, 0.3)",borderWidth:1,padding:10,boxPadding:5,callbacks:{label:function(e){return`数量: ${e.raw}`}}}},scales:{y:{beginAtZero:!0,ticks:{color:"rgba(156, 163, 175, 0.8)",font:{size:11}},grid:{color:"rgba(75, 85, 99, 0.15)",drawBorder:!1}},x:{ticks:{color:"rgba(156, 163, 175, 0.8)",maxRotation:45,minRotation:45,font:{size:11}},grid:{display:!1,drawBorder:!1}}}},C=(0,s.EW)((()=>({labels:u.value.http_status_stats?.map((e=>e.label))||[],datasets:[{data:u.value.http_status_stats?.map((e=>e.count))||[],backgroundColor:["rgba(239, 68, 68, 0.7)","rgba(234, 179, 8, 0.7)","rgba(59, 130, 246, 0.7)","rgba(34, 197, 94, 0.7)","rgba(168, 85, 247, 0.7)","rgba(107, 114, 128, 0.7)"],borderColor:["rgb(239, 68, 68)","rgb(234, 179, 8)","rgb(59, 130, 246)","rgb(34, 197, 94)","rgb(168, 85, 247)","rgb(107, 114, 128)"],borderWidth:1}]}))),R={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"rgba(156, 163, 175, 0.8)",usePointStyle:!0,padding:15,font:{size:11}}},tooltip:{backgroundColor:"rgba(31, 41, 55, 0.8)",titleColor:"rgb(209, 213, 219)",bodyColor:"rgb(229, 231, 235)",borderColor:"rgba(75, 85, 99, 0.3)",borderWidth:1,padding:10,boxPadding:5}}};return(0,s.sV)((()=>{x()})),{details:c,statistics:g,isLoading:a,showCopyNotification:i,formatDate:h,formatTimeAgo:f,getStatusText:k,getStatusStyle:v,portChartData:L,portChartOptions:w,httpStatusChartData:C,httpStatusChartOptions:R,refreshDetails:m,goBack:p,copyToClipboard:b}}};const Lx=(0,g.A)(yx,[["render",mx],["__scopeId","data-v-3a6348ee"]]);var wx=Lx;const Cx={class:"min-h-screen bg-light-gradient flex flex-col items-center justify-center p-6 relative overflow-hidden"},Rx={class:"bg-white/70 backdrop-blur-xl p-10 rounded-2xl shadow-light-card border border-light-border max-w-2xl w-full relative z-10"},_x={class:"space-y-8"},Tx={class:"flex justify-center pt-6"};function Sx(e,t,l,a,i,r){const o=(0,s.g2)("PopupNotification");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Cx,[t[4]||(t[4]=(0,s.Lk)("div",{class:"absolute inset-0 overflow-hidden"},[(0,s.Lk)("div",{class:"gear-large"}),(0,s.Lk)("div",{class:"gear-small"}),(0,s.Lk)("div",{class:"code-block"})],-1)),(0,s.Lk)("div",Rx,[(0,s.Lk)("div",_x,[t[3]||(t[3]=(0,s.Fv)('<div class="space-y-4 text-center" data-v-6bce4fe5><div class="inline-flex items-center justify-center w-20 h-20 bg-light-bg rounded-2xl mx-auto overflow-hidden border border-light-border shadow-inner group" data-v-6bce4fe5><span class="text-3xl animate-bounce-slow" data-v-6bce4fe5>🚧</span></div><h1 class="text-2xl font-medium tracking-wide text-light-text-primary" data-v-6bce4fe5> 功能开发中 </h1></div><p class="text-sm text-light-text-secondary leading-relaxed text-center max-w-md mx-auto" data-v-6bce4fe5> 该功能正在开发中，我们正在努力完善这项服务。 <br data-v-6bce4fe5>感谢您的耐心等待，敬请期待！ </p><div class="space-y-3 max-w-md mx-auto" data-v-6bce4fe5><div class="flex justify-between text-xs text-light-text-tertiary px-1" data-v-6bce4fe5><span data-v-6bce4fe5>开发阶段</span><span data-v-6bce4fe5>75%</span></div><div class="w-full bg-light-bg rounded-full h-2 overflow-hidden shadow-inner" data-v-6bce4fe5><div class="progress-bar h-2 rounded-full" data-v-6bce4fe5></div></div><div class="flex justify-between text-xs text-light-text-tertiary mt-2" data-v-6bce4fe5><span data-v-6bce4fe5>计划</span><span data-v-6bce4fe5>设计</span><span data-v-6bce4fe5>开发</span><span data-v-6bce4fe5>测试</span><span data-v-6bce4fe5>发布</span></div></div>',3)),(0,s.Lk)("div",Tx,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.handleReturn&&a.handleReturn(...e)),class:"return-button px-6 py-2.5 rounded-xl text-sm font-medium bg-blue-500 hover:bg-blue-600 text-white transition-all duration-300 focus:outline-none border border-blue-600/30 hover:border-blue-700/50 group shadow-sm"},t[2]||(t[2]=[(0,s.Lk)("span",{class:"relative z-10 flex items-center"},[(0,s.Lk)("i",{class:"ri-arrow-left-line mr-2 transition-transform duration-300 group-hover:-translate-x-1"}),(0,s.eW)(" 返回上一页 ")],-1)]))])])]),t[5]||(t[5]=(0,s.Lk)("p",{class:"mt-8 text-xs text-light-text-tertiary relative z-10"},[(0,s.eW)(" 如有建议或问题，请 "),(0,s.Lk)("a",{href:"#",class:"text-blue-500 hover:text-blue-600 underline underline-offset-2"},"与我们联系")],-1))]),a.showNotification?((0,s.uX)(),(0,s.Wv)(o,{key:0,message:a.notificationMessage,type:a.notificationType,onClose:t[1]||(t[1]=e=>a.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0)],64)}var Ex={name:"UnderDevelopment",components:{PopupNotification:m},setup(){const e=(0,n.rd)(),{showNotification:t,notificationMessage:l,notificationType:a,showSuccess:s}=Xe(),i=()=>{s("正在返回上一页"),e.go(-1)};return{showNotification:t,notificationMessage:l,notificationType:a,handleReturn:i}}};const Wx=(0,g.A)(Ex,[["render",Sx],["__scopeId","data-v-6bce4fe5"]]);var Dx=Wx;const Xx={class:"flex gap-4 mb-6"},Px={class:"bg-white/70 backdrop-blur-xl p-4 rounded-xl border border-light-border flex-1 flex items-center justify-between shadow-light-card"},Ax={class:"flex items-center"},Ix={class:"text-xl font-medium text-light-text-primary"},Fx={class:"bg-white/70 backdrop-blur-xl p-4 rounded-xl border border-light-border flex-1 flex items-center justify-between shadow-light-card"},Kx={class:"flex items-center"},jx={class:"text-xl font-medium text-light-text-primary"},Vx={class:"bg-white/70 backdrop-blur-xl rounded-2xl shadow-light-card border border-light-border overflow-hidden"},Mx={class:"flex border-b border-light-border"},Qx={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-primary"},$x={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-green-500"},Nx={key:0,class:"p-6"},Bx={class:"flex justify-between mb-6"},Ux={class:"relative"},Hx={class:"flex space-x-3"},zx={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"},qx={class:"p-4 flex justify-between items-start"},Ox={class:"flex items-center"},Jx={class:"font-medium text-light-text-primary mr-2"},Gx={key:0,class:"text-xs px-1.5 py-0.5 rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30"},Zx={class:"text-xs text-light-text-secondary mt-1"},Yx={class:"flex space-x-2"},em=["onClick"],tm=["onClick"],lm=["onClick"],am=["onClick"],sm={class:"px-4 pb-4"},im={class:"flex flex-wrap gap-2"},rm={key:1,class:"flex items-center justify-center py-12 text-sm text-light-text-secondary"},om={key:2,class:"flex flex-col items-center justify-center py-12 text-light-text-secondary"},nm={key:3,class:"flex flex-col items-center justify-center py-12 text-light-text-secondary"},dm={key:1,class:"p-6"},cm={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},um={class:"flex items-center justify-between relative z-10"},gm={class:"flex items-center"},xm={class:"font-medium text-light-text-primary"},mm={key:0,class:"px-2 py-0.5 bg-light-bg rounded text-xs text-light-text-secondary"},pm={key:1,class:"flex items-center justify-center py-12 text-sm text-light-text-secondary"},bm={class:"flex items-center justify-between p-6 border-b border-light-border"},hm={class:"text-lg font-medium text-light-text-primary flex items-center"},fm={class:"p-6"},km={class:"bg-light-bg p-4 rounded-xl mb-6"},vm={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ym={class:"flex items-end"},Lm={class:"flex items-center bg-white p-3 rounded-lg border border-light-border w-full"},wm={class:"bg-light-bg rounded-xl p-4"},Cm={class:"flex overflow-x-auto scrollbar-hidden space-x-1 pb-2 mb-4"},Rm=["onClick"],_m={class:"mb-4 pb-4 border-b border-light-border"},Tm={class:"flex items-center bg-white p-3 rounded-lg border border-light-border"},Sm={class:"text-sm text-light-text-primary"},Em={key:0,class:"space-y-4"},Wm={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Dm={key:1,class:"space-y-4"},Xm={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pm={key:2,class:"space-y-4"},Am={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Im={key:3,class:"space-y-4"},Fm={key:4,class:"space-y-4"},Km={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jm={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Vm={class:"flex items-center bg-white p-3 rounded-lg border border-light-border"},Mm={class:"flex items-center bg-white p-3 rounded-lg border border-light-border"},Qm={class:"flex justify-end space-x-3 pt-6"},$m={type:"submit",class:"px-4 py-2 rounded-lg text-sm font-medium bg-primary hover:bg-primary-light text-white transition-all duration-200 flex items-center"},Nm={class:"flex items-center justify-between p-6 border-b border-light-border"},Bm={class:"p-6"},Um={key:0,class:"space-y-6"},Hm={class:"bg-light-bg rounded-xl p-5 border border-light-border"},zm={class:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4"},qm={class:"space-y-1"},Om={class:"text-light-text-primary font-medium"},Jm={class:"space-y-1"},Gm={class:"space-y-1"},Zm={class:"text-light-text-primary"},Ym={class:"space-y-1"},ep={class:"text-light-text-primary"},tp={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},lp={key:0,class:"absolute inset-0 bg-primary/5 pointer-events-none"},ap={class:"text-sm font-medium flex items-center justify-between mb-3 relative z-10"},sp={class:"flex items-center text-light-text-primary"},ip={key:1,class:"grid grid-cols-2 gap-4 relative z-10"},rp={class:"space-y-1"},op={class:"text-light-text-primary"},np={key:2,class:"grid grid-cols-2 gap-4 mt-3 relative z-10"},dp={class:"space-y-1"},cp={class:"text-light-text-primary break-all"},up={class:"space-y-1"},gp={class:"text-light-text-primary"},xp={class:"space-y-1"},mp={class:"text-light-text-primary"},pp={key:3,class:"grid grid-cols-1 gap-4 mt-3 relative z-10"},bp={class:"space-y-1"},hp={class:"text-light-text-primary break-all text-xs"},fp={class:"grid grid-cols-2 gap-4"},kp={class:"space-y-1"},vp={class:"text-light-text-primary"},yp={class:"space-y-1"},Lp={class:"text-light-text-primary"},wp={key:4,class:"grid grid-cols-1 gap-4 mt-3 relative z-10"},Cp={class:"space-y-1"},Rp={class:"text-light-text-primary break-all text-xs"},_p={class:"grid grid-cols-2 gap-4"},Tp={class:"space-y-1"},Sp={class:"text-light-text-primary"},Ep={class:"space-y-1"},Wp={class:"text-light-text-primary"},Dp={key:5,class:"grid grid-cols-1 gap-4 mt-3 relative z-10"},Xp={class:"space-y-1"},Pp={class:"text-light-text-primary break-all"},Ap={class:"grid grid-cols-2 gap-4"},Ip={class:"space-y-1"},Fp={class:"text-light-text-primary"},Kp={class:"space-y-1"},jp={class:"text-light-text-primary"},Vp={class:"flex justify-end p-4 border-t border-light-border bg-light-bg/20"},Mp={class:"p-6"},Qp={class:"mb-6"},$p={class:"ml-13 text-sm text-light-text-secondary"},Np={class:"flex flex-col-reverse sm:flex-row justify-end space-x-0 space-y-3 space-y-reverse sm:space-y-0 sm:space-x-3"};function Bp(e,t,l,r,o,n){const d=(0,s.g2)("PopupNotification"),c=(0,s.g2)("ConfirmDialog"),u=(0,s.g2)("PageContainer");return(0,s.uX)(),(0,s.Wv)(u,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",Xx,[(0,s.Lk)("div",Px,[(0,s.Lk)("div",Ax,[t[47]||(t[47]=(0,s.Lk)("div",{class:"h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-settings-4-line text-primary"})],-1)),(0,s.Lk)("div",null,[t[46]||(t[46]=(0,s.Lk)("div",{class:"text-sm text-light-text-secondary"},"总配置数",-1)),(0,s.Lk)("div",Ix,(0,i.v_)(r.toolConfigs.length),1)])]),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.openCreateModal&&r.openCreateModal(...e)),class:"px-3 py-1.5 rounded-lg text-sm font-medium bg-primary hover:bg-primary-light text-white transition-all duration-200"},t[48]||(t[48]=[(0,s.Lk)("i",{class:"ri-add-line mr-1"},null,-1),(0,s.eW)(" 新建配置 ")]))]),(0,s.Lk)("div",Fx,[(0,s.Lk)("div",Kx,[t[50]||(t[50]=(0,s.Lk)("div",{class:"h-10 w-10 bg-green-500/10 rounded-lg flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-tools-line text-green-500"})],-1)),(0,s.Lk)("div",null,[t[49]||(t[49]=(0,s.Lk)("div",{class:"text-sm text-light-text-secondary"},"工具状态",-1)),(0,s.Lk)("div",jx,(0,i.v_)(r.toolsInfo?Object.values(r.toolsInfo.installedStatus).filter(Boolean).length:"加载中")+"/"+(0,i.v_)(r.toolsInfo?Object.keys(r.toolsInfo.installedStatus).length:"..."),1)])]),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.fetchToolsStatus&&r.fetchToolsStatus(...e)),class:"px-3 py-1.5 rounded-lg text-sm font-medium bg-white/80 hover:bg-white/90 text-light-text-secondary hover:text-primary transition-all duration-200 border border-light-border group"},t[51]||(t[51]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-1 group-hover:rotate-180 transition-transform duration-500"},null,-1),(0,s.eW)(" 刷新状态 ")]))])]),(0,s.Lk)("div",Vx,[(0,s.Lk)("div",Mx,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>r.activeMainTab="configs"),class:(0,i.C4)(["px-6 py-4 text-sm font-medium transition-all duration-200 relative","configs"===r.activeMainTab?"text-primary":"text-light-text-secondary hover:text-light-text-primary"])},[t[52]||(t[52]=(0,s.Lk)("i",{class:"ri-settings-4-line mr-2"},null,-1)),t[53]||(t[53]=(0,s.eW)(" 工具配置管理 ")),"configs"===r.activeMainTab?((0,s.uX)(),(0,s.CE)("div",Qx)):(0,s.Q3)("",!0)],2),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>r.activeMainTab="tools"),class:(0,i.C4)(["px-6 py-4 text-sm font-medium transition-all duration-200 relative","tools"===r.activeMainTab?"text-green-500":"text-light-text-secondary hover:text-light-text-primary"])},[t[54]||(t[54]=(0,s.Lk)("i",{class:"ri-tools-line mr-2"},null,-1)),t[55]||(t[55]=(0,s.eW)(" 工具支持状态 ")),"tools"===r.activeMainTab?((0,s.uX)(),(0,s.CE)("div",$x)):(0,s.Q3)("",!0)],2)]),"configs"===r.activeMainTab?((0,s.uX)(),(0,s.CE)("div",Nx,[(0,s.Lk)("div",Bx,[(0,s.Lk)("div",Ux,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.configSearchQuery=e),type:"text",placeholder:"搜索配置...",class:"bg-white border border-light-border rounded-lg pl-9 pr-4 py-2 w-64 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.configSearchQuery]]),t[56]||(t[56]=(0,s.Lk)("i",{class:"ri-search-line absolute left-3 top-2.5 text-light-text-secondary"},null,-1))]),(0,s.Lk)("div",Hx,[(0,s.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>r.fetchToolConfigs&&r.fetchToolConfigs(...e)),class:"px-3 py-2 rounded-lg text-sm font-medium bg-white/80 hover:bg-white/90 text-light-text-secondary hover:text-primary transition-all duration-200 flex items-center border border-light-border group"},t[57]||(t[57]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2 group-hover:rotate-180 transition-transform duration-500"},null,-1),(0,s.eW)(" 刷新配置 ")])),(0,s.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>r.openCreateModal&&r.openCreateModal(...e)),class:"px-3 py-2 rounded-lg text-sm font-medium bg-primary hover:bg-primary-light text-white transition-all duration-200 flex items-center"},t[58]||(t[58]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建配置 ")]))])]),r.filteredConfigs.length>0?((0,s.uX)(),(0,s.CE)("div",zx,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.filteredConfigs,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"bg-white rounded-xl border border-light-border overflow-hidden hover:shadow-light-dropdown transition-all duration-200"},[(0,s.Lk)("div",qx,[(0,s.Lk)("div",null,[(0,s.Lk)("div",Ox,[(0,s.Lk)("h3",Jx,(0,i.v_)(e.name),1),e.is_default?((0,s.uX)(),(0,s.CE)("span",Gx," 默认 ")):(0,s.Q3)("",!0)]),(0,s.Lk)("p",Zx,(0,i.v_)(r.formatDate(e.created_at)),1)]),(0,s.Lk)("div",Yx,[(0,s.Lk)("button",{onClick:t=>r.viewConfigDetails(e),class:"p-1.5 rounded-lg text-primary hover:bg-primary/10 transition-colors duration-200",title:"查看详情"},t[59]||(t[59]=[(0,s.Lk)("i",{class:"ri-eye-line"},null,-1)]),8,em),(0,s.Lk)("button",{onClick:t=>r.editConfig(e),class:"p-1.5 rounded-lg text-yellow-500 hover:bg-yellow-500/10 transition-colors duration-200",title:"编辑"},t[60]||(t[60]=[(0,s.Lk)("i",{class:"ri-edit-line"},null,-1)]),8,tm),e.is_default?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t=>r.setAsDefault(e.id),class:"p-1.5 rounded-lg text-blue-500 hover:bg-blue-500/10 transition-colors duration-200",title:"设为默认"},t[61]||(t[61]=[(0,s.Lk)("i",{class:"ri-star-line"},null,-1)]),8,lm)),e.is_default?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t=>r.confirmDelete(e),class:"p-1.5 rounded-lg text-red-500 hover:bg-red-500/10 transition-colors duration-200",title:"删除"},t[62]||(t[62]=[(0,s.Lk)("i",{class:"ri-delete-bin-line"},null,-1)]),8,am))])]),(0,s.Lk)("div",sm,[(0,s.Lk)("div",im,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["nmap","ffuf","subfinder","httpx","fscan","gogo","afrog","nuclei"],(t=>(0,s.Lk)("span",{key:t,class:(0,i.C4)([e[`${t}_config`].enabled?"bg-primary/10 text-primary border-primary/30":"bg-light-bg text-light-text-disabled border-light-border","text-xs px-2 py-0.5 rounded border"])},(0,i.v_)(t),3))),64))])])])))),128))])):r.loading?((0,s.uX)(),(0,s.CE)("div",rm,t[63]||(t[63]=[(0,s.Lk)("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-light-text-secondary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[(0,s.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,s.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),(0,s.eW)(" 加载中... ")]))):0===r.toolConfigs.length?((0,s.uX)(),(0,s.CE)("div",om,[t[64]||(t[64]=(0,s.Lk)("div",{class:"w-16 h-16 bg-light-bg rounded-full flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-file-list-3-line text-3xl text-light-text-disabled"})],-1)),t[65]||(t[65]=(0,s.Lk)("p",null,"暂无配置数据",-1)),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.openCreateModal&&r.openCreateModal(...e)),class:"mt-4 px-4 py-2 rounded-lg text-sm font-medium bg-primary hover:bg-primary-light text-white transition-all duration-200"}," 创建第一个配置 ")])):((0,s.uX)(),(0,s.CE)("div",nm,[t[66]||(t[66]=(0,s.Lk)("div",{class:"w-16 h-16 bg-light-bg rounded-full flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-search-line text-3xl text-light-text-disabled"})],-1)),(0,s.Lk)("p",null,'没有找到匹配 "'+(0,i.v_)(r.configSearchQuery)+'" 的配置',1),(0,s.Lk)("button",{onClick:t[8]||(t[8]=e=>r.configSearchQuery=""),class:"mt-4 px-4 py-2 rounded-lg text-sm font-medium bg-white hover:bg-light-bg text-light-text-secondary transition-all duration-200"}," 清除搜索 ")]))])):(0,s.Q3)("",!0),"tools"===r.activeMainTab?((0,s.uX)(),(0,s.CE)("div",dm,[r.toolsInfo?((0,s.uX)(),(0,s.CE)("div",cm,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.toolsInfo.installedStatus,((e,l)=>((0,s.uX)(),(0,s.CE)("div",{key:l,class:(0,i.C4)([e?"border-green-500/30":"border-red-500/30","relative bg-white backdrop-blur-sm border rounded-xl p-4 transition-all duration-200 overflow-hidden shadow-light-card"])},[(0,s.Lk)("div",{class:(0,i.C4)([e?"bg-green-500/5":"bg-red-500/5","absolute inset-0 pointer-events-none"])},null,2),(0,s.Lk)("div",um,[(0,s.Lk)("div",gm,[(0,s.Lk)("div",{class:(0,i.C4)([e?"bg-green-500/10 text-green-500":"bg-red-500/10 text-red-500","w-10 h-10 rounded-lg flex items-center justify-center mr-3"])},t[67]||(t[67]=[(0,s.Lk)("i",{class:"ri-terminal-box-line text-lg"},null,-1)]),2),(0,s.Lk)("div",null,[(0,s.Lk)("h3",xm,(0,i.v_)(l),1),(0,s.Lk)("div",{class:(0,i.C4)([e?"text-green-500":"text-red-500","text-sm mt-0.5 flex items-center"])},[(0,s.Lk)("i",{class:(0,i.C4)([e?"ri-checkbox-circle-line":"ri-close-circle-line","mr-1"])},null,2),(0,s.eW)(" "+(0,i.v_)(e?"已安装":"未安装"),1)],2)])]),r.toolsInfo.versions&&r.toolsInfo.versions[l]&&e?((0,s.uX)(),(0,s.CE)("div",mm," v"+(0,i.v_)(r.toolsInfo.versions[l]),1)):(0,s.Q3)("",!0)])],2)))),128))])):((0,s.uX)(),(0,s.CE)("div",pm,t[68]||(t[68]=[(0,s.Lk)("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-light-text-secondary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[(0,s.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,s.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),(0,s.eW)(" 加载中... ")])))])):(0,s.Q3)("",!0)]),r.showNotification?((0,s.uX)(),(0,s.Wv)(d,{key:0,message:r.notificationMessage,type:r.notificationType,onClose:t[9]||(t[9]=e=>r.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),r.showConfigModal?((0,s.uX)(),(0,s.CE)("div",{key:1,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-all duration-300",onClick:t[36]||(t[36]=e=>r.showConfigModal=!1)},[(0,s.Lk)("div",{class:"bg-white rounded-2xl shadow-light-dropdown border border-light-border w-full max-w-4xl max-h-[90vh] overflow-auto transition-all duration-300 transform",onClick:t[35]||(t[35]=(0,a.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",bm,[(0,s.Lk)("h3",hm,[(0,s.Lk)("i",{class:(0,i.C4)([r.isEditing?"ri-edit-line":"ri-add-line","mr-2 text-primary"])},null,2),(0,s.eW)(" "+(0,i.v_)(r.isEditing?"编辑配置":"创建新配置"),1)]),(0,s.Lk)("button",{onClick:t[10]||(t[10]=e=>r.showConfigModal=!1),class:"p-2 rounded-lg text-light-text-secondary hover:text-light-text-primary hover:bg-light-bg transition-colors duration-200"},t[69]||(t[69]=[(0,s.Lk)("i",{class:"ri-close-line text-lg"},null,-1)]))]),(0,s.Lk)("div",fm,[(0,s.Lk)("form",{onSubmit:t[34]||(t[34]=(0,a.D$)(((...e)=>r.saveConfig&&r.saveConfig(...e)),["prevent"]))},[(0,s.Lk)("div",km,[t[72]||(t[72]=(0,s.Lk)("div",{class:"text-sm font-medium text-light-text-primary mb-4 flex items-center"},[(0,s.Lk)("i",{class:"ri-information-line mr-2 text-primary"}),(0,s.eW)(" 基本信息 ")],-1)),(0,s.Lk)("div",vm,[(0,s.Lk)("div",null,[t[70]||(t[70]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"配置名称",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>r.currentConfig.name=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"输入配置名称",required:""},null,512),[[a.Jo,r.currentConfig.name]])]),(0,s.Lk)("div",ym,[(0,s.Lk)("label",Lm,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>r.currentConfig.is_default=e),type:"checkbox",class:"rounded bg-white border-light-border text-primary focus:ring-primary/30 mr-2"},null,512),[[a.lH,r.currentConfig.is_default]]),t[71]||(t[71]=(0,s.Lk)("span",{class:"text-sm text-light-text-primary"},"设为默认配置",-1))])])])]),(0,s.Lk)("div",wm,[t[95]||(t[95]=(0,s.Lk)("div",{class:"text-sm font-medium text-light-text-primary mb-4 flex items-center"},[(0,s.Lk)("i",{class:"ri-tools-line mr-2 text-primary"}),(0,s.eW)(" 工具配置 ")],-1)),(0,s.Lk)("div",Cm,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["nmap","ffuf","subfinder","httpx","fscan","gogo","afrog","nuclei"],(e=>(0,s.Lk)("button",{key:e,type:"button",class:(0,i.C4)([{"bg-primary/10 text-primary border-primary/30":r.activeTab===e,"text-light-text-secondary hover:text-light-text-primary border-transparent hover:bg-light-bg-active":r.activeTab!==e},"py-2 px-4 text-sm font-medium border rounded-lg whitespace-nowrap transition-all duration-200"]),onClick:t=>r.activeTab=e},(0,i.v_)(e.charAt(0).toUpperCase()+e.slice(1)),11,Rm))),64))]),(0,s.Lk)("div",_m,[(0,s.Lk)("label",Tm,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>r.currentConfig[`${r.activeTab}_config`].enabled=e),type:"checkbox",class:"rounded bg-white border-light-border text-primary focus:ring-primary/30 mr-2"},null,512),[[a.lH,r.currentConfig[`${r.activeTab}_config`].enabled]]),(0,s.Lk)("span",Sm," 启用 "+(0,i.v_)(r.activeTab.charAt(0).toUpperCase()+r.activeTab.slice(1)),1)])]),"nmap"===r.activeTab?((0,s.uX)(),(0,s.CE)("div",Em,[(0,s.Lk)("div",null,[t[73]||(t[73]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"端口范围",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>r.currentConfig.nmap_config.ports=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"例如: 80,443,8080-8090"},null,512),[[a.Jo,r.currentConfig.nmap_config.ports]]),t[74]||(t[74]=(0,s.Lk)("p",{class:"mt-1 text-xs text-light-text-secondary"}," 支持单个端口，多个端口（逗号分隔）或端口范围（使用横线） ",-1))]),(0,s.Lk)("div",Wm,[(0,s.Lk)("div",null,[t[75]||(t[75]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"扫描超时（秒）",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>r.currentConfig.nmap_config.scan_timeout=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.nmap_config.scan_timeout,void 0,{number:!0}]])]),(0,s.Lk)("div",null,[t[76]||(t[76]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"并发数",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>r.currentConfig.nmap_config.concurrency=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.nmap_config.concurrency,void 0,{number:!0}]])])])])):(0,s.Q3)("",!0),"ffuf"===r.activeTab?((0,s.uX)(),(0,s.CE)("div",Dm,[(0,s.Lk)("div",null,[t[77]||(t[77]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"字典文件路径",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>r.currentConfig.ffuf_config.wordlist_path=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"例如: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt"},null,512),[[a.Jo,r.currentConfig.ffuf_config.wordlist_path]])]),(0,s.Lk)("div",Xm,[(0,s.Lk)("div",null,[t[78]||(t[78]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"扩展名",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[18]||(t[18]=e=>r.currentConfig.ffuf_config.extensions=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"例如: php,asp,aspx,jsp"},null,512),[[a.Jo,r.currentConfig.ffuf_config.extensions]])]),(0,s.Lk)("div",null,[t[79]||(t[79]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"线程数",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[19]||(t[19]=e=>r.currentConfig.ffuf_config.threads=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.ffuf_config.threads,void 0,{number:!0}]])])]),(0,s.Lk)("div",null,[t[80]||(t[80]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"匹配HTTP状态码",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[20]||(t[20]=e=>r.currentConfig.ffuf_config.match_http_code=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"例如: 200,204,301,302,307,401,403"},null,512),[[a.Jo,r.currentConfig.ffuf_config.match_http_code]])])])):(0,s.Q3)("",!0),"subfinder"===r.activeTab?((0,s.uX)(),(0,s.CE)("div",Pm,[(0,s.Lk)("div",null,[t[81]||(t[81]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"配置文件路径",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[21]||(t[21]=e=>r.currentConfig.subfinder_config.config_path=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"例如: /etc/subfinder/config.yaml"},null,512),[[a.Jo,r.currentConfig.subfinder_config.config_path]])]),(0,s.Lk)("div",Am,[(0,s.Lk)("div",null,[t[82]||(t[82]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"线程数",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[22]||(t[22]=e=>r.currentConfig.subfinder_config.threads=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.subfinder_config.threads,void 0,{number:!0}]])]),(0,s.Lk)("div",null,[t[83]||(t[83]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"最大深度",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[23]||(t[23]=e=>r.currentConfig.subfinder_config.max_depth=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.subfinder_config.max_depth,void 0,{number:!0}]])]),(0,s.Lk)("div",null,[t[84]||(t[84]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"超时（秒）",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[24]||(t[24]=e=>r.currentConfig.subfinder_config.timeout=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.subfinder_config.timeout,void 0,{number:!0}]])])])])):(0,s.Q3)("",!0),["httpx","fscan","afrog","nuclei"].includes(r.activeTab)?((0,s.uX)(),(0,s.CE)("div",Im,[(0,s.Lk)("div",null,[t[85]||(t[85]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"线程数",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[25]||(t[25]=e=>r.currentConfig[`${r.activeTab}_config`].threads=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig[`${r.activeTab}_config`].threads,void 0,{number:!0}]])])])):(0,s.Q3)("",!0),"gogo"===r.activeTab?((0,s.uX)(),(0,s.CE)("div",Fm,[(0,s.Lk)("div",null,[t[86]||(t[86]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"端口配置",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[26]||(t[26]=e=>r.currentConfig.gogo_config.ports=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"例如: top2,win,db,rce"},null,512),[[a.Jo,r.currentConfig.gogo_config.ports]]),t[87]||(t[87]=(0,s.Lk)("p",{class:"mt-1 text-xs text-light-text-secondary"},[(0,s.eW)(" 使用预设扫描配置组合，如 top2, win, db, rce等具体可以参考"),(0,s.Lk)("a",{href:"https://github.com/chainreactors/templates/blob/cfc0603dd26581224e916589515c7ed12b1badc1/port.yaml",target:"_blank",class:"text-primary hover:underline"},"gogo预设port")],-1))]),(0,s.Lk)("div",Km,[(0,s.Lk)("div",null,[t[88]||(t[88]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"线程数",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[27]||(t[27]=e=>r.currentConfig.gogo_config.threads=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.gogo_config.threads,void 0,{number:!0}]])]),(0,s.Lk)("div",null,[t[89]||(t[89]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"超时（秒）",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[28]||(t[28]=e=>r.currentConfig.gogo_config.timeout=e),type:"number",min:"1",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[a.Jo,r.currentConfig.gogo_config.timeout,void 0,{number:!0}]])])]),(0,s.Lk)("div",null,[t[91]||(t[91]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"扫描模式",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[29]||(t[29]=e=>r.currentConfig.gogo_config.mode=e),class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},t[90]||(t[90]=[(0,s.Lk)("option",{value:"default"},"默认",-1),(0,s.Lk)("option",{value:"light"},"轻量级扫描",-1),(0,s.Lk)("option",{value:"aggressive"},"积极扫描",-1)]),512),[[a.u1,r.currentConfig.gogo_config.mode]])]),(0,s.Lk)("div",null,[t[92]||(t[92]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary mb-1"},"输出路径",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[30]||(t[30]=e=>r.currentConfig.gogo_config.output_path=e),type:"text",class:"w-full bg-white border border-light-border rounded-lg px-3 py-2 text-light-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"例如: /tmp/gogo"},null,512),[[a.Jo,r.currentConfig.gogo_config.output_path]])]),(0,s.Lk)("div",jm,[(0,s.Lk)("div",null,[(0,s.Lk)("label",Vm,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[31]||(t[31]=e=>r.currentConfig.gogo_config.enable_exploit=e),type:"checkbox",class:"rounded bg-white border-light-border text-primary focus:ring-primary/30 mr-2"},null,512),[[a.lH,r.currentConfig.gogo_config.enable_exploit]]),t[93]||(t[93]=(0,s.Lk)("span",{class:"text-sm text-light-text-primary"},"启用漏洞利用",-1))])]),(0,s.Lk)("div",null,[(0,s.Lk)("label",Mm,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[32]||(t[32]=e=>r.currentConfig.gogo_config.verbose=e),type:"checkbox",class:"rounded bg-white border-light-border text-primary focus:ring-primary/30 mr-2"},null,512),[[a.lH,r.currentConfig.gogo_config.verbose]]),t[94]||(t[94]=(0,s.Lk)("span",{class:"text-sm text-light-text-primary"},"详细输出",-1))])])])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Qm,[(0,s.Lk)("button",{type:"button",onClick:t[33]||(t[33]=e=>r.showConfigModal=!1),class:"px-4 py-2 rounded-lg text-sm font-medium bg-white border border-light-border hover:bg-light-bg text-light-text-secondary transition-all duration-200"}," 取消 "),(0,s.Lk)("button",$m,[(0,s.Lk)("i",{class:(0,i.C4)([r.isEditing?"ri-save-line":"ri-add-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(r.isEditing?"保存更改":"创建配置"),1)])])],32)])])])):(0,s.Q3)("",!0),r.showViewDetails?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-all duration-300",onClick:t[41]||(t[41]=e=>r.showViewDetails=!1)},[(0,s.Lk)("div",{class:"bg-white rounded-2xl shadow-light-dropdown border border-light-border w-full max-w-4xl max-h-[90vh] overflow-auto transition-all duration-300 transform",onClick:t[40]||(t[40]=(0,a.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",Nm,[t[97]||(t[97]=(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary flex items-center"},[(0,s.Lk)("i",{class:"ri-eye-line mr-2 text-primary"}),(0,s.eW)(" 查看配置详情 ")],-1)),(0,s.Lk)("button",{onClick:t[37]||(t[37]=e=>r.showViewDetails=!1),class:"p-2 rounded-lg text-light-text-secondary hover:text-light-text-primary hover:bg-light-bg transition-colors duration-200"},t[96]||(t[96]=[(0,s.Lk)("i",{class:"ri-close-line text-lg"},null,-1)]))]),(0,s.Lk)("div",Bm,[r.configToView?((0,s.uX)(),(0,s.CE)("div",Um,[(0,s.Lk)("div",Hm,[t[102]||(t[102]=(0,s.Lk)("h4",{class:"text-sm font-medium text-primary mb-4 flex items-center"},[(0,s.Lk)("i",{class:"ri-information-line mr-2"}),(0,s.eW)(" 基本信息 ")],-1)),(0,s.Lk)("div",zm,[(0,s.Lk)("div",qm,[t[98]||(t[98]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"配置名称",-1)),(0,s.Lk)("div",Om,(0,i.v_)(r.configToView.name),1)]),(0,s.Lk)("div",Jm,[t[99]||(t[99]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"状态",-1)),(0,s.Lk)("div",null,[(0,s.Lk)("span",{class:(0,i.C4)([r.configToView.is_default?"bg-blue-500/10 text-blue-500 border-blue-500/30":"bg-light-bg text-light-text-secondary border-light-border","px-2 py-0.5 text-xs font-medium rounded-full border"])},(0,i.v_)(r.configToView.is_default?"默认配置":"普通配置"),3)])]),(0,s.Lk)("div",Gm,[t[100]||(t[100]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"创建时间",-1)),(0,s.Lk)("div",Zm,(0,i.v_)(r.formatDate(r.configToView.created_at)),1)]),(0,s.Lk)("div",Ym,[t[101]||(t[101]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"更新时间",-1)),(0,s.Lk)("div",ep,(0,i.v_)(r.formatDate(r.configToView.updated_at)),1)])])]),(0,s.Lk)("div",tp,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["nmap","ffuf","subfinder","httpx","fscan","gogo","afrog","nuclei"],(e=>(0,s.Lk)("div",{key:e,class:(0,i.C4)([r.configToView[`${e}_config`].enabled?"border-primary/30":"border-light-border","bg-white rounded-xl p-5 border relative overflow-hidden shadow-sm"])},[r.configToView[`${e}_config`].enabled?((0,s.uX)(),(0,s.CE)("div",lp)):(0,s.Q3)("",!0),(0,s.Lk)("h4",ap,[(0,s.Lk)("span",sp,[t[103]||(t[103]=(0,s.Lk)("i",{class:"ri-settings-line mr-2 text-primary"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.charAt(0).toUpperCase()+e.slice(1)),1)]),(0,s.Lk)("span",{class:(0,i.C4)([r.configToView[`${e}_config`].enabled?"bg-primary/10 text-primary border-primary/30":"bg-light-bg text-light-text-secondary border-light-border","px-2 py-0.5 text-xs font-medium rounded-full border"])},(0,i.v_)(r.configToView[`${e}_config`].enabled?"已启用":"已禁用"),3)]),r.configToView[`${e}_config`].threads?((0,s.uX)(),(0,s.CE)("div",ip,[(0,s.Lk)("div",rp,[t[104]||(t[104]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"线程数",-1)),(0,s.Lk)("div",op,(0,i.v_)(r.configToView[`${e}_config`].threads),1)])])):(0,s.Q3)("",!0),"nmap"===e?((0,s.uX)(),(0,s.CE)("div",np,[(0,s.Lk)("div",dp,[t[105]||(t[105]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"端口范围",-1)),(0,s.Lk)("div",cp,(0,i.v_)(r.configToView.nmap_config.ports||"未设置"),1)]),(0,s.Lk)("div",up,[t[106]||(t[106]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"扫描超时",-1)),(0,s.Lk)("div",gp,(0,i.v_)(r.configToView.nmap_config.scan_timeout||"0")+" 秒 ",1)]),(0,s.Lk)("div",xp,[t[107]||(t[107]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"并发数",-1)),(0,s.Lk)("div",mp,(0,i.v_)(r.configToView.nmap_config.concurrency||"0"),1)])])):(0,s.Q3)("",!0),"ffuf"===e?((0,s.uX)(),(0,s.CE)("div",pp,[(0,s.Lk)("div",bp,[t[108]||(t[108]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"字典文件",-1)),(0,s.Lk)("div",hp,(0,i.v_)(r.configToView.ffuf_config.wordlist_path||"未设置"),1)]),(0,s.Lk)("div",fp,[(0,s.Lk)("div",kp,[t[109]||(t[109]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"扩展名",-1)),(0,s.Lk)("div",vp,(0,i.v_)(r.configToView.ffuf_config.extensions||"未设置"),1)]),(0,s.Lk)("div",yp,[t[110]||(t[110]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"HTTP状态码",-1)),(0,s.Lk)("div",Lp,(0,i.v_)(r.configToView.ffuf_config.match_http_code||"未设置"),1)])])])):(0,s.Q3)("",!0),"subfinder"===e?((0,s.uX)(),(0,s.CE)("div",wp,[(0,s.Lk)("div",Cp,[t[111]||(t[111]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"配置文件",-1)),(0,s.Lk)("div",Rp,(0,i.v_)(r.configToView.subfinder_config.config_path||"未设置"),1)]),(0,s.Lk)("div",_p,[(0,s.Lk)("div",Tp,[t[112]||(t[112]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"最大深度",-1)),(0,s.Lk)("div",Sp,(0,i.v_)(r.configToView.subfinder_config.max_depth||"0"),1)]),(0,s.Lk)("div",Ep,[t[113]||(t[113]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"超时",-1)),(0,s.Lk)("div",Wp,(0,i.v_)(r.configToView.subfinder_config.timeout||"0")+" 秒 ",1)])])])):(0,s.Q3)("",!0),"gogo"===e?((0,s.uX)(),(0,s.CE)("div",Dp,[(0,s.Lk)("div",Xp,[t[114]||(t[114]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"端口配置",-1)),(0,s.Lk)("div",Pp,(0,i.v_)(r.configToView.gogo_config.ports||"未设置"),1)]),(0,s.Lk)("div",Ap,[(0,s.Lk)("div",Ip,[t[115]||(t[115]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"超时",-1)),(0,s.Lk)("div",Fp,(0,i.v_)(r.configToView.gogo_config.timeout||"0")+" 秒 ",1)]),(0,s.Lk)("div",Kp,[t[116]||(t[116]=(0,s.Lk)("div",{class:"text-xs text-light-text-secondary"},"模式",-1)),(0,s.Lk)("div",jp,(0,i.v_)(r.configToView.gogo_config.mode||"默认"),1)])])])):(0,s.Q3)("",!0)],2))),64))])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Vp,[(0,s.Lk)("button",{onClick:t[38]||(t[38]=e=>r.editConfig(r.configToView)),class:"px-4 py-2 rounded-lg text-sm font-medium bg-yellow-500 hover:bg-yellow-400 text-white transition-all duration-200 mr-3 flex items-center"},t[117]||(t[117]=[(0,s.Lk)("i",{class:"ri-edit-line mr-1.5"},null,-1),(0,s.eW)(" 编辑此配置 ")])),(0,s.Lk)("button",{onClick:t[39]||(t[39]=e=>r.showViewDetails=!1),class:"px-4 py-2 rounded-lg text-sm font-medium bg-white border border-light-border hover:bg-light-bg text-light-text-secondary transition-all duration-200"}," 关闭 ")])])])):(0,s.Q3)("",!0),r.showDeleteConfirm?((0,s.uX)(),(0,s.CE)("div",{key:3,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-all duration-300",onClick:t[45]||(t[45]=e=>r.showDeleteConfirm=!1)},[(0,s.Lk)("div",{class:"bg-white rounded-2xl shadow-light-dropdown border border-light-border w-full max-w-md transform transition-all duration-300",onClick:t[44]||(t[44]=(0,a.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",Mp,[t[120]||(t[120]=(0,s.Lk)("div",{class:"flex items-center mb-4"},[(0,s.Lk)("div",{class:"w-10 h-10 bg-red-500/10 rounded-lg flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 text-xl"})]),(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary"}," 确认删除 ")],-1)),(0,s.Lk)("div",Qp,[(0,s.Lk)("p",$p,' 确定要删除配置 "'+(0,i.v_)(r.configToDelete?.name)+'" 吗？此操作不可恢复。 ',1)]),(0,s.Lk)("div",Np,[(0,s.Lk)("button",{onClick:t[42]||(t[42]=e=>r.showDeleteConfirm=!1),class:"px-4 py-2.5 rounded-xl border border-light-border bg-white hover:bg-light-bg text-sm font-medium text-light-text-secondary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-gray-200 w-full sm:w-auto"},t[118]||(t[118]=[(0,s.Lk)("span",{class:"flex items-center justify-center"},[(0,s.Lk)("i",{class:"ri-close-line mr-1.5"}),(0,s.eW)(" 取消 ")],-1)])),(0,s.Lk)("button",{onClick:t[43]||(t[43]=(...e)=>r.handleDeleteConfirm&&r.handleDeleteConfirm(...e)),class:"px-4 py-2.5 rounded-xl bg-red-50 hover:bg-red-100 text-red-600 border border-red-200 text-sm font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500/20 w-full sm:w-auto"},t[119]||(t[119]=[(0,s.Lk)("span",{class:"flex items-center justify-center"},[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-1.5"}),(0,s.eW)(" 确认删除 ")],-1)]))])])])])):(0,s.Q3)("",!0),r.showDialog?((0,s.uX)(),(0,s.Wv)(c,{key:4,title:r.dialogTitle,message:r.dialogMessage,type:r.dialogType,onConfirm:r.handleConfirm,onCancel:r.handleCancel},null,8,["title","message","type","onConfirm","onCancel"])):(0,s.Q3)("",!0)])),_:1})}var Up={name:"ToolConfiguration",components:{PageContainer:dt,PopupNotification:m,ConfirmDialog:Yt},setup(){const e=(0,o.KR)([]),t=(0,o.KR)(null),l=(0,o.KR)(!1),a=(0,o.KR)(!1),i=(0,o.KR)(!1),r=(0,o.KR)(!1),n=(0,o.KR)(null),d=(0,o.KR)(null),c=(0,o.KR)(!1),u=(0,o.KR)("nmap"),g=(0,o.KR)("configs"),x=(0,o.KR)(""),m=(0,s.EW)((()=>{if(!x.value)return e.value;const t=x.value.toLowerCase();return e.value.filter((e=>e.name.toLowerCase().includes(t)))})),{showNotification:p,notificationMessage:b,notificationType:h,showSuccess:f,showError:k}=Xe(),{showDialog:v,dialogTitle:y,dialogMessage:L,dialogType:w,handleConfirm:C,handleCancel:R}=el(),_={name:"",is_default:!1,nmap_config:{enabled:!0,ports:"21,22,23,25,53,80,110,111,135,139,143,443,445,465,587,993,995,1080,1433,1521,3306,3389,5432,5900,6379,8080,8443",scan_timeout:300,concurrency:100},ffuf_config:{enabled:!0,wordlist_path:"/usr/share/wordlist/dicc.txt",extensions:"php,asp,aspx,jsp,html,js",threads:50,match_http_code:"200,204,301,302,307,401,403"},subfinder_config:{enabled:!0,config_path:"/etc/subfinder/config.yaml",threads:10,max_depth:2,timeout:60},httpx_config:{enabled:!0,threads:50,timeout:10},fscan_config:{enabled:!0,threads:100},gogo_config:{enabled:!0,ports:"top2,win,db,rce",timeout:5,threads:1e3,mode:"default",enable_exploit:!0,verbose:!0,output_path:"/tmp/gogo"},afrog_config:{enabled:!0,threads:50},nuclei_config:{enabled:!0,threads:50}},T=(0,o.KR)({..._}),S=async()=>{l.value=!0;try{const t=await se.get("/tools/configs");"success"===t.data?.status&&(e.value=t.data.data||[],f("工具配置列表已更新"))}catch(t){k(t.response?.data?.message||"获取工具配置失败")}finally{l.value=!1}},E=async()=>{try{const e=await se.get("/system/tools");"success"===e.data?.status&&e.data?.data?.toolsInfo&&(t.value=e.data.data.toolsInfo,f("工具状态已更新"))}catch(e){k(e.response?.data?.message||"获取工具状态失败")}},W=()=>{c.value=!1,T.value={..._},a.value=!0,u.value="nmap"},D=e=>{c.value=!0,T.value=JSON.parse(JSON.stringify(e)),a.value=!0,u.value="nmap",r.value&&(r.value=!1)},X=async()=>{try{c.value?(await se.put(`/tools/configs/${T.value.id}`,T.value),f("配置已更新")):(await se.post("/tools/configs",T.value),f("配置已创建")),a.value=!1,S()}catch(e){k(e.response?.data?.message||"保存配置失败")}},P=e=>{console.log("准备删除配置:",e),n.value=e,i.value=!0},A=async()=>{try{console.log("正在删除配置:",n.value.id);const e=await se.delete(`/tools/configs/${n.value.id}`);console.log("删除响应:",e),i.value=!1,f("配置已删除"),await S()}catch(e){console.error("删除配置失败:",e),k(e.response?.data?.message||"删除配置失败")}},I=async e=>{try{await se.put(`/tools/configs/${e}/default`),f("默认配置已设置"),S()}catch(t){k(t.response?.data?.message||"设置默认配置失败")}},F=e=>{console.log("查看配置详情:",e),d.value=JSON.parse(JSON.stringify(e)),r.value=!0},K=e=>{if(!e)return"未知时间";const t=new Date(e);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).format(t)};return(0,s.sV)((()=>{S(),E()})),{toolConfigs:e,filteredConfigs:m,toolsInfo:t,loading:l,showConfigModal:a,showDeleteConfirm:i,showViewDetails:r,currentConfig:T,configToDelete:n,configToView:d,isEditing:c,activeTab:u,activeMainTab:g,configSearchQuery:x,fetchToolConfigs:S,fetchToolsStatus:E,openCreateModal:W,editConfig:D,saveConfig:X,confirmDelete:P,handleDeleteConfirm:A,setAsDefault:I,viewConfigDetails:F,formatDate:K,showNotification:p,notificationMessage:b,notificationType:h,showDialog:v,dialogTitle:y,dialogMessage:L,dialogType:w,handleConfirm:C,handleCancel:R}}};const Hp=(0,g.A)(Up,[["render",Bp],["__scopeId","data-v-b4fbbc8e"]]);var zp=Hp;const qp={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},Op={class:"container mx-auto px-6 py-8 flex-1"},Jp={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},Gp={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},Zp={class:"flex items-center"},Yp={class:"flex gap-3"},eb={class:"bg-light-bg p-4 rounded-xl mb-6 border border-light-border"},tb={class:"flex flex-col md:flex-row gap-4"},lb={class:"flex-1 relative"},ab={class:"flex gap-4"},sb={class:"relative min-w-[140px]"},ib={key:0,class:"flex items-center gap-2 mt-3 text-sm text-light-text-secondary"},rb={key:0,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},ob={key:1,class:"px-2 py-0.5 bg-light-bg-hover rounded-md text-light-text-primary text-xs flex items-center"},nb={key:0,class:"flex flex-col items-center justify-center py-12 text-center"},db={class:"text-light-text-secondary max-w-md mb-6"},cb={key:1,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},ub={class:"text-sm text-red-500"};function gb(e,t,l,r,o,n){const d=(0,s.g2)("GogoScanTable"),c=(0,s.g2)("PopupNotification"),u=(0,s.g2)("ConfirmDialog");return(0,s.uX)(),(0,s.CE)("div",qp,[(0,s.Lk)("div",Op,[(0,s.Lk)("div",Jp,[(0,s.Lk)("div",Gp,[(0,s.Lk)("div",Zp,[t[12]||(t[12]=(0,s.Lk)("div",{class:"w-10 h-10 rounded-lg bg-orange-500/20 flex items-center justify-center mr-3"},[(0,s.Lk)("i",{class:"ri-bug-line text-orange-500 text-xl"})],-1)),t[13]||(t[13]=(0,s.Lk)("div",null,[(0,s.Lk)("h2",{class:"text-xl font-medium tracking-wide text-light-text-primary"}," 漏洞扫描结果 "),(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mt-1"}," 查看和管理漏洞扫描任务的结果 ")],-1)),(0,s.Lk)("div",{class:(0,i.C4)(["ml-4 px-3 py-1 rounded-lg bg-light-bg text-light-text-primary text-sm flex items-center",r.filteredResults.length>0?"bg-orange-500/10 text-orange-500":""])},[t[11]||(t[11]=(0,s.Lk)("i",{class:"ri-database-2-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.filteredResults.length)+" 个结果 ",1)],2)]),(0,s.Lk)("div",Yp,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.handleRefreshTasks&&r.handleRefreshTasks(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-light-border flex items-center justify-center"},t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-refresh-line mr-2"},null,-1),(0,s.eW)(" 刷新列表 ")])),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-orange-500/10 hover:bg-orange-500/20 text-orange-500 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-orange-500/30 flex items-center justify-center border border-orange-500/30"},t[15]||(t[15]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描 ")]))])]),(0,s.Lk)("div",eb,[(0,s.Lk)("div",tb,[(0,s.Lk)("div",lb,[t[16]||(t[16]=(0,s.Lk)("i",{class:"ri-search-line absolute left-4 top-3 text-light-text-tertiary"},null,-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchQuery=e),type:"text",placeholder:"搜索目标地址...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-orange-500/50 focus:ring-2 focus:ring-orange-500/20 focus:outline-none transition-all duration-200"},null,512),[[a.Jo,r.searchQuery,void 0,{trim:!0}]])]),(0,s.Lk)("div",ab,[(0,s.Lk)("div",sb,[t[18]||(t[18]=(0,s.Lk)("i",{class:"ri-filter-line absolute left-4 top-3 text-light-text-tertiary"},null,-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>r.statusFilter=e),class:"w-full pl-10 pr-8 py-2.5 rounded-xl bg-white text-light-text-primary border border-light-border focus:border-orange-500/50 focus:ring-2 focus:ring-orange-500/20 focus:outline-none transition-all duration-200 appearance-none"},t[17]||(t[17]=[(0,s.Lk)("option",{value:""},"所有状态",-1),(0,s.Lk)("option",{value:"true"},"已读",-1),(0,s.Lk)("option",{value:"false"},"未读",-1)]),512),[[a.u1,r.statusFilter]]),t[19]||(t[19]=(0,s.Lk)("i",{class:"ri-arrow-down-s-line absolute right-4 top-3 text-light-text-tertiary pointer-events-none"},null,-1))]),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.handleSearch&&r.handleSearch(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-light-border flex items-center justify-center min-w-[100px]"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-search-line mr-2"},null,-1),(0,s.eW)(" 查询 ")]))])]),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("div",ib,[t[23]||(t[23]=(0,s.Lk)("i",{class:"ri-filter-3-line"},null,-1)),t[24]||(t[24]=(0,s.Lk)("span",null,"已过滤: ",-1)),r.searchQuery?((0,s.uX)(),(0,s.CE)("div",rb,[(0,s.eW)(' 搜索 "'+(0,i.v_)(r.searchQuery)+'" ',1),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>r.searchQuery=""),class:"ml-1 text-light-text-tertiary hover:text-light-text-secondary"},t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),r.statusFilter?((0,s.uX)(),(0,s.CE)("div",ob,[(0,s.eW)((0,i.v_)("true"===r.statusFilter?"已读":"未读")+" ",1),(0,s.Lk)("button",{onClick:t[6]||(t[6]=e=>r.statusFilter=""),class:"ml-1 text-light-text-tertiary hover:text-light-text-secondary"},t[22]||(t[22]=[(0,s.Lk)("i",{class:"ri-close-line"},null,-1)]))])):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"ml-2 text-orange-500 hover:text-orange-600 text-xs underline"}," 清除全部 ")])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",{class:(0,i.C4)(["bg-white/90 rounded-xl overflow-hidden border border-light-border shadow-sm",{"opacity-50":r.isLoading}])},[(0,s.bF)(d,{gogoScanResults:r.filteredResults,loading:r.isLoading,onViewDetails:r.handleViewDetails,onDeleteResult:r.handleDeleteResult,onDeleteSelected:r.handleDeleteSelected,onToggleReadStatus:r.handleToggleReadStatus,onMarkSelectedRead:r.handleMarkSelectedRead},null,8,["gogoScanResults","loading","onViewDetails","onDeleteResult","onDeleteSelected","onToggleReadStatus","onMarkSelectedRead"])],2),r.isLoading||0!==r.filteredResults.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",nb,[t[27]||(t[27]=(0,s.Lk)("div",{class:"w-16 h-16 rounded-full bg-light-bg flex items-center justify-center mb-4"},[(0,s.Lk)("i",{class:"ri-bug-line text-light-text-disabled text-3xl"})],-1)),t[28]||(t[28]=(0,s.Lk)("h3",{class:"text-lg font-medium text-light-text-primary mb-2"},"无扫描结果",-1)),(0,s.Lk)("p",db,(0,i.v_)(r.hasActiveFilters?"没有符合当前过滤条件的Gogo漏洞扫描结果，请尝试修改过滤条件或清除筛选":"当前还没有任何Gogo漏洞扫描结果。创建一个新的扫描任务来检测漏洞。"),1),r.hasActiveFilters?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[8]||(t[8]=(...e)=>r.clearFilters&&r.clearFilters(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 flex items-center"},t[25]||(t[25]=[(0,s.Lk)("i",{class:"ri-filter-off-line mr-2"},null,-1),(0,s.eW)(" 清除筛选条件 ")]))):((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t[9]||(t[9]=e=>r.router.push("/task-management")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-orange-500/10 hover:bg-orange-500/20 text-orange-500 transition-all duration-200 flex items-center border border-orange-500/30"},t[26]||(t[26]=[(0,s.Lk)("i",{class:"ri-add-line mr-2"},null,-1),(0,s.eW)(" 新建扫描任务 ")])))])),r.errorMessage?((0,s.uX)(),(0,s.CE)("div",cb,[t[29]||(t[29]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2"},null,-1)),(0,s.Lk)("p",ub,(0,i.v_)(r.errorMessage),1)])):(0,s.Q3)("",!0)])]),r.showNotification?((0,s.uX)(),(0,s.Wv)(c,{key:0,message:r.notificationMessage,type:r.notificationType,onClose:t[10]||(t[10]=e=>r.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0),(0,s.bF)(u,{show:r.showDialog,title:r.dialogTitle,message:r.dialogMessage,type:r.dialogType,onConfirm:r.handleConfirm,onCancel:r.handleCancel},null,8,["show","title","message","type","onConfirm","onCancel"])])}const xb={class:"space-y-6"},mb={key:0},pb={class:"relative overflow-x-auto rounded-xl border border-light-border bg-white/90 shadow-sm"},bb={class:"w-full"},hb={class:"bg-light-bg border-b border-light-border"},fb={class:"py-3 px-4 text-left w-10"},kb=["checked"],vb={class:"py-3 px-4"},yb=["value","id"],Lb=["for"],wb={class:"py-3 px-4 text-sm font-mono text-light-text-primary"},Cb={class:"py-3 px-4 text-sm text-light-text-primary"},Rb={class:"flex items-center"},_b={class:"py-3 px-4 text-sm text-light-text-primary"},Tb={class:"flex items-center"},Sb={class:"py-3 px-4 text-sm text-light-text-primary"},Eb={class:"px-2 py-1 rounded-md bg-red-500/10 text-red-500 border border-red-500/20 inline-flex items-center"},Wb={class:"py-3 px-4 text-sm text-light-text-primary"},Db={class:"px-2 py-1 rounded-md bg-orange-500/10 text-orange-500 border border-orange-500/20 inline-flex items-center"},Xb={class:"py-3 px-4"},Pb={class:"py-3 px-4"},Ab={class:"flex gap-2 flex-wrap"},Ib=["onClick"],Fb=["onClick"],Kb=["onClick"],jb={class:"flex items-center justify-between flex-wrap gap-4 p-4 rounded-xl border border-light-border bg-light-bg mt-6"},Vb={class:"flex items-center gap-3"},Mb={class:"text-sm text-light-text-secondary"},Qb={class:"text-light-text-primary font-medium"},$b={class:"flex flex-wrap gap-3"},Nb=["disabled"],Bb={key:0},Ub=["disabled"],Hb={key:0};function zb(e,t,l,r,o,n){return(0,s.uX)(),(0,s.CE)("div",xb,[r.validResults.length>0?((0,s.uX)(),(0,s.CE)("div",mb,[(0,s.Lk)("div",pb,[(0,s.Lk)("table",bb,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",hb,[(0,s.Lk)("th",fb,[(0,s.Lk)("input",{type:"checkbox",onChange:t[0]||(t[0]=(...e)=>r.toggleSelectAll&&r.toggleSelectAll(...e)),checked:r.isAllSelected,class:"checkbox-input",id:"select-all-header",title:"全选/取消全选"},null,40,kb),t[4]||(t[4]=(0,s.Lk)("label",{for:"select-all-header",class:"sr-only"},"全选/取消全选",-1))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.tableHeaders,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e,class:"py-3 px-4 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider"},(0,i.v_)(e),1)))),128))])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.validResults,((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,i.C4)(["border-b border-light-border transition-all duration-200 hover:bg-light-bg/70",l%2===0?"bg-light-bg/50":"bg-white"])},[(0,s.Lk)("td",vb,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedResults=e),value:e.id,class:"checkbox-input",id:`select-result-${e.id}`},null,8,yb),[[a.lH,r.selectedResults]]),(0,s.Lk)("label",{for:`select-result-${e.id}`,class:"sr-only"},"选择此结果",8,Lb)]),(0,s.Lk)("td",wb,(0,i.v_)(e.id),1),(0,s.Lk)("td",Cb,[(0,s.Lk)("span",Rb,[t[5]||(t[5]=(0,s.Lk)("i",{class:"ri-global-line mr-2 text-orange-500"},null,-1)),(0,s.eW)(" "+(0,i.v_)(e.target),1)])]),(0,s.Lk)("td",_b,[(0,s.Lk)("span",Tb,[t[6]||(t[6]=(0,s.Lk)("i",{class:"ri-time-line mr-2 text-gray-400"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.formatDate(e.timestamp)),1)])]),(0,s.Lk)("td",Sb,[(0,s.Lk)("span",Eb,[t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-error-warning-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.getVulnsCount(e))+" 个 ",1)])]),(0,s.Lk)("td",Wb,[(0,s.Lk)("span",Db,[t[8]||(t[8]=(0,s.Lk)("i",{class:"ri-scan-2-line mr-1.5"},null,-1)),(0,s.eW)(" "+(0,i.v_)(r.getPortsCount(e))+" 个 ",1)])]),(0,s.Lk)("td",Xb,[(0,s.Lk)("span",{class:(0,i.C4)(["px-2 py-1 rounded-md text-xs font-medium inline-flex items-center",e.is_read?"bg-green-500/10 text-green-600 border border-green-500/30":"bg-yellow-500/10 text-yellow-600 border border-yellow-500/30"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-line":"ri-eye-off-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"已读":"未读"),1)],2)]),(0,s.Lk)("td",Pb,[(0,s.Lk)("div",Ab,[(0,s.Lk)("button",{onClick:t=>r.handleViewDetails(e.id),class:"action-button bg-orange-500/10 text-orange-500 border border-orange-500/30 hover:bg-orange-500/20"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-eye-line mr-1.5"},null,-1),(0,s.eW)(" 查看 ")]),8,Ib),(0,s.Lk)("button",{onClick:t=>r.handleToggleRead(e),class:(0,i.C4)(["action-button",e.is_read?"bg-light-bg text-light-text-primary border border-light-border":"bg-green-500/10 text-green-600 border border-green-500/30 hover:bg-green-500/20"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.is_read?"ri-eye-off-line":"ri-eye-line","mr-1.5"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.is_read?"标为未读":"标为已读"),1)],10,Fb),(0,s.Lk)("button",{onClick:t=>r.handleDelete(e.id),class:"action-button bg-red-500/10 text-red-500 border border-red-500/30 hover:bg-red-500/20"},t[10]||(t[10]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-1.5"},null,-1),(0,s.eW)(" 删除 ")]),8,Kb)])])],2)))),128))])])]),(0,s.Lk)("div",jb,[(0,s.Lk)("div",Vb,[(0,s.Lk)("span",Mb,[r.hasSelected?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[t[11]||(t[11]=(0,s.eW)(" 已选择 ")),(0,s.Lk)("span",Qb,(0,i.v_)(r.selectedResults.length),1),t[12]||(t[12]=(0,s.eW)(" 项 "))],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)(" 请选择要操作的项目 ")],64))])]),(0,s.Lk)("div",$b,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.handleBatchRead&&r.handleBatchRead(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20":"bg-light-bg-disabled text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[13]||(t[13]=(0,s.Lk)("i",{class:"ri-eye-line mr-2"},null,-1)),t[14]||(t[14]=(0,s.eW)(" 标记已读 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",Bb,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,Nb),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.handleBatchDelete&&r.handleBatchDelete(...e)),disabled:!r.hasSelected,class:(0,i.C4)(["batch-button",[r.hasSelected?"bg-red-500/10 text-red-500 border-red-500/30 hover:bg-red-500/20":"bg-light-bg-disabled text-light-text-disabled border-light-border cursor-not-allowed"]])},[t[15]||(t[15]=(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1)),t[16]||(t[16]=(0,s.eW)(" 批量删除 ")),r.hasSelected?((0,s.uX)(),(0,s.CE)("span",Hb,"("+(0,i.v_)(r.selectedResults.length)+")",1)):(0,s.Q3)("",!0)],10,Ub)])])])):(0,s.Q3)("",!0)])}var qb={name:"GogoScanTable",props:{gogoScanResults:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["view-details","delete-result","delete-selected","toggle-read-status","mark-selected-read"],setup(e,{emit:t}){const l=["ID","目标地址","扫描时间","漏洞数量","端口数量","状态","操作"],a=(0,s.EW)((()=>Array.isArray(e.gogoScanResults)?e.gogoScanResults:[])),i=(0,o.KR)([]),r=(0,s.EW)((()=>i.value.length>0)),n=(0,s.EW)((()=>!!a.value.length&&i.value.length===a.value.length)),d=e=>{if(!e)return"-";try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return e||"未知时间"}},c=e=>{if(!e||!e.data||!Array.isArray(e.data))return 0;const t=e.data.find((e=>"vulns"===e.Key));return t?.Value?.length||0},u=e=>{if(!e||!e.data||!Array.isArray(e.data))return 0;const t=e.data.find((e=>"ports"===e.Key));return t?.Value?.length||0},g=()=>{n.value?i.value=[]:i.value=a.value.map((e=>e.id))},x=e=>{t("view-details",e)},m=e=>{t("toggle-read-status",e.id,!e.is_read)},p=e=>{t("delete-result",e)},b=()=>{t("mark-selected-read",i.value)},h=()=>{t("delete-selected",i.value)};return(0,s.wB)((()=>a.value),(()=>{i.value=[]})),{tableHeaders:l,validResults:a,selectedResults:i,hasSelected:r,isAllSelected:n,formatDate:d,getVulnsCount:c,getPortsCount:u,toggleSelectAll:g,handleViewDetails:x,handleToggleRead:m,handleDelete:p,handleBatchRead:b,handleBatchDelete:h}}};const Ob=(0,g.A)(qb,[["render",zb],["__scopeId","data-v-32c97e02"]]);var Jb=Ob,Gb={name:"GogoScanResults",components:{GogoScanTable:Jb,PopupNotification:m,ConfirmDialog:Yt},setup(){const e=(0,n.rd)(),t=(0,o.KR)([]),l=(0,o.KR)(!1),a=(0,o.KR)(""),i=(0,o.KR)(""),r=(0,o.KR)(""),{showNotification:d,notificationMessage:c,notificationType:u,showSuccess:g,showError:x,showWarning:m}=Xe(),{showDialog:p,dialogTitle:b,dialogMessage:h,dialogType:f,confirm:k,handleConfirm:v,handleCancel:y}=el(),L=(0,s.EW)((()=>i.value||r.value)),w=(0,s.EW)((()=>{let e=Array.isArray(t.value)?[...t.value]:[];if(i.value){const t=i.value.toLowerCase();e=e.filter((e=>e.target&&e.target.toLowerCase().includes(t)||e.id&&e.id.toLowerCase().includes(t)))}if(r.value){const t="true"===r.value;e=e.filter((e=>e.is_read===t))}return e})),C=async()=>{l.value=!0,a.value="";try{const e=await se.get("/results/type/Gogo");t.value=e.data}catch(e){console.error("Failed to fetch Gogo scan results:",e),a.value="获取Gogo扫描结果失败："+(e.response?.data?.message||e.message||"未知错误"),x("获取Gogo扫描结果失败")}finally{l.value=!1}},R=()=>{C(),m("正在刷新Gogo扫描结果列表")},_=()=>{L.value&&g(`过滤条件已应用，找到 ${w.value.length} 个结果`)},T=()=>{i.value="",r.value="",m("已清除所有过滤条件")},S=t=>{e.push(`/gogo-scan-detail/${t}`)},E=async e=>{try{const a=await k({title:"删除确认",message:"确定要删除这个Gogo扫描结果吗？此操作不可恢复。",type:"danger"});if(!a)return;l.value=!0,await se.delete(`/results/${e}`),t.value=t.value.filter((t=>t.id!==e)),g("已成功删除Gogo扫描结果"),l.value=!1}catch(a){console.error("Failed to delete Gogo scan result:",a),x("删除Gogo扫描结果失败: "+(a.response?.data?.message||a.message||"未知错误")),l.value=!1}},W=async e=>{if(e&&0!==e.length)try{const a=await k({title:"批量删除确认",message:`确定要删除选中的 ${e.length} 个Gogo扫描结果吗？此操作不可恢复。`,type:"danger"});if(!a)return;l.value=!0;const s=e.map((e=>se.delete(`/results/${e}`)));await Promise.all(s),t.value=t.value.filter((t=>!e.includes(t.id))),g(`已成功删除 ${e.length} 个Gogo扫描结果`),l.value=!1}catch(a){console.error("Failed to delete Gogo scan results:",a),x("批量删除Gogo扫描结果失败: "+(a.response?.data?.message||a.message||"未知错误")),l.value=!1}else x("请选择要删除的结果")},D=async(e,l)=>{try{await se.put(`/results/${e}/read`,{is_read:l});const a=t.value.findIndex((t=>t.id===e));-1!==a&&(t.value[a].is_read=l),g("已将Gogo扫描结果标记为"+(l?"已读":"未读"))}catch(a){console.error("Failed to update read status:",a),x("更新读取状态失败: "+(a.response?.data?.message||a.message||"未知错误"))}},X=async e=>{if(e&&0!==e.length)try{const a=await k({title:"批量标记",message:`是否将选中的 ${e.length} 项标记为已读？`,type:"info"});if(!a)return;l.value=!0;const s=e.map((e=>se.put(`/results/${e}/read`,{is_read:!0})));await Promise.all(s),t.value=t.value.map((t=>e.includes(t.id)?{...t,is_read:!0}:t)),g(`已将 ${e.length} 个Gogo扫描结果标记为已读`),l.value=!1}catch(a){console.error("Failed to mark results as read:",a),x("批量标记为已读失败: "+(a.response?.data?.message||a.message||"未知错误")),l.value=!1}};return(0,s.sV)((()=>{C()})),{gogoScanResults:t,filteredResults:w,isLoading:l,errorMessage:a,searchQuery:i,statusFilter:r,hasActiveFilters:L,showNotification:d,notificationMessage:c,notificationType:u,showDialog:p,dialogTitle:b,dialogMessage:h,dialogType:f,router:e,handleRefreshTasks:R,handleSearch:_,clearFilters:T,handleViewDetails:S,handleDeleteResult:E,handleDeleteSelected:W,handleToggleReadStatus:D,handleMarkSelectedRead:X,handleConfirm:v,handleCancel:y}}};const Zb=(0,g.A)(Gb,[["render",gb],["__scopeId","data-v-1aec2782"]]);var Yb=Zb;const eh={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},th={class:"container mx-auto px-6 py-8 flex-1 mt-16"},lh={class:"bg-white/70 backdrop-blur-xl p-8 rounded-2xl shadow-light-card border border-light-border"},ah={class:"flex items-center text-sm text-light-text-secondary mb-6"},sh={class:"bg-white/90 rounded-xl border border-light-border mb-6 overflow-hidden shadow-sm"},ih={class:"p-5 border-b border-light-border flex items-center space-x-3"},rh={class:"text-xl font-medium tracking-wide text-light-text-primary"},oh={class:"grid grid-cols-1 md:grid-cols-3 gap-6 p-5"},nh={class:"flex flex-col"},dh={class:"flex items-center"},ch={class:"text-sm font-mono text-light-text-primary"},uh={class:"flex flex-col"},gh={class:"flex items-center"},xh={class:"text-sm text-light-text-primary"},mh={class:"flex flex-col"},ph={class:"flex items-center"},bh={class:"text-sm text-light-text-primary"},hh={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"},fh={class:"bg-white/90 rounded-xl border border-light-border p-4 flex flex-col shadow-sm"},kh={class:"text-2xl font-medium text-light-text-primary"},vh={class:"bg-white/90 rounded-xl border border-light-border p-4 flex flex-col shadow-sm"},yh={class:"text-2xl font-medium text-purple-500"},Lh={class:"bg-white/90 rounded-xl border border-light-border p-4 flex flex-col shadow-sm"},wh={class:"text-2xl font-medium text-red-500"},Ch={class:"bg-white/90 rounded-xl border border-light-border p-4 flex flex-col shadow-sm"},Rh={class:"text-2xl font-medium text-blue-500"},_h={class:"mb-6 border-b border-light-border"},Th={class:"flex overflow-x-auto hide-scrollbar"},Sh=["onClick"],Eh={key:0,class:"space-y-4"},Wh={class:"bg-white/90 rounded-xl border border-light-border overflow-hidden shadow-sm"},Dh={class:"divide-y divide-light-border"},Xh={class:"flex items-start justify-between"},Ph={class:"flex-1"},Ah={class:"flex items-center mb-2"},Ih={class:"font-medium text-light-text-primary"},Fh={class:"text-sm text-light-text-secondary mt-1"},Kh={class:"mt-2 text-sm text-light-text-tertiary"},jh={class:"font-mono"},Vh={key:0,class:"p-8 text-center text-light-text-tertiary"},Mh={key:1,class:"space-y-4"},Qh={class:"bg-white/90 rounded-xl border border-light-border overflow-hidden shadow-sm"},$h={class:"divide-y divide-light-border"},Nh={key:0,class:"p-8 text-center text-light-text-tertiary"},Bh={key:1,class:"relative overflow-x-auto"},Uh={class:"min-w-full divide-y divide-light-border"},Hh={class:"bg-light-bg"},zh={class:"divide-y divide-light-border"},qh={class:"px-4 py-3 text-sm font-medium text-light-text-primary"},Oh={class:"flex items-center"},Jh={class:"px-4 py-3 text-sm text-light-text-primary font-mono lowercase"},Gh={class:"px-4 py-3 text-sm text-light-text-primary font-mono"},Zh={class:"px-4 py-3 text-sm text-light-text-primary"},Yh={class:"px-4 py-3 text-sm text-light-text-primary"},ef={class:"px-4 py-3 text-sm text-light-text-primary"},tf={class:"max-w-md truncate"},lf={key:2,class:"space-y-4"},af={class:"bg-white/90 rounded-xl border border-light-border overflow-hidden shadow-sm"},sf={class:"divide-y divide-light-border"},rf={key:0,class:"p-8 text-center text-light-text-tertiary"},of={class:"flex items-start justify-between"},nf={class:"flex-1"},df={class:"flex items-center mb-2"},cf={class:"font-medium text-light-text-primary font-mono break-all"},uf={class:"mt-2 text-sm text-light-text-secondary grid grid-cols-1 md:grid-cols-2 gap-2"},gf={key:3,class:"space-y-4"},xf={class:"bg-white/90 rounded-xl border border-light-border overflow-hidden shadow-sm"},mf={class:"p-4 border-b border-light-border flex justify-between"},pf={class:"p-4 max-h-[500px] overflow-auto custom-scrollbar"},bf={class:"text-xs text-light-text-primary font-mono whitespace-pre-wrap bg-light-bg p-4 rounded-lg"},hf={class:"flex justify-end gap-3 mt-6"},ff={key:4,class:"mt-4 px-4 py-3 rounded-xl bg-red-500/10 border border-red-500/30 flex items-center"},kf={class:"text-sm text-red-500"};function vf(e,t,l,a,r,o){const n=(0,s.g2)("HeaderPage"),d=(0,s.g2)("router-link"),c=(0,s.g2)("PopupNotification");return(0,s.uX)(),(0,s.CE)("div",eh,[(0,s.bF)(n),(0,s.Lk)("div",th,[(0,s.Lk)("div",lh,[(0,s.Lk)("div",ah,[(0,s.bF)(d,{to:"/gogo-scan-results",class:"hover:text-orange-500 transition-colors flex items-center"},{default:(0,s.k6)((()=>t[6]||(t[6]=[(0,s.Lk)("i",{class:"ri-arrow-left-line mr-1"},null,-1),(0,s.eW)(" 返回列表 ")]))),_:1}),t[7]||(t[7]=(0,s.Lk)("i",{class:"ri-arrow-right-s-line mx-2"},null,-1)),t[8]||(t[8]=(0,s.Lk)("span",{class:"text-light-text-primary"},"漏洞扫描详情",-1))]),(0,s.Lk)("div",sh,[(0,s.Lk)("div",ih,[t[10]||(t[10]=(0,s.Lk)("div",{class:"w-10 h-10 rounded-lg bg-orange-500/20 flex items-center justify-center"},[(0,s.Lk)("i",{class:"ri-bug-line text-orange-500 text-xl"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h2",rh,(0,i.v_)(a.scanResult?.target||"加载中..."),1),t[9]||(t[9]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mt-1"},"漏洞扫描结果详情",-1))])]),(0,s.Lk)("div",oh,[(0,s.Lk)("div",nh,[t[12]||(t[12]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-fingerprint-line mr-1.5"}),(0,s.eW)(" 扫描ID ")],-1)),(0,s.Lk)("div",dh,[(0,s.Lk)("span",ch,(0,i.v_)(a.scanResult?.id||"-"),1),a.scanResult?.id?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>a.copyToClipboard(a.scanResult.id)),class:"ml-2 text-light-text-tertiary hover:text-light-text-secondary transition-colors",title:"复制ID"},t[11]||(t[11]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",uh,[t[14]||(t[14]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-global-line mr-1.5"}),(0,s.eW)(" 目标地址 ")],-1)),(0,s.Lk)("div",gh,[(0,s.Lk)("span",xh,(0,i.v_)(a.scanResult?.target||"-"),1),a.scanResult?.target?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[1]||(t[1]=e=>a.copyToClipboard(a.scanResult.target)),class:"ml-2 text-light-text-tertiary hover:text-light-text-secondary transition-colors",title:"复制目标"},t[13]||(t[13]=[(0,s.Lk)("i",{class:"ri-clipboard-line text-xs"},null,-1)]))):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",mh,[t[15]||(t[15]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary mb-1 flex items-center"},[(0,s.Lk)("i",{class:"ri-time-line mr-1.5"}),(0,s.eW)(" 扫描时间 ")],-1)),(0,s.Lk)("div",ph,[(0,s.Lk)("span",bh,(0,i.v_)(a.scanResult?a.formatDate(a.scanResult.timestamp):"-"),1)])])])]),(0,s.Lk)("div",hh,[(0,s.Lk)("div",fh,[t[16]||(t[16]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary mb-1"},"端口数量",-1)),(0,s.Lk)("span",kh,(0,i.v_)(a.portsCount),1)]),(0,s.Lk)("div",vh,[t[17]||(t[17]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary mb-1"},"HTTP服务",-1)),(0,s.Lk)("span",yh,(0,i.v_)(a.httpServiceCount),1)]),(0,s.Lk)("div",Lh,[t[18]||(t[18]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary mb-1"},"漏洞数量",-1)),(0,s.Lk)("span",wh,(0,i.v_)(a.vulnsCount),1)]),(0,s.Lk)("div",Ch,[t[19]||(t[19]=(0,s.Lk)("span",{class:"text-sm text-light-text-tertiary mb-1"},"扫描耗时",-1)),(0,s.Lk)("span",Rh,(0,i.v_)(a.scanDuration)+" 秒 ",1)])]),(0,s.Lk)("div",_h,[(0,s.Lk)("div",Th,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.tabs,(e=>((0,s.uX)(),(0,s.CE)("button",{key:e.id,onClick:t=>a.activeTab=e.id,class:(0,i.C4)(["px-5 py-3 font-medium text-sm whitespace-nowrap transition-all duration-200 border-b-2 mx-1 first:ml-0",a.activeTab===e.id?"text-orange-500 border-orange-500":"text-light-text-tertiary border-transparent hover:text-light-text-secondary hover:border-light-border"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.icon,"mr-2"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.name)+" ",1),void 0!==e.count?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,i.C4)(["ml-2 text-xs py-0.5 px-2 rounded-full bg-light-bg",a.activeTab===e.id?"text-orange-500":"text-light-text-tertiary"])},(0,i.v_)(e.count),3)):(0,s.Q3)("",!0)],10,Sh)))),128))])]),"vulns"===a.activeTab?((0,s.uX)(),(0,s.CE)("div",Eh,[(0,s.Lk)("div",Wh,[t[21]||(t[21]=(0,s.Lk)("div",{class:"p-4 border-b border-light-border flex justify-between"},[(0,s.Lk)("h3",{class:"font-medium text-light-text-primary"},[(0,s.Lk)("i",{class:"ri-error-warning-line mr-2 text-red-500"}),(0,s.eW)(" 漏洞信息 ")])],-1)),(0,s.Lk)("div",Dh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.vulnerabilityList,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"p-4 transition-colors hover:bg-light-bg/50"},[(0,s.Lk)("div",Xh,[(0,s.Lk)("div",Ph,[(0,s.Lk)("div",Ah,[(0,s.Lk)("span",{class:(0,i.C4)(["px-2 py-0.5 text-xs font-medium rounded-md mr-2",{"bg-red-500/10 text-red-500 border border-red-500/30":"high"===e.severity,"bg-yellow-500/10 text-yellow-600 border border-yellow-500/30":"medium"===e.severity,"bg-blue-500/10 text-blue-500 border border-blue-500/30":"low"===e.severity}])},(0,i.v_)(a.getSeverityText(e.severity)),3),(0,s.Lk)("h4",Ih,(0,i.v_)(e.type||"未知漏洞类型"),1)]),(0,s.Lk)("p",Fh,(0,i.v_)(e.description||"无详细描述"),1),(0,s.Lk)("div",Kh,[(0,s.Lk)("span",jh,"目标: "+(0,i.v_)(e.target),1)])])])])))),128)),0===a.vulnerabilityList.length?((0,s.uX)(),(0,s.CE)("div",Vh,t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-shield-check-line text-3xl mb-2 block"},null,-1),(0,s.Lk)("p",null,"未发现漏洞信息",-1)]))):(0,s.Q3)("",!0)])])])):(0,s.Q3)("",!0),"ports"===a.activeTab?((0,s.uX)(),(0,s.CE)("div",Mh,[(0,s.Lk)("div",Qh,[t[23]||(t[23]=(0,s.Lk)("div",{class:"p-4 border-b border-light-border flex justify-between"},[(0,s.Lk)("h3",{class:"font-medium text-light-text-primary"},[(0,s.Lk)("i",{class:"ri-door-open-line mr-2 text-orange-500"}),(0,s.eW)(" 开放端口列表 ")])],-1)),(0,s.Lk)("div",$h,[0===a.portsList.length?((0,s.uX)(),(0,s.CE)("div",Nh,t[22]||(t[22]=[(0,s.Lk)("i",{class:"ri-door-lock-line text-3xl mb-2 block"},null,-1),(0,s.Lk)("p",null,"未检测到开放端口",-1)]))):((0,s.uX)(),(0,s.CE)("div",Bh,[(0,s.Lk)("table",Uh,[(0,s.Lk)("thead",Hh,[(0,s.Lk)("tr",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.portTableHeaders,(e=>((0,s.uX)(),(0,s.CE)("th",{key:e,class:"px-4 py-3 text-left text-xs font-medium text-light-text-secondary uppercase tracking-wider"},(0,i.v_)(e),1)))),128))])]),(0,s.Lk)("tbody",zh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.portsList,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t,class:"hover:bg-light-bg/50 transition-colors"},[(0,s.Lk)("td",qh,[(0,s.Lk)("div",Oh,[(0,s.Lk)("span",{class:(0,i.C4)(["w-2 h-2 rounded-full mr-2","open"===a.getPortValue(e,"status")?"bg-green-500":"bg-red-500"])},null,2),(0,s.eW)(" "+(0,i.v_)(a.getPortValue(e,"port")),1)])]),(0,s.Lk)("td",Jh,(0,i.v_)(a.getPortValue(e,"protocol")||"tcp"),1),(0,s.Lk)("td",Gh,(0,i.v_)(a.getPortValue(e,"host")||"-"),1),(0,s.Lk)("td",Zh,(0,i.v_)(a.getPortValue(e,"service")||"-"),1),(0,s.Lk)("td",Yh,(0,i.v_)(a.getPortValue(e,"status")||"-"),1),(0,s.Lk)("td",ef,[(0,s.Lk)("div",tf,(0,i.v_)(a.getPortValue(e,"info")||"-"),1)])])))),128))])])]))])])])):(0,s.Q3)("",!0),"webinfo"===a.activeTab?((0,s.uX)(),(0,s.CE)("div",lf,[(0,s.Lk)("div",af,[t[28]||(t[28]=(0,s.Lk)("div",{class:"p-4 border-b border-light-border flex justify-between"},[(0,s.Lk)("h3",{class:"font-medium text-light-text-primary"},[(0,s.Lk)("i",{class:"ri-global-line mr-2 text-blue-500"}),(0,s.eW)(" Web服务信息 ")])],-1)),(0,s.Lk)("div",sf,[0===a.webInfoList.length?((0,s.uX)(),(0,s.CE)("div",rf,t[24]||(t[24]=[(0,s.Lk)("i",{class:"ri-global-off-line text-3xl mb-2 block"},null,-1),(0,s.Lk)("p",null,"未检测到Web服务",-1)]))):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.webInfoList,((e,l)=>((0,s.uX)(),(0,s.CE)("div",{key:l,class:"p-4 transition-colors hover:bg-light-bg/50"},[(0,s.Lk)("div",of,[(0,s.Lk)("div",nf,[(0,s.Lk)("div",df,[(0,s.Lk)("span",{class:(0,i.C4)(["px-2 py-0.5 text-xs font-medium rounded-md mr-2",{"bg-green-500/10 text-green-600 border border-green-500/30":a.getWebInfoValue(e,"code")>=200&&a.getWebInfoValue(e,"code")<300,"bg-yellow-500/10 text-yellow-600 border border-yellow-500/30":a.getWebInfoValue(e,"code")>=300&&a.getWebInfoValue(e,"code")<400,"bg-red-500/10 text-red-500 border border-red-500/30":a.getWebInfoValue(e,"code")>=400}])}," HTTP "+(0,i.v_)(a.getWebInfoValue(e,"code")),3),(0,s.Lk)("h4",cf,(0,i.v_)(a.getWebInfoValue(e,"url")),1)]),(0,s.Lk)("div",uf,[(0,s.Lk)("div",null,[t[25]||(t[25]=(0,s.Lk)("span",{class:"text-light-text-tertiary"},"标题:",-1)),(0,s.eW)(" "+(0,i.v_)(a.getWebInfoValue(e,"title")||"-"),1)]),(0,s.Lk)("div",null,[t[26]||(t[26]=(0,s.Lk)("span",{class:"text-light-text-tertiary"},"服务器:",-1)),(0,s.eW)(" "+(0,i.v_)(a.getWebInfoValue(e,"server")||"-"),1)]),(0,s.Lk)("div",null,[t[27]||(t[27]=(0,s.Lk)("span",{class:"text-light-text-tertiary"},"框架:",-1)),(0,s.eW)(" "+(0,i.v_)(a.getWebInfoValue(e,"framework")||"-"),1)])])])])])))),128))])])])):(0,s.Q3)("",!0),"raw"===a.activeTab?((0,s.uX)(),(0,s.CE)("div",gf,[(0,s.Lk)("div",xf,[(0,s.Lk)("div",mf,[t[30]||(t[30]=(0,s.Lk)("h3",{class:"font-medium text-light-text-primary"},[(0,s.Lk)("i",{class:"ri-code-box-line mr-2 text-light-text-tertiary"}),(0,s.eW)(" 原始扫描数据 ")],-1)),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>a.copyToClipboard(JSON.stringify(a.scanResult,null,2))),class:"text-xs bg-light-bg hover:bg-light-bg-hover text-light-text-primary px-3 py-1 rounded-md flex items-center"},t[29]||(t[29]=[(0,s.Lk)("i",{class:"ri-clipboard-line mr-1.5"},null,-1),(0,s.eW)(" 复制JSON ")]))]),(0,s.Lk)("div",pf,[(0,s.Lk)("pre",bf,(0,i.v_)(JSON.stringify(a.scanResult,null,2)),1)])])])):(0,s.Q3)("",!0),(0,s.Lk)("div",hf,[(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>a.router.push("/gogo-scan-results")),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-light-bg hover:bg-light-bg-hover text-light-text-primary transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-light-border flex items-center"},t[31]||(t[31]=[(0,s.Lk)("i",{class:"ri-arrow-left-line mr-2"},null,-1),(0,s.eW)(" 返回列表 ")])),a.scanResult&&!a.scanResult.is_read?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[4]||(t[4]=(...e)=>a.handleMarkAsRead&&a.handleMarkAsRead(...e)),class:"px-4 py-2.5 rounded-xl text-sm font-medium bg-green-500/10 hover:bg-green-500/20 text-green-600 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-green-500/30 flex items-center border border-green-500/30"},t[32]||(t[32]=[(0,s.Lk)("i",{class:"ri-check-line mr-2"},null,-1),(0,s.eW)(" 标记为已读 ")]))):(0,s.Q3)("",!0)]),a.errorMessage?((0,s.uX)(),(0,s.CE)("div",ff,[t[33]||(t[33]=(0,s.Lk)("i",{class:"ri-error-warning-line text-red-500 mr-2"},null,-1)),(0,s.Lk)("p",kf,(0,i.v_)(a.errorMessage),1)])):(0,s.Q3)("",!0)])]),a.showNotification?((0,s.uX)(),(0,s.Wv)(c,{key:0,message:a.notificationMessage,type:a.notificationType,onClose:t[5]||(t[5]=e=>a.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0)])}var yf={name:"GogoScanDetail",components:{HeaderPage:C,PopupNotification:m},setup(){const e=(0,n.lq)(),t=(0,n.rd)(),l=e.params.id,a=(0,o.KR)(null),i=(0,o.KR)(!0),r=(0,o.KR)(""),d=(0,o.KR)("vulns"),{showNotification:c,notificationMessage:u,notificationType:g,showSuccess:x,showError:m}=Xe(),p=async()=>{i.value=!0,r.value="";try{const e=await se.get(`/results/${l}`);a.value=e.data}catch(e){console.error("Failed to fetch scan details:",e),r.value="获取扫描详情失败："+(e.response?.data?.message||e.message||"未知错误"),m("获取扫描详情失败","error")}finally{i.value=!1}},b=e=>{navigator.clipboard.writeText(e).then((()=>{x("已复制到剪贴板","success")})).catch((e=>{console.error("Failed to copy: ",e),m("复制失败","error")}))},h=e=>{if(!e)return"-";try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(t){return e||"未知时间"}},f=(0,s.EW)((()=>{if(!a.value||!a.value.data)return[];const e=a.value.data.find((e=>"ports"===e.Key));return e&&e.Value||[]})),k=(0,s.EW)((()=>{if(!a.value||!a.value.data)return[];const e=a.value.data.find((e=>"vulns"===e.Key));return e&&e.Value?e.Value.map((e=>{const t={};return e.forEach((e=>{t[e.Key]=e.Value})),t})):[]})),v=(0,s.EW)((()=>{if(!a.value||!a.value.data)return[];const e=a.value.data.find((e=>"webinfo"===e.Key));return e&&e.Value||[]})),y=async()=>{try{await se.put(`/results/${l}/read`,{is_read:!0}),a.value.is_read=!0,x("已将扫描结果标记为已读")}catch(e){console.error("Failed to mark as read:",e),m("标记为已读失败: "+(e.response?.data?.message||e.message||"未知错误"))}},L=(0,s.EW)((()=>f.value.length)),w=(0,s.EW)((()=>f.value.filter((e=>{const t=_(e,"protocol");return"http"===t||"https"===t})).length)),C=(0,s.EW)((()=>k.value.length)),R=(0,s.EW)((()=>{if(!a.value||!a.value.data)return"-";const e=a.value.data.find((e=>"scanduration"===e.Key));return e?parseFloat(e.Value).toFixed(2):"-"})),_=(e,t)=>{if(!e||!Array.isArray(e))return null;const l=e.find((e=>e.Key===t));return l?l.Value:null},T=(e,t)=>{if(!e||!Array.isArray(e))return null;const l=e.find((e=>e.Key===t));return l?l.Value:null},S=e=>{switch(e){case"high":return"高危";case"medium":return"中危";case"low":return"低危";default:return"未知"}},E=["端口","协议","主机","服务","状态","详细信息"],W=(0,s.EW)((()=>[{id:"vulns",name:"漏洞信息",icon:"ri-error-warning-line",count:C.value},{id:"ports",name:"端口信息",icon:"ri-door-open-line",count:L.value},{id:"webinfo",name:"Web服务",icon:"ri-global-line",count:v.value.length},{id:"raw",name:"原始数据",icon:"ri-code-box-line"}]));return(0,s.sV)((()=>{p()})),{scanResult:a,isLoading:i,errorMessage:r,activeTab:d,portsList:f,vulnerabilityList:k,webInfoList:v,showNotification:c,notificationMessage:u,notificationType:g,router:t,tabs:W,portsCount:L,httpServiceCount:w,vulnsCount:C,scanDuration:R,portTableHeaders:E,formatDate:h,copyToClipboard:b,handleMarkAsRead:y,getPortValue:_,getWebInfoValue:T,getSeverityText:S}}};const Lf=(0,g.A)(yf,[["render",vf],["__scopeId","data-v-77c88c14"]]);var wf=Lf;const Cf={class:"bg-light-gradient text-light-text-primary flex flex-col min-h-screen"},Rf={class:"container mx-auto px-6 py-6 flex-1 mb-4"},_f={class:"flex items-center justify-between mb-4"},Tf=["disabled"],Sf={class:"bg-white/70 backdrop-blur-xl p-5 rounded-2xl shadow-light-card border border-light-border"},Ef={class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4 mb-5"},Wf={class:"bg-white/90 rounded-lg p-4 border border-light-border flex items-center shadow-light-card"},Df={class:"text-light-text-primary text-2xl font-medium"},Xf={class:"bg-white/90 rounded-lg p-4 border border-light-border flex items-center shadow-light-card"},Pf={class:"text-light-text-primary text-2xl font-medium"},Af={class:"bg-white/90 rounded-lg p-4 border border-light-border flex items-center shadow-light-card"},If={class:"text-light-text-primary text-2xl font-medium"},Ff={class:"bg-white/90 rounded-lg p-4 border border-light-border flex items-center shadow-light-card"},Kf={class:"text-light-text-primary text-2xl font-medium"},jf={class:"grid grid-cols-1 xl:grid-cols-2 gap-5 mb-5"},Vf={class:"bg-white/90 rounded-lg p-4 border border-light-border shadow-light-card"},Mf={key:0,class:"text-center py-8 text-light-text-secondary"},Qf={key:1,class:"text-center py-8 text-light-text-secondary"},$f={key:2,class:"mt-2 overflow-x-auto max-h-80 overflow-y-auto pr-1"},Nf={class:"min-w-full"},Bf={class:"py-2.5 pl-2 text-light-text-primary text-sm"},Uf={class:"py-2.5 pl-2"},Hf={class:"bg-primary/10 text-primary text-xs py-0.5 px-2 rounded-full"},zf={class:"py-2.5 pl-2"},qf={class:"flex items-center"},Of={class:"w-28 bg-light-bg rounded-full h-1.5 mr-2"},Jf={class:"py-2.5 pl-2 text-light-text-secondary text-xs"},Gf={class:"bg-white/90 rounded-lg p-4 border border-light-border shadow-light-card"},Zf={key:0,class:"text-center py-8 text-light-text-secondary"},Yf={key:1,class:"text-center py-8 text-light-text-secondary"},ek={key:2,class:"space-y-3 mt-2 max-h-80 overflow-y-auto pr-1"},tk={class:"text-light-text-primary font-medium text-sm"},lk={class:"text-light-text-secondary text-xs flex items-center mt-1"},ak={class:"bg-white/90 rounded-lg p-4 border border-light-border shadow-light-card"},sk={class:"flex items-center justify-between mb-3"},ik={class:"flex space-x-2"},rk={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ok={class:"bg-white/80 rounded-lg border border-light-border p-4 shadow-light-card"},nk={key:0,class:"flex flex-col items-center justify-center h-32"},dk={key:1,class:"flex items-center"},ck={class:"mr-4 text-4xl text-primary"},uk={class:"flex items-end"},gk={class:"text-3xl font-semibold text-light-text-primary"},xk={class:"text-light-text-primary mt-1"},mk={class:"text-light-text-secondary text-sm mt-2"},pk={class:"text-light-text-disabled text-xs mt-2"},bk={class:"bg-white/80 rounded-lg border border-light-border p-4 shadow-light-card"},hk={key:0,class:"flex flex-col items-center justify-center h-32"},fk={key:1,class:"h-full flex flex-col justify-between"},kk={class:"text-light-text-primary text-base italic"},vk={class:"text-light-text-secondary text-sm mt-3 text-right"},yk={key:0,class:"mt-3 bg-light-bg/30 rounded p-2 text-xs text-light-text-secondary"},Lk={class:"whitespace-pre-line"},wk={key:1,class:"mt-2 text-xs text-light-text-secondary italic"},Ck={class:"whitespace-pre-line"},Rk={class:"text-light-text-disabled text-xs mt-2"};function _k(e,t,l,a,r,o){const n=(0,s.g2)("FooterPage"),d=(0,s.g2)("PopupNotification");return(0,s.uX)(),(0,s.CE)("div",Cf,[(0,s.Lk)("div",Rf,[(0,s.Lk)("div",_f,[t[5]||(t[5]=(0,s.Lk)("div",{class:"flex items-center"},[(0,s.Lk)("h1",{class:"text-xl font-medium text-light-text-primary flex items-center"},[(0,s.Lk)("i",{class:"ri-dashboard-line mr-2 text-primary"}),(0,s.eW)(" 系统仪表盘 ")])],-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.refreshData&&a.refreshData(...e)),class:"px-4 py-2 rounded-xl text-sm font-medium bg-white/80 hover:bg-white/90 text-light-text-secondary hover:text-primary transition-all duration-200 flex items-center border border-light-border shadow-light-card",disabled:a.isLoading},[(0,s.Lk)("i",{class:(0,i.C4)(["ri-refresh-line mr-2",{"animate-spin":a.isLoading}])},null,2),(0,s.eW)(" "+(0,i.v_)(a.isLoading?"加载中...":"刷新数据"),1)],8,Tf)]),(0,s.Lk)("div",Sf,[t[25]||(t[25]=(0,s.Lk)("div",{class:"flex items-center mb-4 text-primary"},[(0,s.Lk)("i",{class:"ri-apps-line mr-2"}),(0,s.Lk)("h2",{class:"text-base font-medium text-light-text-primary"},"系统仪表盘")],-1)),(0,s.Lk)("div",Ef,[(0,s.Lk)("div",Wf,[t[7]||(t[7]=(0,s.Lk)("div",{class:"text-3xl text-primary p-2.5 bg-primary/10 rounded-lg mr-3"},[(0,s.Lk)("i",{class:"ri-task-line"})],-1)),(0,s.Lk)("div",null,[t[6]||(t[6]=(0,s.Lk)("div",{class:"text-light-text-secondary text-xs mb-1"},"任务总数",-1)),(0,s.Lk)("div",Df,(0,i.v_)(a.stats.taskCount),1)])]),(0,s.Lk)("div",Xf,[t[9]||(t[9]=(0,s.Lk)("div",{class:"text-3xl text-primary p-2.5 bg-primary/10 rounded-lg mr-3"},[(0,s.Lk)("i",{class:"ri-global-line"})],-1)),(0,s.Lk)("div",null,[t[8]||(t[8]=(0,s.Lk)("div",{class:"text-light-text-secondary text-xs mb-1"},"子域名",-1)),(0,s.Lk)("div",Pf,(0,i.v_)(a.stats.subdomainCount),1)])]),(0,s.Lk)("div",Af,[t[11]||(t[11]=(0,s.Lk)("div",{class:"text-3xl text-primary p-2.5 bg-primary/10 rounded-lg mr-3"},[(0,s.Lk)("i",{class:"ri-folders-line"})],-1)),(0,s.Lk)("div",null,[t[10]||(t[10]=(0,s.Lk)("div",{class:"text-light-text-secondary text-xs mb-1"},"路径数量",-1)),(0,s.Lk)("div",If,(0,i.v_)(a.stats.pathCount),1)])]),(0,s.Lk)("div",Ff,[t[13]||(t[13]=(0,s.Lk)("div",{class:"text-3xl text-primary p-2.5 bg-primary/10 rounded-lg mr-3"},[(0,s.Lk)("i",{class:"ri-bug-line"})],-1)),(0,s.Lk)("div",null,[t[12]||(t[12]=(0,s.Lk)("div",{class:"text-light-text-secondary text-xs mb-1"},"漏洞",-1)),(0,s.Lk)("div",Kf,(0,i.v_)(a.stats.vulnCount),1)])])]),(0,s.Lk)("div",jf,[(0,s.Lk)("div",Vf,[t[16]||(t[16]=(0,s.Lk)("div",{class:"flex items-center mb-3 text-primary"},[(0,s.Lk)("i",{class:"ri-task-line mr-2"}),(0,s.Lk)("h2",{class:"text-sm font-medium text-light-text-primary"},"任务信息")],-1)),0!==a.tasks.length||a.isLoading?a.isLoading?((0,s.uX)(),(0,s.CE)("div",Qf,t[14]||(t[14]=[(0,s.Lk)("i",{class:"ri-loader-2-line animate-spin text-xl"},null,-1),(0,s.Lk)("p",{class:"mt-2"},"加载中...",-1)]))):((0,s.uX)(),(0,s.CE)("div",$f,[(0,s.Lk)("table",Nf,[t[15]||(t[15]=(0,s.Lk)("thead",{class:"sticky top-0 bg-white/95 z-10"},[(0,s.Lk)("tr",{class:"border-b border-light-border text-left"},[(0,s.Lk)("th",{class:"pb-2 pl-2 text-light-text-secondary font-medium text-xs"},"任务名称"),(0,s.Lk)("th",{class:"pb-2 pl-2 text-light-text-secondary font-medium text-xs"},"任务类型"),(0,s.Lk)("th",{class:"pb-2 pl-2 text-light-text-secondary font-medium text-xs"},"任务状态"),(0,s.Lk)("th",{class:"pb-2 pl-2 text-light-text-secondary font-medium text-xs"},"创建时间")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.tasks,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:"border-b border-light-border hover:bg-light-bg-active"},[(0,s.Lk)("td",Bf,(0,i.v_)(e.id),1),(0,s.Lk)("td",Uf,[(0,s.Lk)("span",Hf,(0,i.v_)(e.type||"未知"),1)]),(0,s.Lk)("td",zf,[(0,s.Lk)("div",qf,[(0,s.Lk)("div",Of,[(0,s.Lk)("div",{class:(0,i.C4)(["h-1.5 rounded-full",a.getStatusColorClass(e.status)]),style:(0,i.Tr)({width:a.getTaskProgressWidth(e.status)})},null,6)]),(0,s.Lk)("i",{class:(0,i.C4)([a.getStatusIconClass(e.status),"text-sm"])},null,2)])]),(0,s.Lk)("td",Jf,(0,i.v_)(a.formatDate(e.created_at)),1)])))),128))])])])):((0,s.uX)(),(0,s.CE)("div",Mf," 暂无任务数据 "))]),(0,s.Lk)("div",Gf,[t[19]||(t[19]=(0,s.Lk)("div",{class:"flex items-center mb-3 text-primary"},[(0,s.Lk)("i",{class:"ri-history-line mr-2"}),(0,s.Lk)("h2",{class:"text-sm font-medium text-light-text-primary"},"最近活动")],-1)),0!==a.activities.length||a.isLoading?a.isLoading?((0,s.uX)(),(0,s.CE)("div",Yf,t[17]||(t[17]=[(0,s.Lk)("i",{class:"ri-loader-2-line animate-spin text-xl"},null,-1),(0,s.Lk)("p",{class:"mt-2"},"加载中...",-1)]))):((0,s.uX)(),(0,s.CE)("div",ek,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.activities,((e,l)=>((0,s.uX)(),(0,s.CE)("div",{key:l,class:"flex items-start p-2.5 border border-light-border rounded-lg bg-white/70"},[t[18]||(t[18]=(0,s.Lk)("div",{class:"bg-light-bg rounded-full p-1.5 mr-3 flex-shrink-0"},[(0,s.Lk)("i",{class:"ri-time-line text-light-text-secondary"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("div",tk,(0,i.v_)(a.formatTime(e.timestamp)),1),(0,s.Lk)("div",lk,[(0,s.eW)((0,i.v_)(e.message)+" ",1),(0,s.Lk)("i",{class:(0,i.C4)([a.getActivityIconClass(e.type),"ml-2"])},null,2)])])])))),128))])):((0,s.uX)(),(0,s.CE)("div",Zf," 暂无活动记录 "))])]),(0,s.Lk)("div",ak,[(0,s.Lk)("div",sk,[t[20]||(t[20]=(0,s.Lk)("div",{class:"flex items-center text-primary"},[(0,s.Lk)("i",{class:"ri-cloud-line mr-2"}),(0,s.Lk)("h2",{class:"text-sm font-medium text-light-text-primary"},"天气与每日灵感")],-1)),(0,s.Lk)("div",ik,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>a.setWeatherLocation("beijing")),class:(0,i.C4)(["px-2 py-1 rounded text-xs","beijing"===a.currentLocation?"bg-primary text-white":"bg-light-bg hover:bg-light-bg-active text-light-text-secondary"])},"北京",2),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>a.setWeatherLocation("shanghai")),class:(0,i.C4)(["px-2 py-1 rounded text-xs","shanghai"===a.currentLocation?"bg-primary text-white":"bg-light-bg hover:bg-light-bg-active text-light-text-secondary"])},"上海",2),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>a.setWeatherLocation("guangzhou")),class:(0,i.C4)(["px-2 py-1 rounded text-xs","guangzhou"===a.currentLocation?"bg-primary text-white":"bg-light-bg hover:bg-light-bg-active text-light-text-secondary"])},"广州",2)])]),(0,s.Lk)("div",rk,[(0,s.Lk)("div",ok,[a.isWeatherLoading?((0,s.uX)(),(0,s.CE)("div",nk,t[21]||(t[21]=[(0,s.Lk)("i",{class:"ri-loader-2-line animate-spin text-2xl text-primary/70"},null,-1),(0,s.Lk)("p",{class:"mt-2 text-light-text-secondary"},"加载天气信息...",-1)]))):((0,s.uX)(),(0,s.CE)("div",dk,[(0,s.Lk)("div",ck,[(0,s.Lk)("i",{class:(0,i.C4)(a.getWeatherIcon(a.weatherData.condition))},null,2)]),(0,s.Lk)("div",null,[(0,s.Lk)("div",uk,[(0,s.Lk)("span",gk,(0,i.v_)(a.weatherData.temperature),1),t[22]||(t[22]=(0,s.Lk)("span",{class:"text-light-text-secondary ml-1 mb-1"},"°C",-1))]),(0,s.Lk)("div",xk,(0,i.v_)(a.weatherData.condition),1),(0,s.Lk)("div",mk,[(0,s.Lk)("span",null,"湿度: "+(0,i.v_)(a.weatherData.humidity)+"%",1),t[23]||(t[23]=(0,s.Lk)("span",{class:"mx-2"},"|",-1)),(0,s.Lk)("span",null,"风速: "+(0,i.v_)(a.weatherData.wind),1)]),(0,s.Lk)("div",pk,(0,i.v_)(a.weatherData.location)+" · "+(0,i.v_)(a.weatherData.updateTime),1)])]))]),(0,s.Lk)("div",bk,[a.isDailyQuoteLoading?((0,s.uX)(),(0,s.CE)("div",hk,t[24]||(t[24]=[(0,s.Lk)("i",{class:"ri-loader-2-line animate-spin text-2xl text-primary/70"},null,-1),(0,s.Lk)("p",{class:"mt-2 text-light-text-secondary"},"加载每日灵感...",-1)]))):((0,s.uX)(),(0,s.CE)("div",fk,[(0,s.Lk)("div",null,[(0,s.Lk)("p",kk,(0,i.v_)(a.dailyQuote.content),1),(0,s.Lk)("p",vk,"—— "+(0,i.v_)(a.dailyQuote.author),1),a.dailyQuote.fullPoem&&a.dailyQuote.fullPoem!==a.dailyQuote.content?((0,s.uX)(),(0,s.CE)("div",yk,[(0,s.Lk)("p",Lk,(0,i.v_)(a.dailyQuote.fullPoem),1)])):(0,s.Q3)("",!0),a.dailyQuote.translate?((0,s.uX)(),(0,s.CE)("div",wk,[(0,s.Lk)("p",Ck,(0,i.v_)(a.dailyQuote.translate),1)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Rk,"每日更新 · "+(0,i.v_)(a.dailyQuote.date),1)]))])])])])]),(0,s.bF)(n),a.showNotification?((0,s.uX)(),(0,s.Wv)(d,{key:0,message:a.notificationMessage,type:a.notificationType,onClose:t[4]||(t[4]=e=>a.showNotification=!1)},null,8,["message","type"])):(0,s.Q3)("",!0)])}var Tk={name:"DashboardPage",components:{FooterPage:fx,PopupNotification:m},setup(){const e=(0,o.KR)(!1),t=(0,o.KR)(!1),a=(0,o.KR)(!0),i=(0,o.KR)(!1),r=(0,o.KR)(""),n=(0,o.KR)("info"),d=(0,o.KR)("beijing"),c=l(1544);c.load((e=>{console.log(e),x.value={content:e.data.content,author:`${e.data.origin.author} · ${e.data.origin.title}`,date:C(new Date).split(" ")[0],translate:e.data.origin.translate&&e.data.origin.translate.length>0?e.data.origin.translate.join("\n"):"",fullPoem:e.data.origin.content&&e.data.origin.content.length>0?e.data.origin.content.join("\n"):""},a.value=!1}),(e=>{console.log(e),T("获取诗词数据失败"),a.value=!1}));const u=(0,o.KR)({taskCount:0,subdomainCount:0,pathCount:0,vulnCount:0}),g=(0,o.KR)({temperature:26,condition:"晴天",humidity:45,wind:"3 级",location:"北京",updateTime:"2025-04-18 15:30"}),x=(0,o.KR)({content:"安全不是产品，而是过程。",author:"Bruce Schneier",date:"2025-04-18"}),m=(0,o.KR)([]),p=(0,o.KR)([]),b=e=>{d.value=e,h(e)},h=async e=>{t.value=!0;try{await new Promise((e=>setTimeout(e,500))),"beijing"===e?g.value={temperature:26,condition:"晴天",humidity:45,wind:"3 级",location:"北京",updateTime:C(new Date)}:"shanghai"===e?g.value={temperature:22,condition:"多云",humidity:60,wind:"2 级",location:"上海",updateTime:C(new Date)}:"guangzhou"===e&&(g.value={temperature:30,condition:"小雨",humidity:75,wind:"4 级",location:"广州",updateTime:C(new Date)})}catch(l){console.error("获取天气数据失败",l),T("获取天气数据失败")}finally{t.value=!1}},f=e=>{const t={"晴天":"ri-sun-line","多云":"ri-cloudy-line","阴天":"ri-cloudy-2-line","小雨":"ri-drizzle-line","大雨":"ri-heavy-showers-line","雷雨":"ri-thunderstorms-line","雪":"ri-snowy-line"};return t[e]||"ri-cloud-line"},k=async()=>{try{const e=await se.get("/tasks");m.value=e.data||[],u.value.taskCount=m.value.length,w()}catch(e){console.error("获取任务列表失败",e),T("获取任务列表失败")}},v=async()=>{try{const e=await se.get("/results/type/Subdomain");u.value.subdomainCount=P(e.data)}catch(e){console.error("获取子域名数量失败",e),T("获取子域名数量失败")}},y=async()=>{try{const e=await se.get("/results/type/Path");u.value.pathCount=A(e.data)}catch(e){console.error("获取路径数量失败",e),T("获取路径数量失败")}},L=async()=>{try{const e=await se.get("/results/type/Gogo");u.value.vulnCount=I(e.data)}catch(e){console.error("获取漏洞数量失败",e),T("获取漏洞数量失败")}},w=()=>{p.value=[];const e=[...m.value].sort(((e,t)=>{const l=new Date(e.completed_at||e.updated_at||e.created_at).getTime(),a=new Date(t.completed_at||t.updated_at||t.created_at).getTime();return a-l})).slice(0,6);e.forEach((e=>{let t,l="",a="info";"completed"===e.status&&e.completed_at?(t=new Date(e.completed_at),l=`任务完成：${e.id}`,a="success"):"running"===e.status&&e.updated_at?(t=new Date(e.updated_at),l=`任务进行中：${e.id}`,a="info"):"failed"===e.status&&e.completed_at?(t=new Date(e.completed_at),l=`任务失败：${e.id}`,a="error"):(t=new Date(e.created_at),l=`创建任务：${e.id}`,a="scan"),e.type&&(l+=` (${e.type})`),e.payload&&(l+=` - ${e.payload}`),p.value.push({timestamp:t,message:l,type:a})}))},C=e=>{if(!e)return"未知时间";const t=new Date(e);return t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})},R=e=>e?e.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"未知时间",_=e=>{r.value=e,n.value="success",i.value=!0,setTimeout((()=>{i.value=!1}),3e3)},T=e=>{r.value=e,n.value="error",i.value=!0,setTimeout((()=>{i.value=!1}),3e3)},S=async()=>{if(!e.value){e.value=!0,a.value=!0;try{await Promise.all([k(),v(),y(),L(),h(d.value)]),c.load((e=>{x.value={content:e.data.content,author:`${e.data.origin.author} · ${e.data.origin.title}`,date:C(new Date).split(" ")[0],translate:e.data.origin.translate&&e.data.origin.translate.length>0?e.data.origin.translate.join("\n"):"",fullPoem:e.data.origin.content&&e.data.origin.content.length>0?e.data.origin.content.join("\n"):""},a.value=!1}),(e=>{console.log(e),T("获取诗词数据失败"),a.value=!1})),_("数据已更新")}catch(t){console.error("刷新数据失败",t)}finally{e.value=!1}}},E=e=>{switch(e){case"completed":return"100%";case"running":return"60%";case"failed":return"100%";case"pending":return"10%";default:return"0%"}},W=e=>{switch(e){case"completed":return"bg-green-500";case"running":return"bg-blue-500";case"failed":return"bg-red-500";case"pending":return"bg-yellow-500";default:return"bg-gray-500"}},D=e=>{switch(e){case"completed":return"ri-check-line text-green-500";case"running":return"ri-loader-2-line animate-spin text-blue-500";case"failed":return"ri-close-line text-red-500";case"pending":return"ri-time-line text-yellow-500";default:return"ri-question-line text-gray-500"}},X=e=>{switch(e){case"success":return"ri-checkbox-circle-line text-green-500";case"warning":return"ri-error-warning-line text-yellow-500";case"error":return"ri-close-circle-line text-red-500";case"info":return"ri-information-line text-blue-500";case"scan":return"ri-search-line text-gray-400";default:return"ri-information-line text-gray-400"}},P=e=>{try{if(!e||!Array.isArray(e))return console.error("获取子域名数据格式无效",e),0;let t=0;for(const l of e)if(l.data&&Array.isArray(l.data)){const e=l.data.find((e=>"subdomains"===e.Key));e&&Array.isArray(e.Value)&&(t+=e.Value.length)}return console.log("成功获取子域名数量:",t),t}catch(t){return console.error("解析子域名数据失败",t),0}},A=e=>{try{if(!e||!Array.isArray(e))return console.error("获取路径数据格式无效",e),0;let t=0;for(const l of e)if(l.data&&Array.isArray(l.data)){const e=l.data.find((e=>"paths"===e.Key));e&&Array.isArray(e.Value)&&(t+=e.Value.length)}return console.log("成功获取路径数量:",t),t}catch(t){return console.error("解析路径数据失败",t),0}},I=e=>{try{if(!e||!Array.isArray(e))return console.error("获取漏洞数据格式无效",e),0;let t=0;for(const l of e)if(l.data&&Array.isArray(l.data)){const e=l.data.find((e=>"vulns"===e.Key));if(e&&Array.isArray(e.Value)){t+=e.Value.length;continue}}return console.log("成功获取漏洞数量:",t),t}catch(t){return console.error("解析漏洞数据失败",t),0}};return(0,s.sV)((()=>{S()})),{isLoading:e,isWeatherLoading:t,isDailyQuoteLoading:a,stats:u,tasks:m,activities:p,currentLocation:d,weatherData:g,dailyQuote:x,showNotification:i,notificationMessage:r,notificationType:n,setWeatherLocation:b,refreshData:S,getTaskProgressWidth:E,getStatusColorClass:W,getStatusIconClass:D,getActivityIconClass:X,getWeatherIcon:f,formatDate:C,formatTime:R}}};const Sk=(0,g.A)(Tk,[["render",_k],["__scopeId","data-v-2391bc6e"]]);var Ek=Sk;const Wk={class:"bg-white/90 backdrop-blur-sm shadow-light-card rounded-2xl p-6 border border-light-border"},Dk={class:"mb-6"},Xk={class:"flex border-b border-light-border"},Pk=["onClick"],Ak={class:"border border-light-border rounded-xl overflow-hidden bg-gray-50/50"};function Ik(e,t,l,a,r,o){const n=(0,s.g2)("router-link"),d=(0,s.g2)("router-view"),c=(0,s.g2)("PageContainer");return(0,s.uX)(),(0,s.Wv)(c,null,{default:(0,s.k6)((()=>[(0,s.Lk)("div",Wk,[t[0]||(t[0]=(0,s.Lk)("div",{class:"mb-8 text-center"},[(0,s.Lk)("h1",{class:"text-2xl font-medium text-light-text-primary mb-2"},[(0,s.Lk)("i",{class:"ri-tools-line mr-2 text-primary"}),(0,s.eW)("轻量武器库 ")]),(0,s.Lk)("p",{class:"text-light-text-secondary text-sm"},"提供常用的技术工具，助您快速完成日常工作")],-1)),(0,s.Lk)("div",Dk,[(0,s.Lk)("div",Xk,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.tabs,(e=>((0,s.uX)(),(0,s.Wv)(n,{key:e.id,to:e.route,custom:""},{default:(0,s.k6)((({isActive:t,navigate:l})=>[(0,s.Lk)("button",{onClick:l,class:(0,i.C4)(["px-4 py-2 flex items-center text-sm font-medium transition-colors duration-200",t?"text-primary border-b-2 border-primary":"text-light-text-secondary hover:text-primary"])},[(0,s.Lk)("i",{class:(0,i.C4)([e.icon,"mr-2"])},null,2),(0,s.eW)(" "+(0,i.v_)(e.name),1)],10,Pk)])),_:2},1032,["to"])))),128))])]),(0,s.Lk)("div",Ak,[(0,s.bF)(d)])])])),_:1})}var Fk={name:"ToolsContainer",components:{PageContainer:dt},setup(){const e=[{id:"crypto",name:"加解密工具箱",icon:"ri-lock-line",route:"/tools/crypto"},{id:"http",name:"网络请求工具箱",icon:"ri-global-line",route:"/tools/http-request"}];return{tabs:e}}};const Kk=(0,g.A)(Fk,[["render",Ik],["__scopeId","data-v-41f97e83"]]);var jk=Kk;const Vk={class:"flex p-6 text-light-text-primary h-full"},Mk={class:"w-64 flex-shrink-0 pr-4 border-r border-light-border"},Qk={class:"space-y-1.5"},$k=["onClick"],Nk={class:"flex-1 pl-6 ml-2"},Bk={key:0,class:"rounded-2xl bg-white/90 backdrop-blur-sm border border-light-border p-6 h-full shadow-light-card"},Uk={class:"flex justify-between items-center mb-6"},Hk={class:"text-base font-medium"},zk={class:"space-y-6"},qk={key:0},Ok={class:"flex space-x-3"},Jk={key:1,class:"space-y-3"},Gk={class:"p-4 rounded-xl bg-light-bg border border-light-border break-words"},Zk={class:"max-h-[160px] overflow-y-auto overflow-x-auto custom-scrollbar"},Yk={class:"text-sm p-1 text-light-text-primary font-mono"},ev={key:1,class:"h-full flex items-center justify-center text-light-text-tertiary"},tv={key:0,class:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-sm text-light-text-primary text-sm px-4 py-2 rounded-full shadow-light-card border border-light-border transition-all duration-300 flex items-center"};function lv(e,t,l,r,o,n){return(0,s.uX)(),(0,s.CE)("div",Vk,[(0,s.Lk)("div",Mk,[t[5]||(t[5]=(0,s.Lk)("h2",{class:"text-xl font-medium mb-6 tracking-wide flex items-center"},[(0,s.Lk)("i",{class:"ri-lock-line mr-2 text-cyan-500"}),(0,s.eW)("加密解密工具 ")],-1)),(0,s.Lk)("div",Qk,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.tools,(e=>((0,s.uX)(),(0,s.CE)("button",{key:e.action,onClick:t=>r.showModal(e.action),class:(0,i.C4)(["w-full text-left px-4 py-2.5 rounded-xl text-sm font-medium tracking-wide transition-all duration-200 hover:bg-light-bg focus:bg-light-bg flex items-center",{"bg-light-bg-active text-primary":r.currentAction===e.action}])},[(0,s.Lk)("i",{class:(0,i.C4)([[e.icon,{"text-primary":r.currentAction===e.action}],"text-lg mr-3 text-light-text-tertiary"])},null,2),(0,s.Lk)("span",null,(0,i.v_)(e.name),1)],10,$k)))),128))])]),(0,s.Lk)("div",Nk,[r.currentAction?((0,s.uX)(),(0,s.CE)("div",Bk,[(0,s.Lk)("div",Uk,[(0,s.Lk)("h3",Hk,(0,i.v_)(r.currentToolName),1)]),(0,s.Lk)("div",zk,[(0,s.Lk)("div",null,[t[6]||(t[6]=(0,s.Lk)("label",{class:"block text-sm font-medium mb-2 text-light-text-secondary flex items-center"},[(0,s.Lk)("i",{class:"ri-text-line mr-2 text-light-text-tertiary"}),(0,s.eW)("输入文本 ")],-1)),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.inputText=e),class:"w-full px-4 py-2.5 rounded-xl bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500/30 focus:border-cyan-500/50 transition-all duration-200 min-h-[120px]",placeholder:"请输入需要处理的文本"},null,512),[[a.Jo,r.inputText]])]),["aesEncrypt","aesDecrypt"].includes(r.currentAction)?((0,s.uX)(),(0,s.CE)("div",qk,[t[7]||(t[7]=(0,s.Lk)("label",{class:"block text-sm font-medium mb-2 text-light-text-secondary flex items-center"},[(0,s.Lk)("i",{class:"ri-key-2-line mr-2 text-light-text-tertiary"}),(0,s.eW)("密钥 ")],-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.key=e),type:"text",class:"w-full px-4 py-2.5 rounded-xl bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500/30 focus:border-cyan-500/50 transition-all duration-200",placeholder:"请输入密钥"},null,512),[[a.Jo,r.key]])])):(0,s.Q3)("",!0),(0,s.Lk)("div",Ok,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.handleAction&&r.handleAction(...e)),class:"flex-1 px-4 py-2.5 rounded-xl bg-cyan-500/10 hover:bg-cyan-500/20 text-cyan-600 border border-cyan-500/30 text-sm font-medium transition-all duration-200 flex items-center justify-center"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"ri-play-line mr-2"},null,-1),(0,s.eW)("执行 ")])),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.clearInputs&&r.clearInputs(...e)),class:"flex-1 px-4 py-2.5 rounded-xl bg-light-bg hover:bg-light-bg-hover text-light-text-primary text-sm font-medium transition-all duration-200 flex items-center justify-center border border-light-border"},t[9]||(t[9]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-2"},null,-1),(0,s.eW)("清空 ")]))]),r.outputText?((0,s.uX)(),(0,s.CE)("div",Jk,[(0,s.Lk)("div",Gk,[t[10]||(t[10]=(0,s.Lk)("p",{class:"text-sm text-light-text-secondary mb-2 flex items-center"},[(0,s.Lk)("i",{class:"ri-file-list-line mr-2"}),(0,s.eW)("处理结果： ")],-1)),(0,s.Lk)("div",Zk,[(0,s.Lk)("p",Yk,(0,i.v_)(r.outputText),1)])]),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.copyToClipboard&&r.copyToClipboard(...e)),class:"w-full px-4 py-2.5 rounded-xl bg-cyan-500/10 hover:bg-cyan-500/20 text-cyan-600 border border-cyan-500/30 text-sm font-medium transition-all duration-200 flex items-center justify-center"},[t[11]||(t[11]=(0,s.Lk)("i",{class:"ri-clipboard-line mr-2"},null,-1)),(0,s.Lk)("span",null,(0,i.v_)(r.copyButtonText),1)])])):(0,s.Q3)("",!0)])])):((0,s.uX)(),(0,s.CE)("div",ev,t[12]||(t[12]=[(0,s.Lk)("div",{class:"text-center"},[(0,s.Lk)("i",{class:"ri-arrow-left-line text-4xl mb-2"}),(0,s.Lk)("p",null,"请从左侧选择一个工具")],-1)])))]),r.showCopySuccess?((0,s.uX)(),(0,s.CE)("div",tv,t[13]||(t[13]=[(0,s.Lk)("i",{class:"ri-check-line mr-2 text-green-500"},null,-1),(0,s.eW)("已复制到剪贴板 ")]))):(0,s.Q3)("",!0)])}l(4979);var av=l(3169),sv=l.n(av),iv={name:"CryptoTools",setup(){const e=(0,o.KR)(""),t=(0,o.KR)(""),l=(0,o.KR)(""),a=(0,o.KR)(""),i=(0,o.KR)(!1),r=(0,o.KR)("复制结果"),n=[{name:"Base64 加密",action:"base64Encode",icon:"ri-lock-password-line"},{name:"Base64 解密",action:"base64Decode",icon:"ri-lock-unlock-line"},{name:"AES 加密",action:"aesEncrypt",icon:"ri-lock-2-line"},{name:"AES 解密",action:"aesDecrypt",icon:"ri-key-line"},{name:"MD5 加密",action:"md5Hash",icon:"ri-fingerprint-line"},{name:"SHA-256 加密",action:"sha256Hash",icon:"ri-shield-keyhole-line"},{name:"URL 编码",action:"urlEncode",icon:"ri-global-line"},{name:"URL 解码",action:"urlDecode",icon:"ri-search-line"},{name:"Hex 编码",action:"hexEncode",icon:"ri-code-box-line"},{name:"Hex 解码",action:"hexDecode",icon:"ri-braces-line"}],d=(0,s.EW)((()=>{const e=n.find((e=>e.action===l.value));return e?e.name:""})),c=e=>{l.value=e,t.value&&(t.value="")},u=()=>{e.value="",t.value="",a.value=""},g=()=>{if(e.value)switch(l.value){case"base64Encode":t.value=btoa(e.value);break;case"base64Decode":try{t.value=atob(e.value)}catch(s){t.value="无效的 Base64 输入"}break;case"aesEncrypt":e.value&&a.value?t.value=sv().AES.encrypt(e.value,a.value).toString():t.value="请输入文本和密钥";break;case"aesDecrypt":if(e.value&&a.value)try{const l=sv().AES.decrypt(e.value,a.value).toString(sv().enc.Utf8);t.value=l||"解密失败，可能是密钥错误"}catch(s){t.value="无效的 AES 输入或密钥错误"}else t.value="请输入密文和密钥";break;case"md5Hash":t.value=sv().MD5(e.value).toString();break;case"sha256Hash":t.value=sv().SHA256(e.value).toString();break;case"urlEncode":t.value=encodeURIComponent(e.value);break;case"urlDecode":try{t.value=decodeURIComponent(e.value)}catch(s){t.value="无效的 URL 编码"}break;case"hexEncode":t.value=x(e.value);break;case"hexDecode":try{t.value=m(e.value)}catch(s){t.value="无效的 Hex 编码"}break;default:t.value=""}},x=e=>e.split("").map((e=>e.charCodeAt(0).toString(16).padStart(2,"0"))).join(""),m=e=>{if(!/^[0-9a-fA-F]+$/.test(e))throw new Error("Invalid hex string");return e.match(/.{1,2}/g).map((e=>String.fromCharCode(parseInt(e,16)))).join("")},p=()=>{navigator.clipboard.writeText(t.value).then((()=>{r.value="已复制",i.value=!0,setTimeout((()=>{r.value="复制结果",i.value=!1}),2e3)})).catch((()=>{r.value="复制失败",setTimeout((()=>{r.value="复制结果"}),2e3)}))};return{inputText:e,outputText:t,currentAction:l,currentToolName:d,key:a,showCopySuccess:i,copyButtonText:r,tools:n,showModal:c,clearInputs:u,handleAction:g,copyToClipboard:p}}};const rv=(0,g.A)(iv,[["render",lv],["__scopeId","data-v-1cc46d86"]]);var ov=rv;const nv={class:"flex flex-col p-6 text-light-text-primary space-y-6 max-w-5xl mx-auto"},dv={class:"text-center space-y-4"},cv={class:"text-sm text-light-text-secondary leading-relaxed bg-light-bg p-3 rounded-lg border border-light-border"},uv={class:"text-xs opacity-75 mt-2"},gv={class:"flex items-center bg-gray-100 px-3 py-1.5 rounded-md text-light-text-primary group relative"},xv={class:"space-y-4"},mv={class:"space-y-2"},pv={class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0"},bv=["value"],hv={class:"space-y-2"},fv={class:"flex justify-between items-center"},kv=["onUpdate:modelValue"],vv=["onUpdate:modelValue"],yv=["onClick"],Lv=["onClick"],wv={key:0,class:"space-y-2"},Cv={class:"flex justify-between items-center"},Rv=["placeholder"],_v={key:1,class:"space-y-2"},Tv=["onUpdate:modelValue"],Sv=["onUpdate:modelValue"],Ev=["onClick"],Wv=["onClick"],Dv=["disabled"],Xv={key:0,class:"ri-send-plane-line mr-2"},Pv={key:1,class:"ri-loader-4-line animate-spin mr-2"},Av={key:1,class:"space-y-3 bg-white/70 p-4 rounded-xl border border-light-border shadow-sm"},Iv={class:"flex flex-col sm:flex-row sm:justify-between text-sm space-y-2 sm:space-y-0"},Fv={class:"flex items-center space-x-2"},Kv={class:"text-light-text-tertiary"},jv={class:"border-t border-light-border pt-3"},Vv={key:0,class:"bg-light-bg rounded-lg p-3 mb-3 text-sm border border-light-border"},Mv={class:"font-medium text-light-text-tertiary mr-2 whitespace-nowrap"},Qv={class:"text-light-text-primary break-all"},$v={class:"flex items-center justify-between mb-2"},Nv={class:"p-3 rounded-xl bg-light-bg border border-light-border break-words"},Bv={class:"max-h-[300px] overflow-y-auto overflow-x-auto custom-scrollbar"},Uv={key:0,class:"text-sm whitespace-pre-wrap text-light-text-primary font-mono"},Hv=["innerHTML"],zv={key:0,class:"fixed bottom-4 right-4 bg-white/90 backdrop-blur-sm text-light-text-primary text-sm px-4 py-2 rounded-lg shadow-light-card border border-light-border transition-all duration-300 flex items-center z-[1001]"};function qv(e,t,l,r,o,n){return(0,s.uX)(),(0,s.CE)("div",nv,[(0,s.Lk)("div",dv,[t[15]||(t[15]=(0,s.Lk)("h2",{class:"text-xl font-medium tracking-wide flex items-center justify-center"},[(0,s.Lk)("i",{class:"ri-global-line mr-2 text-cyan-500"}),(0,s.eW)("网络请求工具 ")],-1)),(0,s.Lk)("div",cv,[t[13]||(t[13]=(0,s.Lk)("i",{class:"ri-information-line mr-1 text-yellow-600"},null,-1)),t[14]||(t[14]=(0,s.eW)(" 使用该功能时需要关闭浏览器的 CORS 安全检查 ")),(0,s.Lk)("div",uv,[t[12]||(t[12]=(0,s.Lk)("span",{class:"mr-2 block sm:inline-block mb-1 sm:mb-0"},"在 Chrome 中运行：",-1)),(0,s.Lk)("div",gv,[t[11]||(t[11]=(0,s.Lk)("code",{class:"flex-1 overflow-x-auto whitespace-nowrap text-xs sm:text-sm"},' chrome.exe --user-data-dir="C:/Chrome dev session" --disable-web-security ',-1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.copyCommand&&r.copyCommand(...e)),class:"ml-2 text-light-text-tertiary hover:text-cyan-500 transition-colors",title:"复制命令"},t[10]||(t[10]=[(0,s.Lk)("i",{class:"ri-clipboard-line"},null,-1)]))])])])]),(0,s.Lk)("div",xv,[(0,s.Lk)("div",mv,[t[16]||(t[16]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary flex items-center"},[(0,s.Lk)("i",{class:"ri-link mr-2 text-light-text-tertiary"}),(0,s.eW)("请求地址 ")],-1)),(0,s.Lk)("div",pv,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.url=e),class:"w-full px-4 py-2.5 rounded-xl sm:rounded-l-xl sm:rounded-r-none bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500/30 focus:border-cyan-500/50 transition-all duration-200",placeholder:"输入请求的 URL"},null,512),[[a.Jo,r.url]]),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.httpMethod=e),class:"px-4 py-2.5 rounded-xl sm:rounded-l-none sm:rounded-r-xl bg-white border sm:border-l-0 border-light-border text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500/30 transition-all duration-200 appearance-none"},[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["GET","POST","PUT","DELETE","PATCH","OPTIONS"],(e=>(0,s.Lk)("option",{key:e,value:e},(0,i.v_)(e),9,bv))),64))],512),[[a.u1,r.httpMethod]])])]),(0,s.Lk)("div",hv,[(0,s.Lk)("div",fv,[t[18]||(t[18]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary flex items-center"},[(0,s.Lk)("i",{class:"ri-file-list-line mr-2 text-light-text-tertiary"}),(0,s.eW)("请求头部 ")],-1)),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.addHeader&&r.addHeader(...e)),class:"text-xs bg-light-bg px-2 py-1 rounded-md hover:bg-light-bg-hover transition-colors flex items-center border border-light-border"},t[17]||(t[17]=[(0,s.Lk)("i",{class:"ri-add-line mr-1"},null,-1),(0,s.eW)("添加 ")]))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.headers,((e,l)=>((0,s.uX)(),(0,s.CE)("div",{key:l,class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 items-center mb-2"},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,class:"w-full sm:flex-1 px-3 py-2 rounded-lg sm:rounded-l-lg sm:rounded-r-none bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all duration-200",placeholder:"Key"},null,8,kv),[[a.Jo,e.key]]),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.value=t,class:"w-full sm:flex-1 px-3 py-2 rounded-lg sm:rounded-l-none sm:rounded-r-lg bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all duration-200",placeholder:"Value"},null,8,vv),[[a.Jo,e.value]]),(0,s.Lk)("button",{onClick:e=>r.removeHeader(l),class:"hidden sm:block text-light-text-tertiary hover:text-red-500 transition-colors p-1"},t[19]||(t[19]=[(0,s.Lk)("i",{class:"ri-delete-bin-line"},null,-1)]),8,yv),(0,s.Lk)("button",{onClick:e=>r.removeHeader(l),class:"sm:hidden w-full text-left text-light-text-tertiary hover:text-red-500 transition-colors p-1 mt-1"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-1"},null,-1),(0,s.eW)("删除 ")]),8,Lv)])))),128))]),r.showRequestBody?((0,s.uX)(),(0,s.CE)("div",wv,[(0,s.Lk)("div",Cv,[t[22]||(t[22]=(0,s.Lk)("label",{class:"block text-sm font-medium text-light-text-secondary flex items-center"},[(0,s.Lk)("i",{class:"ri-code-box-line mr-2 text-light-text-tertiary"}),(0,s.eW)("请求数据 ")],-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>r.dataFormat=e),class:"text-xs px-3 py-1.5 rounded-lg bg-light-bg border border-light-border focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all duration-200 appearance-none"},t[21]||(t[21]=[(0,s.Lk)("option",{value:"json"},"JSON",-1),(0,s.Lk)("option",{value:"raw"},"Raw",-1),(0,s.Lk)("option",{value:"form"},"Form Data",-1)]),512),[[a.u1,r.dataFormat]])]),"form"!==r.dataFormat?(0,s.bo)(((0,s.uX)(),(0,s.CE)("textarea",{key:0,"onUpdate:modelValue":t[5]||(t[5]=e=>r.requestData=e),rows:"5",class:"w-full px-4 py-2.5 rounded-xl bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500/30 transition-all duration-200 custom-scrollbar",placeholder:r.jsonPlaceholder},null,8,Rv)),[[a.Jo,r.requestData]]):((0,s.uX)(),(0,s.CE)("div",_v,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.formData,((e,l)=>((0,s.uX)(),(0,s.CE)("div",{key:l,class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 items-center mb-2"},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,class:"w-full sm:flex-1 px-3 py-2 rounded-lg sm:rounded-l-lg sm:rounded-r-none bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all duration-200",placeholder:"Key"},null,8,Tv),[[a.Jo,e.key]]),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.value=t,class:"w-full sm:flex-1 px-3 py-2 rounded-lg sm:rounded-l-none sm:rounded-r-lg bg-light-bg border border-light-border text-sm focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all duration-200",placeholder:"Value"},null,8,Sv),[[a.Jo,e.value]]),(0,s.Lk)("button",{onClick:e=>r.removeFormItem(l),class:"hidden sm:block text-light-text-tertiary hover:text-red-500 transition-colors p-1"},t[23]||(t[23]=[(0,s.Lk)("i",{class:"ri-delete-bin-line"},null,-1)]),8,Ev),(0,s.Lk)("button",{onClick:e=>r.removeFormItem(l),class:"sm:hidden w-full text-left text-light-text-tertiary hover:text-red-500 transition-colors p-1 mt-1"},t[24]||(t[24]=[(0,s.Lk)("i",{class:"ri-delete-bin-line mr-1"},null,-1),(0,s.eW)("删除 ")]),8,Wv)])))),128)),(0,s.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>r.addFormItem&&r.addFormItem(...e)),class:"text-xs bg-light-bg px-2 py-1 rounded-md hover:bg-light-bg-hover transition-colors flex items-center self-start border border-light-border"},t[25]||(t[25]=[(0,s.Lk)("i",{class:"ri-add-line mr-1"},null,-1),(0,s.eW)("添加字段 ")]))]))])):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>r.sendRequest&&r.sendRequest(...e)),class:"w-full px-4 py-3 rounded-xl bg-cyan-500 hover:bg-cyan-600 text-white text-sm font-medium transition-all duration-200 flex items-center justify-center space-x-2 shadow-sm",disabled:r.isLoading},[r.isLoading?((0,s.uX)(),(0,s.CE)("i",Pv)):((0,s.uX)(),(0,s.CE)("i",Xv)),(0,s.Lk)("span",null,(0,i.v_)(r.isLoading?"发送中...":"发送请求"),1)],8,Dv),r.response?((0,s.uX)(),(0,s.CE)("div",Av,[(0,s.Lk)("div",Iv,[(0,s.Lk)("div",Fv,[t[26]||(t[26]=(0,s.Lk)("span",{class:"font-medium text-light-text-secondary"},"状态码：",-1)),(0,s.Lk)("span",{class:(0,i.C4)({"text-green-500":r.responseStatus>=200&&r.responseStatus<300,"text-yellow-600":r.responseStatus>=300&&r.responseStatus<400,"text-red-500":r.responseStatus>=400})},(0,i.v_)(r.responseStatus),3)]),(0,s.Lk)("div",Kv,[(0,s.Lk)("span",null,"耗时："+(0,i.v_)(r.responseTime)+"ms",1)])]),(0,s.Lk)("div",jv,[(0,s.Lk)("button",{onClick:t[8]||(t[8]=e=>r.showHeaders=!r.showHeaders),class:"flex items-center justify-between w-full text-left text-sm text-light-text-primary mb-2"},[t[27]||(t[27]=(0,s.Lk)("span",{class:"font-medium flex items-center"},[(0,s.Lk)("i",{class:"ri-file-list-line mr-2"}),(0,s.eW)("响应头部 ")],-1)),(0,s.Lk)("i",{class:(0,i.C4)([r.showHeaders?"ri-arrow-up-s-line":"ri-arrow-down-s-line","text-light-text-tertiary"])},null,2)]),r.showHeaders?((0,s.uX)(),(0,s.CE)("div",Vv,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.responseHeaders,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"flex flex-wrap mb-1"},[(0,s.Lk)("span",Mv,(0,i.v_)(t)+":",1),(0,s.Lk)("span",Qv,(0,i.v_)(e),1)])))),128))])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",null,[(0,s.Lk)("div",$v,[t[29]||(t[29]=(0,s.Lk)("span",{class:"text-sm font-medium text-light-text-primary flex items-center"},[(0,s.Lk)("i",{class:"ri-file-text-line mr-2"}),(0,s.eW)("响应数据 ")],-1)),(0,s.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>r.copyResponse&&r.copyResponse(...e)),class:"text-xs bg-light-bg px-2 py-1 rounded-md hover:bg-light-bg-hover transition-colors flex items-center border border-light-border"},t[28]||(t[28]=[(0,s.Lk)("i",{class:"ri-clipboard-line mr-1"},null,-1),(0,s.eW)("复制 ")]))]),(0,s.Lk)("div",Nv,[(0,s.Lk)("div",Bv,[r.isJsonResponse?((0,s.uX)(),(0,s.CE)("pre",{key:1,class:"text-sm json-formatter font-mono",innerHTML:r.formattedJsonResponse},null,8,Hv)):((0,s.uX)(),(0,s.CE)("pre",Uv,(0,i.v_)(r.response),1))])])])])):(0,s.Q3)("",!0)]),r.showCopySuccess?((0,s.uX)(),(0,s.CE)("div",zv,[t[30]||(t[30]=(0,s.Lk)("i",{class:"ri-check-line mr-2 text-green-500"},null,-1)),(0,s.eW)((0,i.v_)(r.copyMessage),1)])):(0,s.Q3)("",!0)])}var Ov={name:"HttpRequestTool",setup(){const e=(0,o.KR)(""),t=(0,o.KR)("GET"),l=(0,o.KR)(""),a=(0,o.KR)(null),i=(0,o.KR)(null),r=(0,o.KR)("json"),n=(0,o.KR)(!1),d=(0,o.KR)(0),c=(0,o.KR)({}),u=(0,o.KR)(!1),g=(0,o.KR)(!1),x=(0,o.KR)(""),m=(0,o.KR)([{key:"Content-Type",value:"application/json"}]),p=(0,o.KR)([{key:"",value:""}]),b=(0,s.EW)((()=>"json"===r.value?'{"key": "value"}':"Raw request data")),h=(0,s.EW)((()=>"GET"!==t.value&&"OPTIONS"!==t.value)),f=(0,s.EW)((()=>{if(!a.value)return!1;try{return JSON.parse(a.value),!0}catch(e){return!1}})),k=(0,s.EW)((()=>{if(!f.value)return"";try{const e=JSON.parse(a.value);return v(JSON.stringify(e,null,2))}catch(e){return a.value}})),v=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,(function(e){let t="json-number";return/^"/.test(e)?t=/:$/.test(e)?"json-key":"json-string":/true|false/.test(e)?t="json-boolean":/null/.test(e)&&(t="json-null"),'<span class="'+t+'">'+e+"</span>"}));(0,s.wB)(t,(e=>{if("GET"===e){const e=m.value.find((e=>"content-type"===e.key.toLowerCase()));e&&(e.value="application/json")}}));const y=()=>{m.value.push({key:"",value:""})},L=e=>{m.value.splice(e,1)},w=()=>{p.value.push({key:"",value:""})},C=e=>{p.value.splice(e,1)},R=()=>{const e='chrome.exe --user-data-dir="C:/Chrome dev session" --disable-web-security';navigator.clipboard.writeText(e).then((()=>{T("命令已复制到剪贴板")}))},_=()=>{navigator.clipboard.writeText(a.value).then((()=>{T("响应已复制到剪贴板")}))},T=e=>{x.value=e,g.value=!0,setTimeout((()=>{g.value=!1}),2e3)},S=async()=>{if(!e.value)return;n.value=!0;const s=performance.now();try{const n={};m.value.forEach((e=>{e.key&&e.value&&(n[e.key]=e.value)}));let u=null;if(h.value)if("json"===r.value)try{u=JSON.stringify(JSON.parse(l.value))}catch(o){throw new Error("请求数据不是有效的JSON格式")}else if("raw"===r.value)u=l.value;else if("form"===r.value){const e=new FormData;p.value.forEach((t=>{t.key&&e.append(t.key,t.value)})),u=e,delete n["Content-Type"]}const g={method:t.value,headers:n,body:h.value?u:null},x=await fetch(e.value,g);i.value=x.status,c.value={},x.headers.forEach(((e,t)=>{c.value[t]=e})),a.value=await x.text(),d.value=Math.round(performance.now()-s)}catch(u){i.value=0,a.value=`请求错误: ${u.message}`,d.value=Math.round(performance.now()-s),c.value={}}finally{n.value=!1}};return{url:e,httpMethod:t,requestData:l,response:a,responseStatus:i,dataFormat:r,isLoading:n,responseTime:d,responseHeaders:c,showHeaders:u,showCopySuccess:g,copyMessage:x,headers:m,formData:p,showRequestBody:h,isJsonResponse:f,formattedJsonResponse:k,jsonPlaceholder:b,addHeader:y,removeHeader:L,addFormItem:w,removeFormItem:C,copyCommand:R,copyResponse:_,sendRequest:S}}};const Jv=(0,g.A)(Ov,[["render",qv],["__scopeId","data-v-6e70df80"]]);var Gv=Jv;const Zv=[{path:"/",name:"Home",component:ve},{path:"/dashboard",name:"Dashboard",component:Ek},{path:"/login",name:"LoginPage",component:Ie},{path:"/system-configuration",name:"SystemConfiguration",component:gt},{path:"/tool-configuration",name:"ToolConfiguration",component:zp},{path:"/user-management",name:"UserManagement",component:al},{path:"/setup-2fa",name:"Setup2FA",component:_l},{path:"/task-management",name:"TaskManagement",component:Ma},{path:"/port-scan-results",name:"PortScanResults",component:Bs},{path:"/port-scan-results/:id",name:"PortScanDetail",component:ur,props:!0},{path:"/subdomain-scan-results",name:"SubdomainScanResults",component:ho},{path:"/subdomain-scan-results/:id",name:"SubdomainScanDetail",component:$n,props:!0},{path:"/path-scan-results",name:"PathScanResults",component:zd},{path:"/path-scan-results/:id",name:"PathScanDetail",component:nu,props:!0},{path:"/gogo-scan-results",name:"GogoScanResults",component:Yb},{path:"/gogo-scan-detail/:id",name:"GogoScanDetail",component:wf,props:!0},{path:"/task-management",name:"TaskManagement",component:Ma},{path:"/target-management",name:"TargetManagement",component:Dg},{path:"/target-management/:id",name:"TargetDetail",component:wx},{path:"/under-development",name:"UnderDevelopment",component:Dx},{path:"/tools",name:"ToolsContainer",component:jk,children:[{path:"",redirect:{name:"CryptoTools"}},{path:"crypto",name:"CryptoTools",component:ov},{path:"http-request",name:"HttpRequestTool",component:Gv}]}],Yv=(0,n.aE)({history:(0,n.LA)(""),routes:Zv});Yv.beforeEach((async(e,t,l)=>{await ie.dispatch("checkAuth");const a=ie.state.isAuthenticated;a||"LoginPage"===e.name||"Home"===e.name||"Setup2FA"===e.name?l():l({name:"Home"})}));var ey=Yv;(0,a.Ef)(te).use(ey).use(ie).mount("#app")},477:function(){}},t={};function l(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,l),i.exports}l.m=e,function(){var e=[];l.O=function(t,a,s,i){if(!a){var r=1/0;for(c=0;c<e.length;c++){a=e[c][0],s=e[c][1],i=e[c][2];for(var o=!0,n=0;n<a.length;n++)(!1&i||r>=i)&&Object.keys(l.O).every((function(e){return l.O[e](a[n])}))?a.splice(n--,1):(o=!1,i<r&&(r=i));if(o){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[a,s,i]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,i,r=a[0],o=a[1],n=a[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(s in o)l.o(o,s)&&(l.m[s]=o[s]);if(n)var c=n(l)}for(t&&t(a);d<r.length;d++)i=r[d],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(c)},a=self["webpackChunkyangmiee"]=self["webpackChunkyangmiee"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],(function(){return l(584)}));a=l.O(a)})();